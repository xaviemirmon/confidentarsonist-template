"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@dnd-kit+abstract@0.1.21";
exports.ids = ["vendor-chunks/@dnd-kit+abstract@0.1.21"];
exports.modules = {

/***/ "(ssr)/./node_modules/.pnpm/@dnd-kit+abstract@0.1.21/node_modules/@dnd-kit/abstract/index.js":
/*!*********************************************************************************************!*\
  !*** ./node_modules/.pnpm/@dnd-kit+abstract@0.1.21/node_modules/@dnd-kit/abstract/index.js ***!
  \*********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CollisionPriority: () => (/* binding */ CollisionPriority),\n/* harmony export */   CollisionType: () => (/* binding */ CollisionType),\n/* harmony export */   CorePlugin: () => (/* binding */ CorePlugin),\n/* harmony export */   DragDropManager: () => (/* binding */ DragDropManager),\n/* harmony export */   DragOperationStatus: () => (/* binding */ Status),\n/* harmony export */   Draggable: () => (/* binding */ Draggable),\n/* harmony export */   Droppable: () => (/* binding */ Droppable),\n/* harmony export */   Modifier: () => (/* binding */ Modifier),\n/* harmony export */   Plugin: () => (/* binding */ Plugin),\n/* harmony export */   PluginRegistry: () => (/* binding */ PluginRegistry),\n/* harmony export */   Sensor: () => (/* binding */ Sensor),\n/* harmony export */   configurator: () => (/* binding */ configurator),\n/* harmony export */   configure: () => (/* binding */ configure),\n/* harmony export */   descriptor: () => (/* binding */ descriptor),\n/* harmony export */   sortCollisions: () => (/* binding */ sortCollisions)\n/* harmony export */ });\n/* harmony import */ var _dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dnd-kit/state */ \"(ssr)/./node_modules/.pnpm/@dnd-kit+state@0.1.21/node_modules/@dnd-kit/state/dist/index.mjs\");\n/* harmony import */ var _dnd_kit_state__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dnd-kit/state */ \"(ssr)/./node_modules/.pnpm/@preact+signals-core@1.12.1/node_modules/@preact/signals-core/dist/signals-core.mjs\");\n/* harmony import */ var _dnd_kit_geometry__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dnd-kit/geometry */ \"(ssr)/./node_modules/.pnpm/@dnd-kit+geometry@0.1.21/node_modules/@dnd-kit/geometry/dist/index.mjs\");\n\n\n\nvar __create = Object.create;\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __knownSymbol = (name, symbol) => (symbol = Symbol[name]) ? symbol : Symbol.for(\"Symbol.\" + name);\nvar __typeError = (msg) => {\n  throw TypeError(msg);\n};\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __name = (target, value) => __defProp(target, \"name\", { value, configurable: true });\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nvar __decoratorStart = (base) => {\n  var _a;\n  return [, , , __create((_a = base == null ? void 0 : base[__knownSymbol(\"metadata\")]) != null ? _a : null)];\n};\nvar __decoratorStrings = [\"class\", \"method\", \"getter\", \"setter\", \"accessor\", \"field\", \"value\", \"get\", \"set\"];\nvar __expectFn = (fn) => fn !== void 0 && typeof fn !== \"function\" ? __typeError(\"Function expected\") : fn;\nvar __decoratorContext = (kind, name, done, metadata, fns) => ({ kind: __decoratorStrings[kind], name, metadata, addInitializer: (fn) => done._ ? __typeError(\"Already initialized\") : fns.push(__expectFn(fn || null)) });\nvar __decoratorMetadata = (array, target) => __defNormalProp(target, __knownSymbol(\"metadata\"), array[3]);\nvar __runInitializers = (array, flags, self, value) => {\n  for (var i = 0, fns = array[flags >> 1], n = fns && fns.length; i < n; i++) flags & 1 ? fns[i].call(self) : value = fns[i].call(self, value);\n  return value;\n};\nvar __decorateElement = (array, flags, name, decorators, target, extra) => {\n  var fn, it, done, ctx, access, k = flags & 7, s = !!(flags & 8), p = !!(flags & 16);\n  var j = k > 3 ? array.length + 1 : k ? s ? 1 : 2 : 0, key = __decoratorStrings[k + 5];\n  var initializers = k > 3 && (array[j - 1] = []), extraInitializers = array[j] || (array[j] = []);\n  var desc = k && (!p && !s && (target = target.prototype), k < 5 && (k > 3 || !p) && __getOwnPropDesc(k < 4 ? target : { get [name]() {\n    return __privateGet(this, extra);\n  }, set [name](x) {\n    return __privateSet(this, extra, x);\n  } }, name));\n  k ? p && k < 4 && __name(extra, (k > 2 ? \"set \" : k > 1 ? \"get \" : \"\") + name) : __name(target, name);\n  for (var i = decorators.length - 1; i >= 0; i--) {\n    ctx = __decoratorContext(k, name, done = {}, array[3], extraInitializers);\n    if (k) {\n      ctx.static = s, ctx.private = p, access = ctx.access = { has: p ? (x) => __privateIn(target, x) : (x) => name in x };\n      if (k ^ 3) access.get = p ? (x) => (k ^ 1 ? __privateGet : __privateMethod)(x, target, k ^ 4 ? extra : desc.get) : (x) => x[name];\n      if (k > 2) access.set = p ? (x, y) => __privateSet(x, target, y, k ^ 4 ? extra : desc.set) : (x, y) => x[name] = y;\n    }\n    it = (0, decorators[i])(k ? k < 4 ? p ? extra : desc[key] : k > 4 ? void 0 : { get: desc.get, set: desc.set } : target, ctx), done._ = 1;\n    if (k ^ 4 || it === void 0) __expectFn(it) && (k > 4 ? initializers.unshift(it) : k ? p ? extra = it : desc[key] = it : target = it);\n    else if (typeof it !== \"object\" || it === null) __typeError(\"Object expected\");\n    else __expectFn(fn = it.get) && (desc.get = fn), __expectFn(fn = it.set) && (desc.set = fn), __expectFn(fn = it.init) && initializers.unshift(fn);\n  }\n  return k || __decoratorMetadata(array, target), desc && __defProp(target, name, desc), p ? k ^ 4 ? extra : desc : target;\n};\nvar __accessCheck = (obj, member, msg) => member.has(obj) || __typeError(\"Cannot \" + msg);\nvar __privateIn = (member, obj) => Object(obj) !== obj ? __typeError('Cannot use the \"in\" operator on this value') : member.has(obj);\nvar __privateGet = (obj, member, getter) => (__accessCheck(obj, member, \"read from private field\"), getter ? getter.call(obj) : member.get(obj));\nvar __privateAdd = (obj, member, value) => member.has(obj) ? __typeError(\"Cannot add the same private member more than once\") : member instanceof WeakSet ? member.add(obj) : member.set(obj, value);\nvar __privateSet = (obj, member, value, setter) => (__accessCheck(obj, member, \"write to private field\"), setter ? setter.call(obj, value) : member.set(obj, value), value);\nvar __privateMethod = (obj, member, method) => (__accessCheck(obj, member, \"access private method\"), method);\n\n// src/core/plugins/utilities.ts\nfunction configure(plugin, options) {\n  return {\n    plugin,\n    options\n  };\n}\nfunction configurator(plugin) {\n  return (options) => {\n    return configure(plugin, options);\n  };\n}\nfunction descriptor(plugin) {\n  if (typeof plugin === \"function\") {\n    return {\n      plugin,\n      options: void 0\n    };\n  }\n  return plugin;\n}\n\n// src/core/plugins/plugin.ts\nvar _disabled_dec, _init, _disabled, _cleanupFunctions;\n_disabled_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.reactive];\nvar Plugin = class {\n  /**\n   * Creates a new plugin instance.\n   *\n   * @param manager - The drag and drop manager that owns this plugin\n   * @param options - Optional configuration for the plugin\n   */\n  constructor(manager, options) {\n    this.manager = manager;\n    this.options = options;\n    __privateAdd(this, _disabled, __runInitializers(_init, 8, this, false)), __runInitializers(_init, 11, this);\n    __privateAdd(this, _cleanupFunctions, /* @__PURE__ */ new Set());\n  }\n  /**\n   * Enables a disabled plugin instance.\n   *\n   * @remarks\n   * This method triggers effects when called.\n   */\n  enable() {\n    this.disabled = false;\n  }\n  /**\n   * Disables an enabled plugin instance.\n   *\n   * @remarks\n   * This method triggers effects when called.\n   */\n  disable() {\n    this.disabled = true;\n  }\n  /**\n   * Checks if the plugin instance is disabled.\n   *\n   * @returns true if the plugin is disabled\n   * @remarks\n   * This method does not trigger effects when accessed.\n   */\n  isDisabled() {\n    return (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_1__.untracked)(() => {\n      return this.disabled;\n    });\n  }\n  /**\n   * Configures a plugin instance with new options.\n   *\n   * @param options - The new options to apply\n   */\n  configure(options) {\n    this.options = options;\n  }\n  /**\n   * Registers an effect that will be cleaned up when the plugin is destroyed.\n   *\n   * @param callback - The effect callback to register\n   * @returns A function to dispose of the effect\n   */\n  registerEffect(callback) {\n    const dispose = (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_1__.effect)(callback.bind(this));\n    __privateGet(this, _cleanupFunctions).add(dispose);\n    return dispose;\n  }\n  /**\n   * Destroys a plugin instance and cleans up its resources.\n   *\n   * @remarks\n   * This method:\n   * - Calls all registered cleanup functions\n   * - Should be overridden by subclasses to clean up additional resources\n   */\n  destroy() {\n    __privateGet(this, _cleanupFunctions).forEach((cleanup) => cleanup());\n  }\n  /**\n   * Configures a plugin constructor with options.\n   *\n   * @param options - The options to configure the constructor with\n   * @returns The configured plugin constructor\n   *\n   * @remarks\n   * This method is used to configure the options that the\n   * plugin constructor will use to create plugin instances.\n   */\n  static configure(options) {\n    return configure(this, options);\n  }\n};\n_init = __decoratorStart(null);\n_disabled = new WeakMap();\n_cleanupFunctions = new WeakMap();\n__decorateElement(_init, 4, \"disabled\", _disabled_dec, Plugin, _disabled);\n__decoratorMetadata(_init, Plugin);\nvar CorePlugin = class extends Plugin {\n};\n\n// src/core/plugins/registry.ts\nvar _previousValues;\nvar PluginRegistry = class {\n  /**\n   * Creates a new plugin registry.\n   *\n   * @param manager - The drag and drop manager that owns this registry\n   */\n  constructor(manager) {\n    this.manager = manager;\n    this.instances = /* @__PURE__ */ new Map();\n    __privateAdd(this, _previousValues, []);\n  }\n  /**\n   * Gets all registered plugin instances.\n   *\n   * @returns An array of all active plugin instances\n   */\n  get values() {\n    return Array.from(this.instances.values());\n  }\n  /**\n   * Sets the list of plugins to be used by the registry.\n   *\n   * @param entries - Array of plugin constructors or descriptors\n   * @remarks\n   * This method:\n   * - Filters out duplicate plugins\n   * - Unregisters plugins that are no longer in use\n   * - Registers new plugins with their options\n   */\n  set values(entries) {\n    const descriptors = entries.map(descriptor).reduceRight((acc, descriptor2) => {\n      if (acc.some(({ plugin }) => plugin === descriptor2.plugin)) {\n        return acc;\n      }\n      return [descriptor2, ...acc];\n    }, []);\n    const constructors = descriptors.map(({ plugin }) => plugin);\n    for (const plugin of __privateGet(this, _previousValues)) {\n      if (!constructors.includes(plugin)) {\n        if (plugin.prototype instanceof CorePlugin) {\n          continue;\n        }\n        this.unregister(plugin);\n      }\n    }\n    for (const { plugin, options } of descriptors) {\n      this.register(plugin, options);\n    }\n    __privateSet(this, _previousValues, constructors);\n  }\n  /**\n   * Gets a plugin instance by its constructor.\n   *\n   * @param plugin - The plugin constructor to look up\n   * @returns The plugin instance or undefined if not found\n   */\n  get(plugin) {\n    const instance = this.instances.get(plugin);\n    return instance;\n  }\n  /**\n   * Registers a new plugin instance.\n   *\n   * @param plugin - The plugin constructor to register\n   * @param options - Optional configuration for the plugin\n   * @returns The registered plugin instance\n   * @remarks\n   * If the plugin is already registered, its options will be updated\n   * and the existing instance will be returned.\n   */\n  register(plugin, options) {\n    const existingInstance = this.instances.get(plugin);\n    if (existingInstance) {\n      if (existingInstance.options !== options) {\n        existingInstance.options = options;\n      }\n      return existingInstance;\n    }\n    const instance = new plugin(this.manager, options);\n    this.instances.set(plugin, instance);\n    return instance;\n  }\n  /**\n   * Unregisters a plugin instance.\n   *\n   * @param plugin - The plugin constructor to unregister\n   * @remarks\n   * This method:\n   * - Destroys the plugin instance\n   * - Removes it from the registry\n   */\n  unregister(plugin) {\n    const instance = this.instances.get(plugin);\n    if (instance) {\n      instance.destroy();\n      this.instances.delete(plugin);\n    }\n  }\n  /**\n   * Destroys all registered plugin instances.\n   *\n   * @remarks\n   * This method:\n   * - Calls destroy() on all plugin instances\n   * - Clears the registry\n   */\n  destroy() {\n    for (const plugin of this.instances.values()) {\n      plugin.destroy();\n    }\n    this.instances.clear();\n  }\n};\n_previousValues = new WeakMap();\n\n// src/core/collision/utilities.ts\nfunction sortCollisions(a, b) {\n  if (a.priority === b.priority) {\n    if (a.type === b.type) {\n      return b.value - a.value;\n    }\n    return b.type - a.type;\n  }\n  return b.priority - a.priority;\n}\n\n// src/core/collision/observer.ts\nvar DEFAULT_VALUE = [];\nvar _previousCoordinates, _collisions;\nvar CollisionObserver = class extends Plugin {\n  /**\n   * Creates a new CollisionObserver instance.\n   *\n   * @param manager - The drag drop manager instance\n   */\n  constructor(manager) {\n    super(manager);\n    __privateAdd(this, _previousCoordinates);\n    __privateAdd(this, _collisions);\n    this.computeCollisions = this.computeCollisions.bind(this);\n    __privateSet(this, _collisions, (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_1__.signal)(DEFAULT_VALUE));\n    this.destroy = (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.effects)(\n      () => {\n        const collisions = this.computeCollisions();\n        const coordinates = (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_1__.untracked)(\n          () => this.manager.dragOperation.position.current\n        );\n        if (collisions !== DEFAULT_VALUE) {\n          const previousCoordinates = __privateGet(this, _previousCoordinates);\n          __privateSet(this, _previousCoordinates, coordinates);\n          if (previousCoordinates && coordinates.x == previousCoordinates.x && coordinates.y == previousCoordinates.y) {\n            return;\n          }\n        } else {\n          __privateSet(this, _previousCoordinates, void 0);\n        }\n        __privateGet(this, _collisions).value = collisions;\n      },\n      () => {\n        const { dragOperation } = this.manager;\n        if (dragOperation.status.initialized) {\n          this.forceUpdate();\n        }\n      }\n    );\n  }\n  /**\n   * Forces an immediate update of collision detection.\n   *\n   * @param immediate - If true, updates collisions immediately. If false, resets previous coordinates.\n   */\n  forceUpdate(immediate = true) {\n    (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_1__.untracked)(() => {\n      if (immediate) {\n        __privateGet(this, _collisions).value = this.computeCollisions();\n      } else {\n        __privateSet(this, _previousCoordinates, void 0);\n      }\n    });\n  }\n  /**\n   * Computes collisions between draggable and droppable elements.\n   *\n   * @param entries - Optional array of droppable elements to check. If not provided, uses all registered droppables.\n   * @param collisionDetector - Optional custom collision detector function\n   * @returns Array of detected collisions, sorted by priority\n   */\n  computeCollisions(entries, collisionDetector) {\n    const { registry, dragOperation } = this.manager;\n    const { source, shape, status } = dragOperation;\n    if (!status.initialized || !shape) {\n      return DEFAULT_VALUE;\n    }\n    const collisions = [];\n    const potentialTargets = [];\n    for (const entry of entries != null ? entries : registry.droppables) {\n      if (entry.disabled) {\n        continue;\n      }\n      if (source && !entry.accepts(source)) {\n        continue;\n      }\n      const detectCollision = collisionDetector != null ? collisionDetector : entry.collisionDetector;\n      if (!detectCollision) {\n        continue;\n      }\n      potentialTargets.push(entry);\n      void entry.shape;\n      const collision = (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_1__.untracked)(\n        () => detectCollision({\n          droppable: entry,\n          dragOperation\n        })\n      );\n      if (collision) {\n        if (entry.collisionPriority != null) {\n          collision.priority = entry.collisionPriority;\n        }\n        collisions.push(collision);\n      }\n    }\n    if (potentialTargets.length === 0) {\n      return DEFAULT_VALUE;\n    }\n    collisions.sort(sortCollisions);\n    return collisions;\n  }\n  /**\n   * Gets the current collisions signal value.\n   */\n  get collisions() {\n    return __privateGet(this, _collisions).value;\n  }\n};\n_previousCoordinates = new WeakMap();\n_collisions = new WeakMap();\n\n// src/core/manager/events.ts\nvar Monitor = class {\n  constructor() {\n    this.registry = /* @__PURE__ */ new Map();\n  }\n  /**\n   * Adds an event listener for the specified event type.\n   *\n   * @param name - The name of the event to listen for\n   * @param handler - The function to call when the event occurs\n   * @returns A function to remove the event listener\n   */\n  addEventListener(name, handler) {\n    const { registry } = this;\n    const listeners = new Set(registry.get(name));\n    listeners.add(handler);\n    registry.set(name, listeners);\n    return () => this.removeEventListener(name, handler);\n  }\n  /**\n   * Removes an event listener for the specified event type.\n   *\n   * @param name - The name of the event\n   * @param handler - The function to remove\n   */\n  removeEventListener(name, handler) {\n    const { registry } = this;\n    const listeners = new Set(registry.get(name));\n    listeners.delete(handler);\n    registry.set(name, listeners);\n  }\n  /**\n   * Dispatches an event to all registered listeners.\n   *\n   * @param name - The name of the event to dispatch\n   * @param args - Arguments to pass to the event handlers\n   */\n  dispatch(name, ...args) {\n    const { registry } = this;\n    const listeners = registry.get(name);\n    if (!listeners) {\n      return;\n    }\n    for (const listener of listeners) {\n      listener(...args);\n    }\n  }\n};\nvar DragDropMonitor = class extends Monitor {\n  /**\n   * Creates a new drag and drop monitor.\n   *\n   * @param manager - The drag and drop manager to monitor\n   */\n  constructor(manager) {\n    super();\n    this.manager = manager;\n  }\n  /**\n   * Dispatches a drag and drop event.\n   *\n   * @param type - The type of event to dispatch\n   * @param event - The event data to dispatch\n   */\n  dispatch(type, event) {\n    const args = [event, this.manager];\n    super.dispatch(type, ...args);\n  }\n};\nfunction defaultPreventable(event, cancelable = true) {\n  let defaultPrevented = false;\n  return __spreadProps(__spreadValues({}, event), {\n    cancelable,\n    get defaultPrevented() {\n      return defaultPrevented;\n    },\n    preventDefault() {\n      if (!cancelable) {\n        return;\n      }\n      defaultPrevented = true;\n    }\n  });\n}\n\n// src/core/collision/notifier.ts\nvar CollisionNotifier = class extends CorePlugin {\n  constructor(manager) {\n    super(manager);\n    const isEqual = (a, b) => a.map(({ id }) => id).join(\"\") === b.map(({ id }) => id).join(\"\");\n    let previousCollisions = [];\n    this.destroy = (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.effects)(\n      () => {\n        const { dragOperation, collisionObserver } = manager;\n        if (dragOperation.status.initializing) {\n          previousCollisions = [];\n          collisionObserver.enable();\n        }\n      },\n      () => {\n        const { collisionObserver, monitor } = manager;\n        const { collisions } = collisionObserver;\n        if (collisionObserver.isDisabled()) {\n          return;\n        }\n        const event = defaultPreventable({\n          collisions\n        });\n        monitor.dispatch(\"collision\", event);\n        if (event.defaultPrevented) {\n          return;\n        }\n        if (isEqual(collisions, previousCollisions)) {\n          return;\n        } else {\n          previousCollisions = collisions;\n        }\n        const [firstCollision] = collisions;\n        (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_1__.untracked)(() => {\n          var _a;\n          if ((firstCollision == null ? void 0 : firstCollision.id) !== ((_a = manager.dragOperation.target) == null ? void 0 : _a.id)) {\n            collisionObserver.disable();\n            manager.actions.setDropTarget(firstCollision == null ? void 0 : firstCollision.id).then(() => {\n              collisionObserver.enable();\n            });\n          }\n        });\n      }\n    );\n  }\n};\n\n// src/core/collision/types.ts\nvar CollisionPriority = /* @__PURE__ */ ((CollisionPriority2) => {\n  CollisionPriority2[CollisionPriority2[\"Lowest\"] = 0] = \"Lowest\";\n  CollisionPriority2[CollisionPriority2[\"Low\"] = 1] = \"Low\";\n  CollisionPriority2[CollisionPriority2[\"Normal\"] = 2] = \"Normal\";\n  CollisionPriority2[CollisionPriority2[\"High\"] = 3] = \"High\";\n  CollisionPriority2[CollisionPriority2[\"Highest\"] = 4] = \"Highest\";\n  return CollisionPriority2;\n})(CollisionPriority || {});\nvar CollisionType = /* @__PURE__ */ ((CollisionType2) => {\n  CollisionType2[CollisionType2[\"Collision\"] = 0] = \"Collision\";\n  CollisionType2[CollisionType2[\"ShapeIntersection\"] = 1] = \"ShapeIntersection\";\n  CollisionType2[CollisionType2[\"PointerIntersection\"] = 2] = \"PointerIntersection\";\n  return CollisionType2;\n})(CollisionType || {});\nvar _dropped_dec, _dragging_dec, _initialized_dec, _initializing_dec, _idle_dec, _current_dec, _value_dec, _init2, _value;\n_value_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.reactive], _current_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.derived], _idle_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.derived], _initializing_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.derived], _initialized_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.derived], _dragging_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.derived], _dropped_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.derived];\nvar Status = class {\n  constructor() {\n    __runInitializers(_init2, 5, this);\n    __privateAdd(this, _value, __runInitializers(_init2, 8, this, \"idle\" /* Idle */)), __runInitializers(_init2, 11, this);\n  }\n  get current() {\n    return this.value;\n  }\n  get idle() {\n    return this.value === \"idle\" /* Idle */;\n  }\n  get initializing() {\n    return this.value === \"initializing\" /* Initializing */;\n  }\n  get initialized() {\n    const { value } = this;\n    return value !== \"idle\" /* Idle */ && value !== \"initialization-pending\" /* InitializationPending */;\n  }\n  get dragging() {\n    return this.value === \"dragging\" /* Dragging */;\n  }\n  get dropped() {\n    return this.value === \"dropped\" /* Dropped */;\n  }\n  /**\n   * Sets the current status value.\n   *\n   * @param value - The new status value\n   */\n  set(value) {\n    this.value = value;\n  }\n};\n_init2 = __decoratorStart(null);\n_value = new WeakMap();\n__decorateElement(_init2, 4, \"value\", _value_dec, Status, _value);\n__decorateElement(_init2, 2, \"current\", _current_dec, Status);\n__decorateElement(_init2, 2, \"idle\", _idle_dec, Status);\n__decorateElement(_init2, 2, \"initializing\", _initializing_dec, Status);\n__decorateElement(_init2, 2, \"initialized\", _initialized_dec, Status);\n__decorateElement(_init2, 2, \"dragging\", _dragging_dec, Status);\n__decorateElement(_init2, 2, \"dropped\", _dropped_dec, Status);\n__decoratorMetadata(_init2, Status);\n\n// src/core/manager/actions.ts\nvar DragActions = class {\n  /**\n   * Creates a new instance of drag actions.\n   *\n   * @param manager - The drag and drop manager instance\n   */\n  constructor(manager) {\n    this.manager = manager;\n  }\n  /**\n   * Sets the source of the drag operation.\n   *\n   * @param source - The draggable entity or its unique identifier\n   */\n  setDragSource(source) {\n    const { dragOperation } = this.manager;\n    dragOperation.sourceIdentifier = typeof source === \"string\" || typeof source === \"number\" ? source : source.id;\n  }\n  /**\n   * Sets the target of the drop operation.\n   *\n   * @param identifier - The unique identifier of the droppable entity or null/undefined\n   * @returns A promise that resolves to true if the drop was prevented\n   */\n  setDropTarget(identifier) {\n    return (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_1__.untracked)(() => {\n      const { dragOperation } = this.manager;\n      const id = identifier != null ? identifier : null;\n      if (dragOperation.targetIdentifier === id) {\n        return Promise.resolve(false);\n      }\n      dragOperation.targetIdentifier = id;\n      const event = defaultPreventable({\n        operation: dragOperation.snapshot()\n      });\n      if (dragOperation.status.dragging) {\n        this.manager.monitor.dispatch(\"dragover\", event);\n      }\n      return this.manager.renderer.rendering.then(() => event.defaultPrevented);\n    });\n  }\n  /**\n   * Starts a new drag operation.\n   *\n   * @param args - Configuration for the drag operation\n   * @param args.event - The event that initiated the drag\n   * @param args.source - The source draggable entity or its identifier\n   * @param args.coordinates - The initial coordinates of the drag\n   * @returns true if the drag operation started successfully\n   * @throws {Error} If there is no drag source or another operation is active\n   */\n  start(args) {\n    return (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_1__.untracked)(() => {\n      const { dragOperation } = this.manager;\n      if (args.source != null) {\n        this.setDragSource(args.source);\n      }\n      const sourceInstance = dragOperation.source;\n      if (!sourceInstance) {\n        throw new Error(\"Cannot start a drag operation without a drag source\");\n      }\n      if (!dragOperation.status.idle) {\n        throw new Error(\n          \"Cannot start a drag operation while another is active\"\n        );\n      }\n      const controller = new AbortController();\n      const { event: nativeEvent, coordinates } = args;\n      (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_1__.batch)(() => {\n        dragOperation.status.set(\"initialization-pending\" /* InitializationPending */);\n        dragOperation.shape = null;\n        dragOperation.canceled = false;\n        dragOperation.activatorEvent = nativeEvent != null ? nativeEvent : null;\n        dragOperation.position.reset(coordinates);\n      });\n      const beforeStartEvent = defaultPreventable({\n        operation: dragOperation.snapshot()\n      });\n      this.manager.monitor.dispatch(\"beforedragstart\", beforeStartEvent);\n      if (beforeStartEvent.defaultPrevented) {\n        dragOperation.reset();\n        controller.abort();\n        return controller;\n      }\n      dragOperation.status.set(\"initializing\" /* Initializing */);\n      dragOperation.controller = controller;\n      this.manager.renderer.rendering.then(() => {\n        if (controller.signal.aborted) return;\n        const { status } = dragOperation;\n        if (status.current !== \"initializing\" /* Initializing */) return;\n        dragOperation.status.set(\"dragging\" /* Dragging */);\n        this.manager.monitor.dispatch(\"dragstart\", {\n          nativeEvent,\n          operation: dragOperation.snapshot(),\n          cancelable: false\n        });\n      });\n      return controller;\n    });\n  }\n  /**\n   * Moves the dragged entity to a new position.\n   *\n   * @param args - Configuration for the move operation\n   * @param args.by - Relative coordinates to move by\n   * @param args.to - Absolute coordinates to move to\n   * @param args.event - The event that triggered the move\n   * @param args.cancelable - Whether the move can be canceled\n   * @param args.propagate - Whether to dispatch dragmove events\n   */\n  move(args) {\n    return (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_1__.untracked)(() => {\n      var _a, _b;\n      const { dragOperation } = this.manager;\n      const { status, controller } = dragOperation;\n      if (!status.dragging || !controller || controller.signal.aborted) {\n        return;\n      }\n      const event = defaultPreventable(\n        {\n          nativeEvent: args.event,\n          operation: dragOperation.snapshot(),\n          by: args.by,\n          to: args.to\n        },\n        (_a = args.cancelable) != null ? _a : true\n      );\n      if ((_b = args.propagate) != null ? _b : true) {\n        this.manager.monitor.dispatch(\"dragmove\", event);\n      }\n      queueMicrotask(() => {\n        var _a2, _b2, _c3, _d, _e;\n        if (event.defaultPrevented) {\n          return;\n        }\n        const coordinates = (_e = args.to) != null ? _e : {\n          x: dragOperation.position.current.x + ((_b2 = (_a2 = args.by) == null ? void 0 : _a2.x) != null ? _b2 : 0),\n          y: dragOperation.position.current.y + ((_d = (_c3 = args.by) == null ? void 0 : _c3.y) != null ? _d : 0)\n        };\n        dragOperation.position.current = coordinates;\n      });\n    });\n  }\n  /**\n   * Stops the current drag operation.\n   *\n   * @param args - Configuration for stopping the operation\n   * @param args.event - The event that triggered the stop\n   * @param args.canceled - Whether the operation was canceled\n   * @remarks\n   * This method:\n   * - Dispatches a dragend event\n   * - Allows suspension of the operation\n   * - Handles cleanup of the operation state\n   */\n  stop(args = {}) {\n    return (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_1__.untracked)(() => {\n      var _a, _b;\n      const { dragOperation } = this.manager;\n      const { controller } = dragOperation;\n      if (!controller || controller.signal.aborted) return;\n      let promise;\n      const suspend = () => {\n        const output = {\n          resume: () => {\n          },\n          abort: () => {\n          }\n        };\n        promise = new Promise((resolve, reject) => {\n          output.resume = resolve;\n          output.abort = reject;\n        });\n        return output;\n      };\n      controller.abort();\n      const end = () => {\n        this.manager.renderer.rendering.then(() => {\n          dragOperation.status.set(\"dropped\" /* Dropped */);\n          const dropping = (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_1__.untracked)(\n            () => {\n              var _a2;\n              return ((_a2 = dragOperation.source) == null ? void 0 : _a2.status) === \"dropping\";\n            }\n          );\n          const cleanup = () => {\n            if (dragOperation.controller === controller) {\n              dragOperation.controller = void 0;\n            }\n            dragOperation.reset();\n          };\n          if (dropping) {\n            const { source } = dragOperation;\n            const dispose = (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_1__.effect)(() => {\n              if ((source == null ? void 0 : source.status) === \"idle\") {\n                dispose();\n                cleanup();\n              }\n            });\n          } else {\n            this.manager.renderer.rendering.then(cleanup);\n          }\n        });\n      };\n      dragOperation.canceled = (_a = args.canceled) != null ? _a : false;\n      this.manager.monitor.dispatch(\"dragend\", {\n        nativeEvent: args.event,\n        operation: dragOperation.snapshot(),\n        canceled: (_b = args.canceled) != null ? _b : false,\n        suspend\n      });\n      if (promise) {\n        promise.then(end).catch(() => dragOperation.reset());\n      } else {\n        end();\n      }\n    });\n  }\n};\nvar _disabled_dec2, _data_dec, _id_dec, _manager_dec, _init3, _manager, _id, _data, _disabled2;\n_manager_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.reactive], _id_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.reactive], _data_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.reactive], _disabled_dec2 = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.reactive];\nvar Entity = class {\n  /**\n   * Creates a new instance of the `Entity` class.\n   *\n   * @param input - An object containing the initial properties of the entity.\n   * @param manager - The manager that controls the drag and drop operations.\n   */\n  constructor(input, manager) {\n    __privateAdd(this, _manager, __runInitializers(_init3, 8, this)), __runInitializers(_init3, 11, this);\n    __privateAdd(this, _id, __runInitializers(_init3, 12, this)), __runInitializers(_init3, 15, this);\n    __privateAdd(this, _data, __runInitializers(_init3, 16, this)), __runInitializers(_init3, 19, this);\n    __privateAdd(this, _disabled2, __runInitializers(_init3, 20, this)), __runInitializers(_init3, 23, this);\n    const { effects: effects6, id, data = {}, disabled = false, register = true } = input;\n    let previousId = id;\n    this.manager = manager;\n    this.id = id;\n    this.data = data;\n    this.disabled = disabled;\n    this.effects = () => {\n      var _a;\n      return [\n        () => {\n          const { id: id2, manager: manager2 } = this;\n          if (id2 === previousId) {\n            return;\n          }\n          manager2 == null ? void 0 : manager2.registry.register(this);\n          return () => manager2 == null ? void 0 : manager2.registry.unregister(this);\n        },\n        ...(_a = effects6 == null ? void 0 : effects6()) != null ? _a : []\n      ];\n    };\n    this.register = this.register.bind(this);\n    this.unregister = this.unregister.bind(this);\n    this.destroy = this.destroy.bind(this);\n    if (manager && register) {\n      queueMicrotask(this.register);\n    }\n  }\n  /**\n   * A method that registers the entity with the manager.\n   * @returns CleanupFunction | void\n   */\n  register() {\n    var _a;\n    return (_a = this.manager) == null ? void 0 : _a.registry.register(this);\n  }\n  /**\n   * A method that unregisters the entity from the manager.\n   * @returns void\n   */\n  unregister() {\n    var _a;\n    (_a = this.manager) == null ? void 0 : _a.registry.unregister(this);\n  }\n  /**\n   * A method that cleans up the entity when it is no longer needed.\n   * @returns void\n   */\n  destroy() {\n    var _a;\n    (_a = this.manager) == null ? void 0 : _a.registry.unregister(this);\n  }\n};\n_init3 = __decoratorStart(null);\n_manager = new WeakMap();\n_id = new WeakMap();\n_data = new WeakMap();\n_disabled2 = new WeakMap();\n__decorateElement(_init3, 4, \"manager\", _manager_dec, Entity, _manager);\n__decorateElement(_init3, 4, \"id\", _id_dec, Entity, _id);\n__decorateElement(_init3, 4, \"data\", _data_dec, Entity, _data);\n__decorateElement(_init3, 4, \"disabled\", _disabled_dec2, Entity, _disabled2);\n__decoratorMetadata(_init3, Entity);\nvar EntityRegistry = class {\n  constructor() {\n    this.map = (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_1__.signal)(/* @__PURE__ */ new Map());\n    this.cleanupFunctions = /* @__PURE__ */ new WeakMap();\n    /**\n     * Registers a entity in the registry.\n     * @param key - The unique identifier of the entity.\n     * @param value - The entity to register.\n     * @returns A function that unregisters the entity.\n     */\n    this.register = (key, value) => {\n      const current = this.map.peek();\n      const currentValue = current.get(key);\n      const unregister = () => this.unregister(key, value);\n      if (currentValue === value) return unregister;\n      if (currentValue) {\n        const cleanup2 = this.cleanupFunctions.get(currentValue);\n        cleanup2 == null ? void 0 : cleanup2();\n        this.cleanupFunctions.delete(currentValue);\n      }\n      const updatedMap = new Map(current);\n      updatedMap.set(key, value);\n      this.map.value = updatedMap;\n      const cleanup = (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.effects)(...value.effects());\n      this.cleanupFunctions.set(value, cleanup);\n      return unregister;\n    };\n    /**\n     * Unregisters an entity from the registry.\n     * @param key - The unique identifier of the entity.\n     * @param value - The entity instance to unregister.\n     */\n    this.unregister = (key, value) => {\n      const current = this.map.peek();\n      if (current.get(key) !== value) {\n        return;\n      }\n      const cleanup = this.cleanupFunctions.get(value);\n      cleanup == null ? void 0 : cleanup();\n      this.cleanupFunctions.delete(value);\n      const updatedMap = new Map(current);\n      updatedMap.delete(key);\n      this.map.value = updatedMap;\n    };\n  }\n  /**\n   * Iterator for the EntityRegistry class.\n   * @returns An iterator for the values in the map.\n   */\n  [Symbol.iterator]() {\n    return this.map.peek().values();\n  }\n  get value() {\n    return this.map.value.values();\n  }\n  /**\n   * Checks if a entity with the given identifier exists in the registry.\n   * @param identifier - The unique identifier of the entity.\n   * @returns True if the entity exists, false otherwise.\n   */\n  has(identifier) {\n    return this.map.value.has(identifier);\n  }\n  /**\n   * Retrieves a entity from the registry using its identifier.\n   * @param identifier - The unique identifier of the entity.\n   * @returns The entity if it exists, undefined otherwise.\n   */\n  get(identifier) {\n    return this.map.value.get(identifier);\n  }\n  /**\n   * Destroys all entries in the registry and clears the registry.\n   */\n  destroy() {\n    for (const entry of this) {\n      const cleanup = this.cleanupFunctions.get(entry);\n      cleanup == null ? void 0 : cleanup();\n      entry.destroy();\n    }\n    this.map.value = /* @__PURE__ */ new Map();\n  }\n};\nvar _isDragSource_dec, _isDragging_dec, _isDropping_dec, _status_dec, _modifiers_dec, _type_dec, _c, _init4, _type, _modifiers, _status;\nvar Draggable = class extends (_c = Entity, _type_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.reactive], _modifiers_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.reactive], _status_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.reactive], _isDropping_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.derived], _isDragging_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.derived], _isDragSource_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.derived], _c) {\n  constructor(_a, manager) {\n    var _b = _a, { modifiers, type, sensors } = _b, input = __objRest(_b, [\"modifiers\", \"type\", \"sensors\"]);\n    super(input, manager);\n    __runInitializers(_init4, 5, this);\n    __privateAdd(this, _type, __runInitializers(_init4, 8, this)), __runInitializers(_init4, 11, this);\n    __privateAdd(this, _modifiers, __runInitializers(_init4, 12, this)), __runInitializers(_init4, 15, this);\n    __privateAdd(this, _status, __runInitializers(_init4, 16, this, this.isDragSource ? \"dragging\" : \"idle\")), __runInitializers(_init4, 19, this);\n    this.type = type;\n    this.sensors = sensors;\n    this.modifiers = modifiers;\n    this.alignment = input.alignment;\n  }\n  get isDropping() {\n    return this.status === \"dropping\" && this.isDragSource;\n  }\n  get isDragging() {\n    return this.status === \"dragging\" && this.isDragSource;\n  }\n  get isDragSource() {\n    var _a, _b;\n    return ((_b = (_a = this.manager) == null ? void 0 : _a.dragOperation.source) == null ? void 0 : _b.id) === this.id;\n  }\n};\n_init4 = __decoratorStart(_c);\n_type = new WeakMap();\n_modifiers = new WeakMap();\n_status = new WeakMap();\n__decorateElement(_init4, 4, \"type\", _type_dec, Draggable, _type);\n__decorateElement(_init4, 4, \"modifiers\", _modifiers_dec, Draggable, _modifiers);\n__decorateElement(_init4, 4, \"status\", _status_dec, Draggable, _status);\n__decorateElement(_init4, 2, \"isDropping\", _isDropping_dec, Draggable);\n__decorateElement(_init4, 2, \"isDragging\", _isDragging_dec, Draggable);\n__decorateElement(_init4, 2, \"isDragSource\", _isDragSource_dec, Draggable);\n__decoratorMetadata(_init4, Draggable);\nvar _isDropTarget_dec, _shape_dec, _collisionPriority_dec, _collisionDetector_dec, _type_dec2, _accept_dec, _c2, _init5, _accept, _type2, _collisionDetector, _collisionPriority, _shape;\nvar Droppable = class extends (_c2 = Entity, _accept_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.reactive], _type_dec2 = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.reactive], _collisionDetector_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.reactive], _collisionPriority_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.reactive], _shape_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.reactive], _isDropTarget_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.derived], _c2) {\n  constructor(_a, manager) {\n    var _b = _a, { accept, collisionDetector, collisionPriority, type } = _b, input = __objRest(_b, [\"accept\", \"collisionDetector\", \"collisionPriority\", \"type\"]);\n    super(input, manager);\n    __runInitializers(_init5, 5, this);\n    __privateAdd(this, _accept, __runInitializers(_init5, 8, this)), __runInitializers(_init5, 11, this);\n    __privateAdd(this, _type2, __runInitializers(_init5, 12, this)), __runInitializers(_init5, 15, this);\n    __privateAdd(this, _collisionDetector, __runInitializers(_init5, 16, this)), __runInitializers(_init5, 19, this);\n    __privateAdd(this, _collisionPriority, __runInitializers(_init5, 20, this)), __runInitializers(_init5, 23, this);\n    __privateAdd(this, _shape, __runInitializers(_init5, 24, this)), __runInitializers(_init5, 27, this);\n    this.accept = accept;\n    this.collisionDetector = collisionDetector;\n    this.collisionPriority = collisionPriority;\n    this.type = type;\n  }\n  /**\n   * Checks whether or not the droppable accepts a given draggable.\n   *\n   * @param draggable - The draggable to check\n   * @returns true if the draggable can be dropped here\n   */\n  accepts(draggable) {\n    const { accept } = this;\n    if (!accept) {\n      return true;\n    }\n    if (typeof accept === \"function\") {\n      return accept(draggable);\n    }\n    if (!draggable.type) {\n      return false;\n    }\n    if (Array.isArray(accept)) {\n      return accept.includes(draggable.type);\n    }\n    return draggable.type === accept;\n  }\n  get isDropTarget() {\n    var _a, _b;\n    return ((_b = (_a = this.manager) == null ? void 0 : _a.dragOperation.target) == null ? void 0 : _b.id) === this.id;\n  }\n};\n_init5 = __decoratorStart(_c2);\n_accept = new WeakMap();\n_type2 = new WeakMap();\n_collisionDetector = new WeakMap();\n_collisionPriority = new WeakMap();\n_shape = new WeakMap();\n__decorateElement(_init5, 4, \"accept\", _accept_dec, Droppable, _accept);\n__decorateElement(_init5, 4, \"type\", _type_dec2, Droppable, _type2);\n__decorateElement(_init5, 4, \"collisionDetector\", _collisionDetector_dec, Droppable, _collisionDetector);\n__decorateElement(_init5, 4, \"collisionPriority\", _collisionPriority_dec, Droppable, _collisionPriority);\n__decorateElement(_init5, 4, \"shape\", _shape_dec, Droppable, _shape);\n__decorateElement(_init5, 2, \"isDropTarget\", _isDropTarget_dec, Droppable);\n__decoratorMetadata(_init5, Droppable);\n\n// src/core/sensors/sensor.ts\nvar Sensor = class extends Plugin {\n  /**\n   * Creates a new sensor instance.\n   *\n   * @param manager - The drag drop manager instance\n   * @param options - Optional sensor configuration\n   */\n  constructor(manager, options) {\n    super(manager, options);\n    this.manager = manager;\n    this.options = options;\n  }\n};\n\n// src/core/modifiers/modifier.ts\nvar Modifier = class extends Plugin {\n  /**\n   * Creates a new modifier instance.\n   *\n   * @param manager - The drag and drop manager that owns this modifier\n   * @param options - Optional configuration for the modifier\n   */\n  constructor(manager, options) {\n    super(manager, options);\n    this.manager = manager;\n    this.options = options;\n  }\n  /**\n   * Applies the modifier to the current drag operation.\n   *\n   * @param operation - The current state of the drag operation\n   * @returns The transformed coordinates\n   *\n   * @remarks\n   * Override this method to implement custom transformation logic.\n   * The default implementation returns the original transform unchanged.\n   */\n  apply(operation) {\n    return operation.transform;\n  }\n};\n\n// src/core/manager/registry.ts\nvar DragDropRegistry = class {\n  /**\n   * Creates a new registry instance.\n   *\n   * @param manager - The drag and drop manager that owns this registry\n   */\n  constructor(manager) {\n    /** Registry for draggable entities */\n    this.draggables = new EntityRegistry();\n    /** Registry for droppable entities */\n    this.droppables = new EntityRegistry();\n    this.plugins = new PluginRegistry(manager);\n    this.sensors = new PluginRegistry(manager);\n    this.modifiers = new PluginRegistry(manager);\n  }\n  register(input, options) {\n    if (input instanceof Draggable) {\n      return this.draggables.register(input.id, input);\n    }\n    if (input instanceof Droppable) {\n      return this.droppables.register(input.id, input);\n    }\n    if (input.prototype instanceof Modifier) {\n      return this.modifiers.register(input, options);\n    }\n    if (input.prototype instanceof Sensor) {\n      return this.sensors.register(input, options);\n    }\n    if (input.prototype instanceof Plugin) {\n      return this.plugins.register(input, options);\n    }\n    throw new Error(\"Invalid instance type\");\n  }\n  unregister(input) {\n    if (input instanceof Entity) {\n      if (input instanceof Draggable) {\n        return this.draggables.unregister(input.id, input);\n      }\n      if (input instanceof Droppable) {\n        return this.droppables.unregister(input.id, input);\n      }\n      return () => {\n      };\n    }\n    if (input.prototype instanceof Modifier) {\n      return this.modifiers.unregister(input);\n    }\n    if (input.prototype instanceof Sensor) {\n      return this.sensors.unregister(input);\n    }\n    if (input.prototype instanceof Plugin) {\n      return this.plugins.unregister(input);\n    }\n    throw new Error(\"Invalid instance type\");\n  }\n  /**\n   * Destroys all registered entities and cleans up resources.\n   *\n   * @remarks\n   * This method:\n   * - Destroys all draggable and droppable entities\n   * - Destroys all plugins, sensors, and modifiers\n   * - Cleans up any associated resources\n   */\n  destroy() {\n    this.draggables.destroy();\n    this.droppables.destroy();\n    this.plugins.destroy();\n    this.sensors.destroy();\n    this.modifiers.destroy();\n  }\n};\nvar _transform_dec, _target_dec, _source_dec, _modifiers_dec2, _targetIdentifier_dec, _sourceIdentifier_dec, _activatorEvent_dec, _canceled_dec, _shape_dec2, _manager2, _previousSource, _shape2, _init6, _canceled, _activatorEvent, _sourceIdentifier, _targetIdentifier, _modifiers2, _transform;\n_shape_dec2 = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.derived], _canceled_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.reactive], _activatorEvent_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.reactive], _sourceIdentifier_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.reactive], _targetIdentifier_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.reactive], _modifiers_dec2 = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.reactive], _source_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.derived], _target_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.derived], _transform_dec = [_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.derived];\nvar DragOperation = class {\n  /**\n   * Creates a new drag operation instance.\n   *\n   * @param manager - The drag and drop manager that owns this operation\n   */\n  constructor(manager) {\n    __runInitializers(_init6, 5, this);\n    __privateAdd(this, _manager2);\n    __privateAdd(this, _previousSource);\n    __privateAdd(this, _shape2, new _dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.ValueHistory(\n      void 0,\n      (a, b) => a && b ? a.equals(b) : a === b\n    ));\n    /** Current status of the drag operation */\n    this.status = new Status();\n    __privateAdd(this, _canceled, __runInitializers(_init6, 8, this, false)), __runInitializers(_init6, 11, this);\n    __privateAdd(this, _activatorEvent, __runInitializers(_init6, 12, this, null)), __runInitializers(_init6, 15, this);\n    __privateAdd(this, _sourceIdentifier, __runInitializers(_init6, 16, this, null)), __runInitializers(_init6, 19, this);\n    __privateAdd(this, _targetIdentifier, __runInitializers(_init6, 20, this, null)), __runInitializers(_init6, 23, this);\n    __privateAdd(this, _modifiers2, __runInitializers(_init6, 24, this, [])), __runInitializers(_init6, 27, this);\n    /** Current position of the dragged entity */\n    this.position = new _dnd_kit_geometry__WEBPACK_IMPORTED_MODULE_2__.Position({ x: 0, y: 0 });\n    __privateAdd(this, _transform, { x: 0, y: 0 });\n    __privateSet(this, _manager2, manager);\n  }\n  get shape() {\n    const { current, initial, previous } = __privateGet(this, _shape2);\n    if (!current || !initial) {\n      return null;\n    }\n    return { current, initial, previous };\n  }\n  /**\n   * Sets the shape of the dragged entity.\n   *\n   * @param value - The new shape or null to reset\n   */\n  set shape(value) {\n    if (!value) {\n      __privateGet(this, _shape2).reset();\n    } else {\n      __privateGet(this, _shape2).current = value;\n    }\n  }\n  get source() {\n    var _a;\n    const identifier = this.sourceIdentifier;\n    if (identifier == null) return null;\n    const value = __privateGet(this, _manager2).registry.draggables.get(identifier);\n    if (value) {\n      __privateSet(this, _previousSource, value);\n    }\n    return (_a = value != null ? value : __privateGet(this, _previousSource)) != null ? _a : null;\n  }\n  get target() {\n    var _a;\n    const identifier = this.targetIdentifier;\n    return identifier != null ? (_a = __privateGet(this, _manager2).registry.droppables.get(identifier)) != null ? _a : null : null;\n  }\n  get transform() {\n    const { x, y } = this.position.delta;\n    let transform = { x, y };\n    for (const modifier of this.modifiers) {\n      transform = modifier.apply(__spreadProps(__spreadValues({}, this.snapshot()), {\n        transform\n      }));\n    }\n    __privateSet(this, _transform, transform);\n    return transform;\n  }\n  /**\n   * Creates a snapshot of the current drag operation state.\n   *\n   * @returns An immutable snapshot of the current operation state\n   */\n  snapshot() {\n    return (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_1__.untracked)(() => ({\n      source: this.source,\n      target: this.target,\n      activatorEvent: this.activatorEvent,\n      transform: __privateGet(this, _transform),\n      shape: this.shape ? (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.snapshot)(this.shape) : null,\n      position: (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.snapshot)(this.position),\n      status: (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.snapshot)(this.status),\n      canceled: this.canceled\n    }));\n  }\n  /**\n   * Resets the drag operation to its initial state.\n   *\n   * @remarks\n   * This method:\n   * - Sets status to idle\n   * - Clears source and target identifiers\n   * - Resets shape history\n   * - Resets position and transform\n   * - Clears modifiers\n   */\n  reset() {\n    (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_1__.batch)(() => {\n      this.status.set(\"idle\" /* Idle */);\n      this.sourceIdentifier = null;\n      this.targetIdentifier = null;\n      __privateGet(this, _shape2).reset();\n      this.position.reset({ x: 0, y: 0 });\n      __privateSet(this, _transform, { x: 0, y: 0 });\n      this.modifiers = [];\n    });\n  }\n};\n_init6 = __decoratorStart(null);\n_manager2 = new WeakMap();\n_previousSource = new WeakMap();\n_shape2 = new WeakMap();\n_canceled = new WeakMap();\n_activatorEvent = new WeakMap();\n_sourceIdentifier = new WeakMap();\n_targetIdentifier = new WeakMap();\n_modifiers2 = new WeakMap();\n_transform = new WeakMap();\n__decorateElement(_init6, 2, \"shape\", _shape_dec2, DragOperation);\n__decorateElement(_init6, 4, \"canceled\", _canceled_dec, DragOperation, _canceled);\n__decorateElement(_init6, 4, \"activatorEvent\", _activatorEvent_dec, DragOperation, _activatorEvent);\n__decorateElement(_init6, 4, \"sourceIdentifier\", _sourceIdentifier_dec, DragOperation, _sourceIdentifier);\n__decorateElement(_init6, 4, \"targetIdentifier\", _targetIdentifier_dec, DragOperation, _targetIdentifier);\n__decorateElement(_init6, 4, \"modifiers\", _modifiers_dec2, DragOperation, _modifiers2);\n__decorateElement(_init6, 2, \"source\", _source_dec, DragOperation);\n__decorateElement(_init6, 2, \"target\", _target_dec, DragOperation);\n__decorateElement(_init6, 2, \"transform\", _transform_dec, DragOperation);\n__decoratorMetadata(_init6, DragOperation);\n\n// src/core/manager/renderer.ts\nvar defaultRenderer = {\n  get rendering() {\n    return Promise.resolve();\n  }\n};\n\n// src/core/manager/manager.ts\nvar DragDropManager = class {\n  /**\n   * Creates a new drag and drop manager instance.\n   *\n   * @param config - Optional configuration for plugins, sensors, modifiers, and renderer\n   */\n  constructor(config) {\n    /**\n     * Cleans up resources and stops any active drag operations.\n     */\n    this.destroy = () => {\n      if (!this.dragOperation.status.idle) {\n        this.actions.stop({ canceled: true });\n      }\n      this.dragOperation.modifiers.forEach((modifier) => modifier.destroy());\n      this.registry.destroy();\n      this.collisionObserver.destroy();\n    };\n    const {\n      plugins = [],\n      sensors = [],\n      modifiers = [],\n      renderer = defaultRenderer\n    } = config != null ? config : {};\n    const monitor = new DragDropMonitor(this);\n    const registry = new DragDropRegistry(this);\n    this.registry = registry;\n    this.monitor = monitor;\n    this.renderer = renderer;\n    this.actions = new DragActions(this);\n    this.dragOperation = new DragOperation(this);\n    this.collisionObserver = new CollisionObserver(this);\n    this.plugins = [CollisionNotifier, ...plugins];\n    this.modifiers = modifiers;\n    this.sensors = sensors;\n    const { destroy } = this;\n    const cleanup = (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_0__.effects)(() => {\n      var _a, _b, _c3;\n      const currentModifiers = (0,_dnd_kit_state__WEBPACK_IMPORTED_MODULE_1__.untracked)(() => this.dragOperation.modifiers);\n      const managerModifiers = this.modifiers;\n      if (currentModifiers !== managerModifiers) {\n        currentModifiers.forEach((modifier) => modifier.destroy());\n      }\n      this.dragOperation.modifiers = (_c3 = (_b = (_a = this.dragOperation.source) == null ? void 0 : _a.modifiers) == null ? void 0 : _b.map((modifier) => {\n        const { plugin, options } = descriptor(modifier);\n        return new plugin(this, options);\n      })) != null ? _c3 : managerModifiers;\n    });\n    this.destroy = () => {\n      cleanup();\n      destroy();\n    };\n  }\n  /**\n   * Gets the list of active plugins.\n   *\n   * @returns Array of active plugin instances\n   */\n  get plugins() {\n    return this.registry.plugins.values;\n  }\n  /**\n   * Sets the list of plugins to be used by the manager.\n   *\n   * @param plugins - Array of plugin constructors or instances\n   */\n  set plugins(plugins) {\n    this.registry.plugins.values = plugins;\n  }\n  /**\n   * Gets the list of active modifiers.\n   *\n   * @returns Array of active modifier instances\n   */\n  get modifiers() {\n    return this.registry.modifiers.values;\n  }\n  /**\n   * Sets the list of modifiers to be used by the manager.\n   *\n   * @param modifiers - Array of modifier constructors or instances\n   */\n  set modifiers(modifiers) {\n    this.registry.modifiers.values = modifiers;\n  }\n  /**\n   * Gets the list of active sensors.\n   *\n   * @returns Array of active sensor instances\n   */\n  get sensors() {\n    return this.registry.sensors.values;\n  }\n  /**\n   * Sets the list of sensors to be used by the manager.\n   *\n   * @param sensors - Array of sensor constructors or instances\n   */\n  set sensors(sensors) {\n    this.registry.sensors.values = sensors;\n  }\n};\n\n\n//# sourceMappingURL=index.js.map\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQGRuZC1raXQrYWJzdHJhY3RAMC4xLjIxL25vZGVfbW9kdWxlcy9AZG5kLWtpdC9hYnN0cmFjdC9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBc0g7QUFDekU7O0FBRTdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhFQUE4RSw2REFBNkQ7QUFDM0k7QUFDQSwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0REFBNEQsMkJBQTJCO0FBQ3ZGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFpRSx3SkFBd0o7QUFDek47QUFDQTtBQUNBLGtFQUFrRSxPQUFPO0FBQ3pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBIQUEwSDtBQUMxSDtBQUNBLEdBQUc7QUFDSDtBQUNBLEtBQUs7QUFDTDtBQUNBLHNDQUFzQyxRQUFRO0FBQzlDLCtDQUErQztBQUMvQztBQUNBLCtEQUErRDtBQUMvRDtBQUNBO0FBQ0E7QUFDQSxtRkFBbUYsK0JBQStCO0FBQ2xIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlCQUFpQixvREFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLHlEQUFTO0FBQ3BCO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHNEQUFNO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLFFBQVE7QUFDOUI7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLDRDQUE0QyxRQUFRO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsa0JBQWtCO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUU2TjtBQUM3TjtBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvZmVkZXJpY29qb3JnZWJvbmVsdG96emkvRGVza3RvcC9Xb3JrL3B1Y2svY29kZS9lY29zeXN0ZW0vcHVjay1jb25maWdzL3NoYWRjbi10d2Jsb2Nrcy9ub2RlX21vZHVsZXMvLnBucG0vQGRuZC1raXQrYWJzdHJhY3RAMC4xLjIxL25vZGVfbW9kdWxlcy9AZG5kLWtpdC9hYnN0cmFjdC9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1bnRyYWNrZWQsIGVmZmVjdCwgZWZmZWN0cywgcmVhY3RpdmUsIGRlcml2ZWQsIFZhbHVlSGlzdG9yeSwgc25hcHNob3QsIGJhdGNoLCBzaWduYWwgfSBmcm9tICdAZG5kLWtpdC9zdGF0ZSc7XG5pbXBvcnQgeyBQb3NpdGlvbiB9IGZyb20gJ0BkbmQta2l0L2dlb21ldHJ5JztcblxudmFyIF9fY3JlYXRlID0gT2JqZWN0LmNyZWF0ZTtcbnZhciBfX2RlZlByb3AgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XG52YXIgX19kZWZQcm9wcyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzO1xudmFyIF9fZ2V0T3duUHJvcERlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yO1xudmFyIF9fZ2V0T3duUHJvcERlc2NzID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM7XG52YXIgX19nZXRPd25Qcm9wU3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHM7XG52YXIgX19oYXNPd25Qcm9wID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcbnZhciBfX3Byb3BJc0VudW0gPSBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlO1xudmFyIF9fa25vd25TeW1ib2wgPSAobmFtZSwgc3ltYm9sKSA9PiAoc3ltYm9sID0gU3ltYm9sW25hbWVdKSA/IHN5bWJvbCA6IFN5bWJvbC5mb3IoXCJTeW1ib2wuXCIgKyBuYW1lKTtcbnZhciBfX3R5cGVFcnJvciA9IChtc2cpID0+IHtcbiAgdGhyb3cgVHlwZUVycm9yKG1zZyk7XG59O1xudmFyIF9fZGVmTm9ybWFsUHJvcCA9IChvYmosIGtleSwgdmFsdWUpID0+IGtleSBpbiBvYmogPyBfX2RlZlByb3Aob2JqLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSwgdmFsdWUgfSkgOiBvYmpba2V5XSA9IHZhbHVlO1xudmFyIF9fc3ByZWFkVmFsdWVzID0gKGEsIGIpID0+IHtcbiAgZm9yICh2YXIgcHJvcCBpbiBiIHx8IChiID0ge30pKVxuICAgIGlmIChfX2hhc093blByb3AuY2FsbChiLCBwcm9wKSlcbiAgICAgIF9fZGVmTm9ybWFsUHJvcChhLCBwcm9wLCBiW3Byb3BdKTtcbiAgaWYgKF9fZ2V0T3duUHJvcFN5bWJvbHMpXG4gICAgZm9yICh2YXIgcHJvcCBvZiBfX2dldE93blByb3BTeW1ib2xzKGIpKSB7XG4gICAgICBpZiAoX19wcm9wSXNFbnVtLmNhbGwoYiwgcHJvcCkpXG4gICAgICAgIF9fZGVmTm9ybWFsUHJvcChhLCBwcm9wLCBiW3Byb3BdKTtcbiAgICB9XG4gIHJldHVybiBhO1xufTtcbnZhciBfX3NwcmVhZFByb3BzID0gKGEsIGIpID0+IF9fZGVmUHJvcHMoYSwgX19nZXRPd25Qcm9wRGVzY3MoYikpO1xudmFyIF9fbmFtZSA9ICh0YXJnZXQsIHZhbHVlKSA9PiBfX2RlZlByb3AodGFyZ2V0LCBcIm5hbWVcIiwgeyB2YWx1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0pO1xudmFyIF9fb2JqUmVzdCA9IChzb3VyY2UsIGV4Y2x1ZGUpID0+IHtcbiAgdmFyIHRhcmdldCA9IHt9O1xuICBmb3IgKHZhciBwcm9wIGluIHNvdXJjZSlcbiAgICBpZiAoX19oYXNPd25Qcm9wLmNhbGwoc291cmNlLCBwcm9wKSAmJiBleGNsdWRlLmluZGV4T2YocHJvcCkgPCAwKVxuICAgICAgdGFyZ2V0W3Byb3BdID0gc291cmNlW3Byb3BdO1xuICBpZiAoc291cmNlICE9IG51bGwgJiYgX19nZXRPd25Qcm9wU3ltYm9scylcbiAgICBmb3IgKHZhciBwcm9wIG9mIF9fZ2V0T3duUHJvcFN5bWJvbHMoc291cmNlKSkge1xuICAgICAgaWYgKGV4Y2x1ZGUuaW5kZXhPZihwcm9wKSA8IDAgJiYgX19wcm9wSXNFbnVtLmNhbGwoc291cmNlLCBwcm9wKSlcbiAgICAgICAgdGFyZ2V0W3Byb3BdID0gc291cmNlW3Byb3BdO1xuICAgIH1cbiAgcmV0dXJuIHRhcmdldDtcbn07XG52YXIgX19kZWNvcmF0b3JTdGFydCA9IChiYXNlKSA9PiB7XG4gIHZhciBfYTtcbiAgcmV0dXJuIFssICwgLCBfX2NyZWF0ZSgoX2EgPSBiYXNlID09IG51bGwgPyB2b2lkIDAgOiBiYXNlW19fa25vd25TeW1ib2woXCJtZXRhZGF0YVwiKV0pICE9IG51bGwgPyBfYSA6IG51bGwpXTtcbn07XG52YXIgX19kZWNvcmF0b3JTdHJpbmdzID0gW1wiY2xhc3NcIiwgXCJtZXRob2RcIiwgXCJnZXR0ZXJcIiwgXCJzZXR0ZXJcIiwgXCJhY2Nlc3NvclwiLCBcImZpZWxkXCIsIFwidmFsdWVcIiwgXCJnZXRcIiwgXCJzZXRcIl07XG52YXIgX19leHBlY3RGbiA9IChmbikgPT4gZm4gIT09IHZvaWQgMCAmJiB0eXBlb2YgZm4gIT09IFwiZnVuY3Rpb25cIiA/IF9fdHlwZUVycm9yKFwiRnVuY3Rpb24gZXhwZWN0ZWRcIikgOiBmbjtcbnZhciBfX2RlY29yYXRvckNvbnRleHQgPSAoa2luZCwgbmFtZSwgZG9uZSwgbWV0YWRhdGEsIGZucykgPT4gKHsga2luZDogX19kZWNvcmF0b3JTdHJpbmdzW2tpbmRdLCBuYW1lLCBtZXRhZGF0YSwgYWRkSW5pdGlhbGl6ZXI6IChmbikgPT4gZG9uZS5fID8gX190eXBlRXJyb3IoXCJBbHJlYWR5IGluaXRpYWxpemVkXCIpIDogZm5zLnB1c2goX19leHBlY3RGbihmbiB8fCBudWxsKSkgfSk7XG52YXIgX19kZWNvcmF0b3JNZXRhZGF0YSA9IChhcnJheSwgdGFyZ2V0KSA9PiBfX2RlZk5vcm1hbFByb3AodGFyZ2V0LCBfX2tub3duU3ltYm9sKFwibWV0YWRhdGFcIiksIGFycmF5WzNdKTtcbnZhciBfX3J1bkluaXRpYWxpemVycyA9IChhcnJheSwgZmxhZ3MsIHNlbGYsIHZhbHVlKSA9PiB7XG4gIGZvciAodmFyIGkgPSAwLCBmbnMgPSBhcnJheVtmbGFncyA+PiAxXSwgbiA9IGZucyAmJiBmbnMubGVuZ3RoOyBpIDwgbjsgaSsrKSBmbGFncyAmIDEgPyBmbnNbaV0uY2FsbChzZWxmKSA6IHZhbHVlID0gZm5zW2ldLmNhbGwoc2VsZiwgdmFsdWUpO1xuICByZXR1cm4gdmFsdWU7XG59O1xudmFyIF9fZGVjb3JhdGVFbGVtZW50ID0gKGFycmF5LCBmbGFncywgbmFtZSwgZGVjb3JhdG9ycywgdGFyZ2V0LCBleHRyYSkgPT4ge1xuICB2YXIgZm4sIGl0LCBkb25lLCBjdHgsIGFjY2VzcywgayA9IGZsYWdzICYgNywgcyA9ICEhKGZsYWdzICYgOCksIHAgPSAhIShmbGFncyAmIDE2KTtcbiAgdmFyIGogPSBrID4gMyA/IGFycmF5Lmxlbmd0aCArIDEgOiBrID8gcyA/IDEgOiAyIDogMCwga2V5ID0gX19kZWNvcmF0b3JTdHJpbmdzW2sgKyA1XTtcbiAgdmFyIGluaXRpYWxpemVycyA9IGsgPiAzICYmIChhcnJheVtqIC0gMV0gPSBbXSksIGV4dHJhSW5pdGlhbGl6ZXJzID0gYXJyYXlbal0gfHwgKGFycmF5W2pdID0gW10pO1xuICB2YXIgZGVzYyA9IGsgJiYgKCFwICYmICFzICYmICh0YXJnZXQgPSB0YXJnZXQucHJvdG90eXBlKSwgayA8IDUgJiYgKGsgPiAzIHx8ICFwKSAmJiBfX2dldE93blByb3BEZXNjKGsgPCA0ID8gdGFyZ2V0IDogeyBnZXQgW25hbWVdKCkge1xuICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgZXh0cmEpO1xuICB9LCBzZXQgW25hbWVdKHgpIHtcbiAgICByZXR1cm4gX19wcml2YXRlU2V0KHRoaXMsIGV4dHJhLCB4KTtcbiAgfSB9LCBuYW1lKSk7XG4gIGsgPyBwICYmIGsgPCA0ICYmIF9fbmFtZShleHRyYSwgKGsgPiAyID8gXCJzZXQgXCIgOiBrID4gMSA/IFwiZ2V0IFwiIDogXCJcIikgKyBuYW1lKSA6IF9fbmFtZSh0YXJnZXQsIG5hbWUpO1xuICBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgIGN0eCA9IF9fZGVjb3JhdG9yQ29udGV4dChrLCBuYW1lLCBkb25lID0ge30sIGFycmF5WzNdLCBleHRyYUluaXRpYWxpemVycyk7XG4gICAgaWYgKGspIHtcbiAgICAgIGN0eC5zdGF0aWMgPSBzLCBjdHgucHJpdmF0ZSA9IHAsIGFjY2VzcyA9IGN0eC5hY2Nlc3MgPSB7IGhhczogcCA/ICh4KSA9PiBfX3ByaXZhdGVJbih0YXJnZXQsIHgpIDogKHgpID0+IG5hbWUgaW4geCB9O1xuICAgICAgaWYgKGsgXiAzKSBhY2Nlc3MuZ2V0ID0gcCA/ICh4KSA9PiAoayBeIDEgPyBfX3ByaXZhdGVHZXQgOiBfX3ByaXZhdGVNZXRob2QpKHgsIHRhcmdldCwgayBeIDQgPyBleHRyYSA6IGRlc2MuZ2V0KSA6ICh4KSA9PiB4W25hbWVdO1xuICAgICAgaWYgKGsgPiAyKSBhY2Nlc3Muc2V0ID0gcCA/ICh4LCB5KSA9PiBfX3ByaXZhdGVTZXQoeCwgdGFyZ2V0LCB5LCBrIF4gNCA/IGV4dHJhIDogZGVzYy5zZXQpIDogKHgsIHkpID0+IHhbbmFtZV0gPSB5O1xuICAgIH1cbiAgICBpdCA9ICgwLCBkZWNvcmF0b3JzW2ldKShrID8gayA8IDQgPyBwID8gZXh0cmEgOiBkZXNjW2tleV0gOiBrID4gNCA/IHZvaWQgMCA6IHsgZ2V0OiBkZXNjLmdldCwgc2V0OiBkZXNjLnNldCB9IDogdGFyZ2V0LCBjdHgpLCBkb25lLl8gPSAxO1xuICAgIGlmIChrIF4gNCB8fCBpdCA9PT0gdm9pZCAwKSBfX2V4cGVjdEZuKGl0KSAmJiAoayA+IDQgPyBpbml0aWFsaXplcnMudW5zaGlmdChpdCkgOiBrID8gcCA/IGV4dHJhID0gaXQgOiBkZXNjW2tleV0gPSBpdCA6IHRhcmdldCA9IGl0KTtcbiAgICBlbHNlIGlmICh0eXBlb2YgaXQgIT09IFwib2JqZWN0XCIgfHwgaXQgPT09IG51bGwpIF9fdHlwZUVycm9yKFwiT2JqZWN0IGV4cGVjdGVkXCIpO1xuICAgIGVsc2UgX19leHBlY3RGbihmbiA9IGl0LmdldCkgJiYgKGRlc2MuZ2V0ID0gZm4pLCBfX2V4cGVjdEZuKGZuID0gaXQuc2V0KSAmJiAoZGVzYy5zZXQgPSBmbiksIF9fZXhwZWN0Rm4oZm4gPSBpdC5pbml0KSAmJiBpbml0aWFsaXplcnMudW5zaGlmdChmbik7XG4gIH1cbiAgcmV0dXJuIGsgfHwgX19kZWNvcmF0b3JNZXRhZGF0YShhcnJheSwgdGFyZ2V0KSwgZGVzYyAmJiBfX2RlZlByb3AodGFyZ2V0LCBuYW1lLCBkZXNjKSwgcCA/IGsgXiA0ID8gZXh0cmEgOiBkZXNjIDogdGFyZ2V0O1xufTtcbnZhciBfX2FjY2Vzc0NoZWNrID0gKG9iaiwgbWVtYmVyLCBtc2cpID0+IG1lbWJlci5oYXMob2JqKSB8fCBfX3R5cGVFcnJvcihcIkNhbm5vdCBcIiArIG1zZyk7XG52YXIgX19wcml2YXRlSW4gPSAobWVtYmVyLCBvYmopID0+IE9iamVjdChvYmopICE9PSBvYmogPyBfX3R5cGVFcnJvcignQ2Fubm90IHVzZSB0aGUgXCJpblwiIG9wZXJhdG9yIG9uIHRoaXMgdmFsdWUnKSA6IG1lbWJlci5oYXMob2JqKTtcbnZhciBfX3ByaXZhdGVHZXQgPSAob2JqLCBtZW1iZXIsIGdldHRlcikgPT4gKF9fYWNjZXNzQ2hlY2sob2JqLCBtZW1iZXIsIFwicmVhZCBmcm9tIHByaXZhdGUgZmllbGRcIiksIGdldHRlciA/IGdldHRlci5jYWxsKG9iaikgOiBtZW1iZXIuZ2V0KG9iaikpO1xudmFyIF9fcHJpdmF0ZUFkZCA9IChvYmosIG1lbWJlciwgdmFsdWUpID0+IG1lbWJlci5oYXMob2JqKSA/IF9fdHlwZUVycm9yKFwiQ2Fubm90IGFkZCB0aGUgc2FtZSBwcml2YXRlIG1lbWJlciBtb3JlIHRoYW4gb25jZVwiKSA6IG1lbWJlciBpbnN0YW5jZW9mIFdlYWtTZXQgPyBtZW1iZXIuYWRkKG9iaikgOiBtZW1iZXIuc2V0KG9iaiwgdmFsdWUpO1xudmFyIF9fcHJpdmF0ZVNldCA9IChvYmosIG1lbWJlciwgdmFsdWUsIHNldHRlcikgPT4gKF9fYWNjZXNzQ2hlY2sob2JqLCBtZW1iZXIsIFwid3JpdGUgdG8gcHJpdmF0ZSBmaWVsZFwiKSwgc2V0dGVyID8gc2V0dGVyLmNhbGwob2JqLCB2YWx1ZSkgOiBtZW1iZXIuc2V0KG9iaiwgdmFsdWUpLCB2YWx1ZSk7XG52YXIgX19wcml2YXRlTWV0aG9kID0gKG9iaiwgbWVtYmVyLCBtZXRob2QpID0+IChfX2FjY2Vzc0NoZWNrKG9iaiwgbWVtYmVyLCBcImFjY2VzcyBwcml2YXRlIG1ldGhvZFwiKSwgbWV0aG9kKTtcblxuLy8gc3JjL2NvcmUvcGx1Z2lucy91dGlsaXRpZXMudHNcbmZ1bmN0aW9uIGNvbmZpZ3VyZShwbHVnaW4sIG9wdGlvbnMpIHtcbiAgcmV0dXJuIHtcbiAgICBwbHVnaW4sXG4gICAgb3B0aW9uc1xuICB9O1xufVxuZnVuY3Rpb24gY29uZmlndXJhdG9yKHBsdWdpbikge1xuICByZXR1cm4gKG9wdGlvbnMpID0+IHtcbiAgICByZXR1cm4gY29uZmlndXJlKHBsdWdpbiwgb3B0aW9ucyk7XG4gIH07XG59XG5mdW5jdGlvbiBkZXNjcmlwdG9yKHBsdWdpbikge1xuICBpZiAodHlwZW9mIHBsdWdpbiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHBsdWdpbixcbiAgICAgIG9wdGlvbnM6IHZvaWQgMFxuICAgIH07XG4gIH1cbiAgcmV0dXJuIHBsdWdpbjtcbn1cblxuLy8gc3JjL2NvcmUvcGx1Z2lucy9wbHVnaW4udHNcbnZhciBfZGlzYWJsZWRfZGVjLCBfaW5pdCwgX2Rpc2FibGVkLCBfY2xlYW51cEZ1bmN0aW9ucztcbl9kaXNhYmxlZF9kZWMgPSBbcmVhY3RpdmVdO1xudmFyIFBsdWdpbiA9IGNsYXNzIHtcbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBuZXcgcGx1Z2luIGluc3RhbmNlLlxuICAgKlxuICAgKiBAcGFyYW0gbWFuYWdlciAtIFRoZSBkcmFnIGFuZCBkcm9wIG1hbmFnZXIgdGhhdCBvd25zIHRoaXMgcGx1Z2luXG4gICAqIEBwYXJhbSBvcHRpb25zIC0gT3B0aW9uYWwgY29uZmlndXJhdGlvbiBmb3IgdGhlIHBsdWdpblxuICAgKi9cbiAgY29uc3RydWN0b3IobWFuYWdlciwgb3B0aW9ucykge1xuICAgIHRoaXMubWFuYWdlciA9IG1hbmFnZXI7XG4gICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2Rpc2FibGVkLCBfX3J1bkluaXRpYWxpemVycyhfaW5pdCwgOCwgdGhpcywgZmFsc2UpKSwgX19ydW5Jbml0aWFsaXplcnMoX2luaXQsIDExLCB0aGlzKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2NsZWFudXBGdW5jdGlvbnMsIC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCkpO1xuICB9XG4gIC8qKlxuICAgKiBFbmFibGVzIGEgZGlzYWJsZWQgcGx1Z2luIGluc3RhbmNlLlxuICAgKlxuICAgKiBAcmVtYXJrc1xuICAgKiBUaGlzIG1ldGhvZCB0cmlnZ2VycyBlZmZlY3RzIHdoZW4gY2FsbGVkLlxuICAgKi9cbiAgZW5hYmxlKCkge1xuICAgIHRoaXMuZGlzYWJsZWQgPSBmYWxzZTtcbiAgfVxuICAvKipcbiAgICogRGlzYWJsZXMgYW4gZW5hYmxlZCBwbHVnaW4gaW5zdGFuY2UuXG4gICAqXG4gICAqIEByZW1hcmtzXG4gICAqIFRoaXMgbWV0aG9kIHRyaWdnZXJzIGVmZmVjdHMgd2hlbiBjYWxsZWQuXG4gICAqL1xuICBkaXNhYmxlKCkge1xuICAgIHRoaXMuZGlzYWJsZWQgPSB0cnVlO1xuICB9XG4gIC8qKlxuICAgKiBDaGVja3MgaWYgdGhlIHBsdWdpbiBpbnN0YW5jZSBpcyBkaXNhYmxlZC5cbiAgICpcbiAgICogQHJldHVybnMgdHJ1ZSBpZiB0aGUgcGx1Z2luIGlzIGRpc2FibGVkXG4gICAqIEByZW1hcmtzXG4gICAqIFRoaXMgbWV0aG9kIGRvZXMgbm90IHRyaWdnZXIgZWZmZWN0cyB3aGVuIGFjY2Vzc2VkLlxuICAgKi9cbiAgaXNEaXNhYmxlZCgpIHtcbiAgICByZXR1cm4gdW50cmFja2VkKCgpID0+IHtcbiAgICAgIHJldHVybiB0aGlzLmRpc2FibGVkO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBDb25maWd1cmVzIGEgcGx1Z2luIGluc3RhbmNlIHdpdGggbmV3IG9wdGlvbnMuXG4gICAqXG4gICAqIEBwYXJhbSBvcHRpb25zIC0gVGhlIG5ldyBvcHRpb25zIHRvIGFwcGx5XG4gICAqL1xuICBjb25maWd1cmUob3B0aW9ucykge1xuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gIH1cbiAgLyoqXG4gICAqIFJlZ2lzdGVycyBhbiBlZmZlY3QgdGhhdCB3aWxsIGJlIGNsZWFuZWQgdXAgd2hlbiB0aGUgcGx1Z2luIGlzIGRlc3Ryb3llZC5cbiAgICpcbiAgICogQHBhcmFtIGNhbGxiYWNrIC0gVGhlIGVmZmVjdCBjYWxsYmFjayB0byByZWdpc3RlclxuICAgKiBAcmV0dXJucyBBIGZ1bmN0aW9uIHRvIGRpc3Bvc2Ugb2YgdGhlIGVmZmVjdFxuICAgKi9cbiAgcmVnaXN0ZXJFZmZlY3QoY2FsbGJhY2spIHtcbiAgICBjb25zdCBkaXNwb3NlID0gZWZmZWN0KGNhbGxiYWNrLmJpbmQodGhpcykpO1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfY2xlYW51cEZ1bmN0aW9ucykuYWRkKGRpc3Bvc2UpO1xuICAgIHJldHVybiBkaXNwb3NlO1xuICB9XG4gIC8qKlxuICAgKiBEZXN0cm95cyBhIHBsdWdpbiBpbnN0YW5jZSBhbmQgY2xlYW5zIHVwIGl0cyByZXNvdXJjZXMuXG4gICAqXG4gICAqIEByZW1hcmtzXG4gICAqIFRoaXMgbWV0aG9kOlxuICAgKiAtIENhbGxzIGFsbCByZWdpc3RlcmVkIGNsZWFudXAgZnVuY3Rpb25zXG4gICAqIC0gU2hvdWxkIGJlIG92ZXJyaWRkZW4gYnkgc3ViY2xhc3NlcyB0byBjbGVhbiB1cCBhZGRpdGlvbmFsIHJlc291cmNlc1xuICAgKi9cbiAgZGVzdHJveSgpIHtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2NsZWFudXBGdW5jdGlvbnMpLmZvckVhY2goKGNsZWFudXApID0+IGNsZWFudXAoKSk7XG4gIH1cbiAgLyoqXG4gICAqIENvbmZpZ3VyZXMgYSBwbHVnaW4gY29uc3RydWN0b3Igd2l0aCBvcHRpb25zLlxuICAgKlxuICAgKiBAcGFyYW0gb3B0aW9ucyAtIFRoZSBvcHRpb25zIHRvIGNvbmZpZ3VyZSB0aGUgY29uc3RydWN0b3Igd2l0aFxuICAgKiBAcmV0dXJucyBUaGUgY29uZmlndXJlZCBwbHVnaW4gY29uc3RydWN0b3JcbiAgICpcbiAgICogQHJlbWFya3NcbiAgICogVGhpcyBtZXRob2QgaXMgdXNlZCB0byBjb25maWd1cmUgdGhlIG9wdGlvbnMgdGhhdCB0aGVcbiAgICogcGx1Z2luIGNvbnN0cnVjdG9yIHdpbGwgdXNlIHRvIGNyZWF0ZSBwbHVnaW4gaW5zdGFuY2VzLlxuICAgKi9cbiAgc3RhdGljIGNvbmZpZ3VyZShvcHRpb25zKSB7XG4gICAgcmV0dXJuIGNvbmZpZ3VyZSh0aGlzLCBvcHRpb25zKTtcbiAgfVxufTtcbl9pbml0ID0gX19kZWNvcmF0b3JTdGFydChudWxsKTtcbl9kaXNhYmxlZCA9IG5ldyBXZWFrTWFwKCk7XG5fY2xlYW51cEZ1bmN0aW9ucyA9IG5ldyBXZWFrTWFwKCk7XG5fX2RlY29yYXRlRWxlbWVudChfaW5pdCwgNCwgXCJkaXNhYmxlZFwiLCBfZGlzYWJsZWRfZGVjLCBQbHVnaW4sIF9kaXNhYmxlZCk7XG5fX2RlY29yYXRvck1ldGFkYXRhKF9pbml0LCBQbHVnaW4pO1xudmFyIENvcmVQbHVnaW4gPSBjbGFzcyBleHRlbmRzIFBsdWdpbiB7XG59O1xuXG4vLyBzcmMvY29yZS9wbHVnaW5zL3JlZ2lzdHJ5LnRzXG52YXIgX3ByZXZpb3VzVmFsdWVzO1xudmFyIFBsdWdpblJlZ2lzdHJ5ID0gY2xhc3Mge1xuICAvKipcbiAgICogQ3JlYXRlcyBhIG5ldyBwbHVnaW4gcmVnaXN0cnkuXG4gICAqXG4gICAqIEBwYXJhbSBtYW5hZ2VyIC0gVGhlIGRyYWcgYW5kIGRyb3AgbWFuYWdlciB0aGF0IG93bnMgdGhpcyByZWdpc3RyeVxuICAgKi9cbiAgY29uc3RydWN0b3IobWFuYWdlcikge1xuICAgIHRoaXMubWFuYWdlciA9IG1hbmFnZXI7XG4gICAgdGhpcy5pbnN0YW5jZXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfcHJldmlvdXNWYWx1ZXMsIFtdKTtcbiAgfVxuICAvKipcbiAgICogR2V0cyBhbGwgcmVnaXN0ZXJlZCBwbHVnaW4gaW5zdGFuY2VzLlxuICAgKlxuICAgKiBAcmV0dXJucyBBbiBhcnJheSBvZiBhbGwgYWN0aXZlIHBsdWdpbiBpbnN0YW5jZXNcbiAgICovXG4gIGdldCB2YWx1ZXMoKSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5pbnN0YW5jZXMudmFsdWVzKCkpO1xuICB9XG4gIC8qKlxuICAgKiBTZXRzIHRoZSBsaXN0IG9mIHBsdWdpbnMgdG8gYmUgdXNlZCBieSB0aGUgcmVnaXN0cnkuXG4gICAqXG4gICAqIEBwYXJhbSBlbnRyaWVzIC0gQXJyYXkgb2YgcGx1Z2luIGNvbnN0cnVjdG9ycyBvciBkZXNjcmlwdG9yc1xuICAgKiBAcmVtYXJrc1xuICAgKiBUaGlzIG1ldGhvZDpcbiAgICogLSBGaWx0ZXJzIG91dCBkdXBsaWNhdGUgcGx1Z2luc1xuICAgKiAtIFVucmVnaXN0ZXJzIHBsdWdpbnMgdGhhdCBhcmUgbm8gbG9uZ2VyIGluIHVzZVxuICAgKiAtIFJlZ2lzdGVycyBuZXcgcGx1Z2lucyB3aXRoIHRoZWlyIG9wdGlvbnNcbiAgICovXG4gIHNldCB2YWx1ZXMoZW50cmllcykge1xuICAgIGNvbnN0IGRlc2NyaXB0b3JzID0gZW50cmllcy5tYXAoZGVzY3JpcHRvcikucmVkdWNlUmlnaHQoKGFjYywgZGVzY3JpcHRvcjIpID0+IHtcbiAgICAgIGlmIChhY2Muc29tZSgoeyBwbHVnaW4gfSkgPT4gcGx1Z2luID09PSBkZXNjcmlwdG9yMi5wbHVnaW4pKSB7XG4gICAgICAgIHJldHVybiBhY2M7XG4gICAgICB9XG4gICAgICByZXR1cm4gW2Rlc2NyaXB0b3IyLCAuLi5hY2NdO1xuICAgIH0sIFtdKTtcbiAgICBjb25zdCBjb25zdHJ1Y3RvcnMgPSBkZXNjcmlwdG9ycy5tYXAoKHsgcGx1Z2luIH0pID0+IHBsdWdpbik7XG4gICAgZm9yIChjb25zdCBwbHVnaW4gb2YgX19wcml2YXRlR2V0KHRoaXMsIF9wcmV2aW91c1ZhbHVlcykpIHtcbiAgICAgIGlmICghY29uc3RydWN0b3JzLmluY2x1ZGVzKHBsdWdpbikpIHtcbiAgICAgICAgaWYgKHBsdWdpbi5wcm90b3R5cGUgaW5zdGFuY2VvZiBDb3JlUGx1Z2luKSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51bnJlZ2lzdGVyKHBsdWdpbik7XG4gICAgICB9XG4gICAgfVxuICAgIGZvciAoY29uc3QgeyBwbHVnaW4sIG9wdGlvbnMgfSBvZiBkZXNjcmlwdG9ycykge1xuICAgICAgdGhpcy5yZWdpc3RlcihwbHVnaW4sIG9wdGlvbnMpO1xuICAgIH1cbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX3ByZXZpb3VzVmFsdWVzLCBjb25zdHJ1Y3RvcnMpO1xuICB9XG4gIC8qKlxuICAgKiBHZXRzIGEgcGx1Z2luIGluc3RhbmNlIGJ5IGl0cyBjb25zdHJ1Y3Rvci5cbiAgICpcbiAgICogQHBhcmFtIHBsdWdpbiAtIFRoZSBwbHVnaW4gY29uc3RydWN0b3IgdG8gbG9vayB1cFxuICAgKiBAcmV0dXJucyBUaGUgcGx1Z2luIGluc3RhbmNlIG9yIHVuZGVmaW5lZCBpZiBub3QgZm91bmRcbiAgICovXG4gIGdldChwbHVnaW4pIHtcbiAgICBjb25zdCBpbnN0YW5jZSA9IHRoaXMuaW5zdGFuY2VzLmdldChwbHVnaW4pO1xuICAgIHJldHVybiBpbnN0YW5jZTtcbiAgfVxuICAvKipcbiAgICogUmVnaXN0ZXJzIGEgbmV3IHBsdWdpbiBpbnN0YW5jZS5cbiAgICpcbiAgICogQHBhcmFtIHBsdWdpbiAtIFRoZSBwbHVnaW4gY29uc3RydWN0b3IgdG8gcmVnaXN0ZXJcbiAgICogQHBhcmFtIG9wdGlvbnMgLSBPcHRpb25hbCBjb25maWd1cmF0aW9uIGZvciB0aGUgcGx1Z2luXG4gICAqIEByZXR1cm5zIFRoZSByZWdpc3RlcmVkIHBsdWdpbiBpbnN0YW5jZVxuICAgKiBAcmVtYXJrc1xuICAgKiBJZiB0aGUgcGx1Z2luIGlzIGFscmVhZHkgcmVnaXN0ZXJlZCwgaXRzIG9wdGlvbnMgd2lsbCBiZSB1cGRhdGVkXG4gICAqIGFuZCB0aGUgZXhpc3RpbmcgaW5zdGFuY2Ugd2lsbCBiZSByZXR1cm5lZC5cbiAgICovXG4gIHJlZ2lzdGVyKHBsdWdpbiwgb3B0aW9ucykge1xuICAgIGNvbnN0IGV4aXN0aW5nSW5zdGFuY2UgPSB0aGlzLmluc3RhbmNlcy5nZXQocGx1Z2luKTtcbiAgICBpZiAoZXhpc3RpbmdJbnN0YW5jZSkge1xuICAgICAgaWYgKGV4aXN0aW5nSW5zdGFuY2Uub3B0aW9ucyAhPT0gb3B0aW9ucykge1xuICAgICAgICBleGlzdGluZ0luc3RhbmNlLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGV4aXN0aW5nSW5zdGFuY2U7XG4gICAgfVxuICAgIGNvbnN0IGluc3RhbmNlID0gbmV3IHBsdWdpbih0aGlzLm1hbmFnZXIsIG9wdGlvbnMpO1xuICAgIHRoaXMuaW5zdGFuY2VzLnNldChwbHVnaW4sIGluc3RhbmNlKTtcbiAgICByZXR1cm4gaW5zdGFuY2U7XG4gIH1cbiAgLyoqXG4gICAqIFVucmVnaXN0ZXJzIGEgcGx1Z2luIGluc3RhbmNlLlxuICAgKlxuICAgKiBAcGFyYW0gcGx1Z2luIC0gVGhlIHBsdWdpbiBjb25zdHJ1Y3RvciB0byB1bnJlZ2lzdGVyXG4gICAqIEByZW1hcmtzXG4gICAqIFRoaXMgbWV0aG9kOlxuICAgKiAtIERlc3Ryb3lzIHRoZSBwbHVnaW4gaW5zdGFuY2VcbiAgICogLSBSZW1vdmVzIGl0IGZyb20gdGhlIHJlZ2lzdHJ5XG4gICAqL1xuICB1bnJlZ2lzdGVyKHBsdWdpbikge1xuICAgIGNvbnN0IGluc3RhbmNlID0gdGhpcy5pbnN0YW5jZXMuZ2V0KHBsdWdpbik7XG4gICAgaWYgKGluc3RhbmNlKSB7XG4gICAgICBpbnN0YW5jZS5kZXN0cm95KCk7XG4gICAgICB0aGlzLmluc3RhbmNlcy5kZWxldGUocGx1Z2luKTtcbiAgICB9XG4gIH1cbiAgLyoqXG4gICAqIERlc3Ryb3lzIGFsbCByZWdpc3RlcmVkIHBsdWdpbiBpbnN0YW5jZXMuXG4gICAqXG4gICAqIEByZW1hcmtzXG4gICAqIFRoaXMgbWV0aG9kOlxuICAgKiAtIENhbGxzIGRlc3Ryb3koKSBvbiBhbGwgcGx1Z2luIGluc3RhbmNlc1xuICAgKiAtIENsZWFycyB0aGUgcmVnaXN0cnlcbiAgICovXG4gIGRlc3Ryb3koKSB7XG4gICAgZm9yIChjb25zdCBwbHVnaW4gb2YgdGhpcy5pbnN0YW5jZXMudmFsdWVzKCkpIHtcbiAgICAgIHBsdWdpbi5kZXN0cm95KCk7XG4gICAgfVxuICAgIHRoaXMuaW5zdGFuY2VzLmNsZWFyKCk7XG4gIH1cbn07XG5fcHJldmlvdXNWYWx1ZXMgPSBuZXcgV2Vha01hcCgpO1xuXG4vLyBzcmMvY29yZS9jb2xsaXNpb24vdXRpbGl0aWVzLnRzXG5mdW5jdGlvbiBzb3J0Q29sbGlzaW9ucyhhLCBiKSB7XG4gIGlmIChhLnByaW9yaXR5ID09PSBiLnByaW9yaXR5KSB7XG4gICAgaWYgKGEudHlwZSA9PT0gYi50eXBlKSB7XG4gICAgICByZXR1cm4gYi52YWx1ZSAtIGEudmFsdWU7XG4gICAgfVxuICAgIHJldHVybiBiLnR5cGUgLSBhLnR5cGU7XG4gIH1cbiAgcmV0dXJuIGIucHJpb3JpdHkgLSBhLnByaW9yaXR5O1xufVxuXG4vLyBzcmMvY29yZS9jb2xsaXNpb24vb2JzZXJ2ZXIudHNcbnZhciBERUZBVUxUX1ZBTFVFID0gW107XG52YXIgX3ByZXZpb3VzQ29vcmRpbmF0ZXMsIF9jb2xsaXNpb25zO1xudmFyIENvbGxpc2lvbk9ic2VydmVyID0gY2xhc3MgZXh0ZW5kcyBQbHVnaW4ge1xuICAvKipcbiAgICogQ3JlYXRlcyBhIG5ldyBDb2xsaXNpb25PYnNlcnZlciBpbnN0YW5jZS5cbiAgICpcbiAgICogQHBhcmFtIG1hbmFnZXIgLSBUaGUgZHJhZyBkcm9wIG1hbmFnZXIgaW5zdGFuY2VcbiAgICovXG4gIGNvbnN0cnVjdG9yKG1hbmFnZXIpIHtcbiAgICBzdXBlcihtYW5hZ2VyKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3ByZXZpb3VzQ29vcmRpbmF0ZXMpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfY29sbGlzaW9ucyk7XG4gICAgdGhpcy5jb21wdXRlQ29sbGlzaW9ucyA9IHRoaXMuY29tcHV0ZUNvbGxpc2lvbnMuYmluZCh0aGlzKTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX2NvbGxpc2lvbnMsIHNpZ25hbChERUZBVUxUX1ZBTFVFKSk7XG4gICAgdGhpcy5kZXN0cm95ID0gZWZmZWN0cyhcbiAgICAgICgpID0+IHtcbiAgICAgICAgY29uc3QgY29sbGlzaW9ucyA9IHRoaXMuY29tcHV0ZUNvbGxpc2lvbnMoKTtcbiAgICAgICAgY29uc3QgY29vcmRpbmF0ZXMgPSB1bnRyYWNrZWQoXG4gICAgICAgICAgKCkgPT4gdGhpcy5tYW5hZ2VyLmRyYWdPcGVyYXRpb24ucG9zaXRpb24uY3VycmVudFxuICAgICAgICApO1xuICAgICAgICBpZiAoY29sbGlzaW9ucyAhPT0gREVGQVVMVF9WQUxVRSkge1xuICAgICAgICAgIGNvbnN0IHByZXZpb3VzQ29vcmRpbmF0ZXMgPSBfX3ByaXZhdGVHZXQodGhpcywgX3ByZXZpb3VzQ29vcmRpbmF0ZXMpO1xuICAgICAgICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfcHJldmlvdXNDb29yZGluYXRlcywgY29vcmRpbmF0ZXMpO1xuICAgICAgICAgIGlmIChwcmV2aW91c0Nvb3JkaW5hdGVzICYmIGNvb3JkaW5hdGVzLnggPT0gcHJldmlvdXNDb29yZGluYXRlcy54ICYmIGNvb3JkaW5hdGVzLnkgPT0gcHJldmlvdXNDb29yZGluYXRlcy55KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfcHJldmlvdXNDb29yZGluYXRlcywgdm9pZCAwKTtcbiAgICAgICAgfVxuICAgICAgICBfX3ByaXZhdGVHZXQodGhpcywgX2NvbGxpc2lvbnMpLnZhbHVlID0gY29sbGlzaW9ucztcbiAgICAgIH0sXG4gICAgICAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgZHJhZ09wZXJhdGlvbiB9ID0gdGhpcy5tYW5hZ2VyO1xuICAgICAgICBpZiAoZHJhZ09wZXJhdGlvbi5zdGF0dXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICB0aGlzLmZvcmNlVXBkYXRlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICApO1xuICB9XG4gIC8qKlxuICAgKiBGb3JjZXMgYW4gaW1tZWRpYXRlIHVwZGF0ZSBvZiBjb2xsaXNpb24gZGV0ZWN0aW9uLlxuICAgKlxuICAgKiBAcGFyYW0gaW1tZWRpYXRlIC0gSWYgdHJ1ZSwgdXBkYXRlcyBjb2xsaXNpb25zIGltbWVkaWF0ZWx5LiBJZiBmYWxzZSwgcmVzZXRzIHByZXZpb3VzIGNvb3JkaW5hdGVzLlxuICAgKi9cbiAgZm9yY2VVcGRhdGUoaW1tZWRpYXRlID0gdHJ1ZSkge1xuICAgIHVudHJhY2tlZCgoKSA9PiB7XG4gICAgICBpZiAoaW1tZWRpYXRlKSB7XG4gICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfY29sbGlzaW9ucykudmFsdWUgPSB0aGlzLmNvbXB1dGVDb2xsaXNpb25zKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfX3ByaXZhdGVTZXQodGhpcywgX3ByZXZpb3VzQ29vcmRpbmF0ZXMsIHZvaWQgMCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIENvbXB1dGVzIGNvbGxpc2lvbnMgYmV0d2VlbiBkcmFnZ2FibGUgYW5kIGRyb3BwYWJsZSBlbGVtZW50cy5cbiAgICpcbiAgICogQHBhcmFtIGVudHJpZXMgLSBPcHRpb25hbCBhcnJheSBvZiBkcm9wcGFibGUgZWxlbWVudHMgdG8gY2hlY2suIElmIG5vdCBwcm92aWRlZCwgdXNlcyBhbGwgcmVnaXN0ZXJlZCBkcm9wcGFibGVzLlxuICAgKiBAcGFyYW0gY29sbGlzaW9uRGV0ZWN0b3IgLSBPcHRpb25hbCBjdXN0b20gY29sbGlzaW9uIGRldGVjdG9yIGZ1bmN0aW9uXG4gICAqIEByZXR1cm5zIEFycmF5IG9mIGRldGVjdGVkIGNvbGxpc2lvbnMsIHNvcnRlZCBieSBwcmlvcml0eVxuICAgKi9cbiAgY29tcHV0ZUNvbGxpc2lvbnMoZW50cmllcywgY29sbGlzaW9uRGV0ZWN0b3IpIHtcbiAgICBjb25zdCB7IHJlZ2lzdHJ5LCBkcmFnT3BlcmF0aW9uIH0gPSB0aGlzLm1hbmFnZXI7XG4gICAgY29uc3QgeyBzb3VyY2UsIHNoYXBlLCBzdGF0dXMgfSA9IGRyYWdPcGVyYXRpb247XG4gICAgaWYgKCFzdGF0dXMuaW5pdGlhbGl6ZWQgfHwgIXNoYXBlKSB7XG4gICAgICByZXR1cm4gREVGQVVMVF9WQUxVRTtcbiAgICB9XG4gICAgY29uc3QgY29sbGlzaW9ucyA9IFtdO1xuICAgIGNvbnN0IHBvdGVudGlhbFRhcmdldHMgPSBbXTtcbiAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIGVudHJpZXMgIT0gbnVsbCA/IGVudHJpZXMgOiByZWdpc3RyeS5kcm9wcGFibGVzKSB7XG4gICAgICBpZiAoZW50cnkuZGlzYWJsZWQpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBpZiAoc291cmNlICYmICFlbnRyeS5hY2NlcHRzKHNvdXJjZSkpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBjb25zdCBkZXRlY3RDb2xsaXNpb24gPSBjb2xsaXNpb25EZXRlY3RvciAhPSBudWxsID8gY29sbGlzaW9uRGV0ZWN0b3IgOiBlbnRyeS5jb2xsaXNpb25EZXRlY3RvcjtcbiAgICAgIGlmICghZGV0ZWN0Q29sbGlzaW9uKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgcG90ZW50aWFsVGFyZ2V0cy5wdXNoKGVudHJ5KTtcbiAgICAgIHZvaWQgZW50cnkuc2hhcGU7XG4gICAgICBjb25zdCBjb2xsaXNpb24gPSB1bnRyYWNrZWQoXG4gICAgICAgICgpID0+IGRldGVjdENvbGxpc2lvbih7XG4gICAgICAgICAgZHJvcHBhYmxlOiBlbnRyeSxcbiAgICAgICAgICBkcmFnT3BlcmF0aW9uXG4gICAgICAgIH0pXG4gICAgICApO1xuICAgICAgaWYgKGNvbGxpc2lvbikge1xuICAgICAgICBpZiAoZW50cnkuY29sbGlzaW9uUHJpb3JpdHkgIT0gbnVsbCkge1xuICAgICAgICAgIGNvbGxpc2lvbi5wcmlvcml0eSA9IGVudHJ5LmNvbGxpc2lvblByaW9yaXR5O1xuICAgICAgICB9XG4gICAgICAgIGNvbGxpc2lvbnMucHVzaChjb2xsaXNpb24pO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAocG90ZW50aWFsVGFyZ2V0cy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBERUZBVUxUX1ZBTFVFO1xuICAgIH1cbiAgICBjb2xsaXNpb25zLnNvcnQoc29ydENvbGxpc2lvbnMpO1xuICAgIHJldHVybiBjb2xsaXNpb25zO1xuICB9XG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjdXJyZW50IGNvbGxpc2lvbnMgc2lnbmFsIHZhbHVlLlxuICAgKi9cbiAgZ2V0IGNvbGxpc2lvbnMoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfY29sbGlzaW9ucykudmFsdWU7XG4gIH1cbn07XG5fcHJldmlvdXNDb29yZGluYXRlcyA9IG5ldyBXZWFrTWFwKCk7XG5fY29sbGlzaW9ucyA9IG5ldyBXZWFrTWFwKCk7XG5cbi8vIHNyYy9jb3JlL21hbmFnZXIvZXZlbnRzLnRzXG52YXIgTW9uaXRvciA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5yZWdpc3RyeSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG4gIH1cbiAgLyoqXG4gICAqIEFkZHMgYW4gZXZlbnQgbGlzdGVuZXIgZm9yIHRoZSBzcGVjaWZpZWQgZXZlbnQgdHlwZS5cbiAgICpcbiAgICogQHBhcmFtIG5hbWUgLSBUaGUgbmFtZSBvZiB0aGUgZXZlbnQgdG8gbGlzdGVuIGZvclxuICAgKiBAcGFyYW0gaGFuZGxlciAtIFRoZSBmdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhlIGV2ZW50IG9jY3Vyc1xuICAgKiBAcmV0dXJucyBBIGZ1bmN0aW9uIHRvIHJlbW92ZSB0aGUgZXZlbnQgbGlzdGVuZXJcbiAgICovXG4gIGFkZEV2ZW50TGlzdGVuZXIobmFtZSwgaGFuZGxlcikge1xuICAgIGNvbnN0IHsgcmVnaXN0cnkgfSA9IHRoaXM7XG4gICAgY29uc3QgbGlzdGVuZXJzID0gbmV3IFNldChyZWdpc3RyeS5nZXQobmFtZSkpO1xuICAgIGxpc3RlbmVycy5hZGQoaGFuZGxlcik7XG4gICAgcmVnaXN0cnkuc2V0KG5hbWUsIGxpc3RlbmVycyk7XG4gICAgcmV0dXJuICgpID0+IHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcihuYW1lLCBoYW5kbGVyKTtcbiAgfVxuICAvKipcbiAgICogUmVtb3ZlcyBhbiBldmVudCBsaXN0ZW5lciBmb3IgdGhlIHNwZWNpZmllZCBldmVudCB0eXBlLlxuICAgKlxuICAgKiBAcGFyYW0gbmFtZSAtIFRoZSBuYW1lIG9mIHRoZSBldmVudFxuICAgKiBAcGFyYW0gaGFuZGxlciAtIFRoZSBmdW5jdGlvbiB0byByZW1vdmVcbiAgICovXG4gIHJlbW92ZUV2ZW50TGlzdGVuZXIobmFtZSwgaGFuZGxlcikge1xuICAgIGNvbnN0IHsgcmVnaXN0cnkgfSA9IHRoaXM7XG4gICAgY29uc3QgbGlzdGVuZXJzID0gbmV3IFNldChyZWdpc3RyeS5nZXQobmFtZSkpO1xuICAgIGxpc3RlbmVycy5kZWxldGUoaGFuZGxlcik7XG4gICAgcmVnaXN0cnkuc2V0KG5hbWUsIGxpc3RlbmVycyk7XG4gIH1cbiAgLyoqXG4gICAqIERpc3BhdGNoZXMgYW4gZXZlbnQgdG8gYWxsIHJlZ2lzdGVyZWQgbGlzdGVuZXJzLlxuICAgKlxuICAgKiBAcGFyYW0gbmFtZSAtIFRoZSBuYW1lIG9mIHRoZSBldmVudCB0byBkaXNwYXRjaFxuICAgKiBAcGFyYW0gYXJncyAtIEFyZ3VtZW50cyB0byBwYXNzIHRvIHRoZSBldmVudCBoYW5kbGVyc1xuICAgKi9cbiAgZGlzcGF0Y2gobmFtZSwgLi4uYXJncykge1xuICAgIGNvbnN0IHsgcmVnaXN0cnkgfSA9IHRoaXM7XG4gICAgY29uc3QgbGlzdGVuZXJzID0gcmVnaXN0cnkuZ2V0KG5hbWUpO1xuICAgIGlmICghbGlzdGVuZXJzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGZvciAoY29uc3QgbGlzdGVuZXIgb2YgbGlzdGVuZXJzKSB7XG4gICAgICBsaXN0ZW5lciguLi5hcmdzKTtcbiAgICB9XG4gIH1cbn07XG52YXIgRHJhZ0Ryb3BNb25pdG9yID0gY2xhc3MgZXh0ZW5kcyBNb25pdG9yIHtcbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBuZXcgZHJhZyBhbmQgZHJvcCBtb25pdG9yLlxuICAgKlxuICAgKiBAcGFyYW0gbWFuYWdlciAtIFRoZSBkcmFnIGFuZCBkcm9wIG1hbmFnZXIgdG8gbW9uaXRvclxuICAgKi9cbiAgY29uc3RydWN0b3IobWFuYWdlcikge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5tYW5hZ2VyID0gbWFuYWdlcjtcbiAgfVxuICAvKipcbiAgICogRGlzcGF0Y2hlcyBhIGRyYWcgYW5kIGRyb3AgZXZlbnQuXG4gICAqXG4gICAqIEBwYXJhbSB0eXBlIC0gVGhlIHR5cGUgb2YgZXZlbnQgdG8gZGlzcGF0Y2hcbiAgICogQHBhcmFtIGV2ZW50IC0gVGhlIGV2ZW50IGRhdGEgdG8gZGlzcGF0Y2hcbiAgICovXG4gIGRpc3BhdGNoKHR5cGUsIGV2ZW50KSB7XG4gICAgY29uc3QgYXJncyA9IFtldmVudCwgdGhpcy5tYW5hZ2VyXTtcbiAgICBzdXBlci5kaXNwYXRjaCh0eXBlLCAuLi5hcmdzKTtcbiAgfVxufTtcbmZ1bmN0aW9uIGRlZmF1bHRQcmV2ZW50YWJsZShldmVudCwgY2FuY2VsYWJsZSA9IHRydWUpIHtcbiAgbGV0IGRlZmF1bHRQcmV2ZW50ZWQgPSBmYWxzZTtcbiAgcmV0dXJuIF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIGV2ZW50KSwge1xuICAgIGNhbmNlbGFibGUsXG4gICAgZ2V0IGRlZmF1bHRQcmV2ZW50ZWQoKSB7XG4gICAgICByZXR1cm4gZGVmYXVsdFByZXZlbnRlZDtcbiAgICB9LFxuICAgIHByZXZlbnREZWZhdWx0KCkge1xuICAgICAgaWYgKCFjYW5jZWxhYmxlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGRlZmF1bHRQcmV2ZW50ZWQgPSB0cnVlO1xuICAgIH1cbiAgfSk7XG59XG5cbi8vIHNyYy9jb3JlL2NvbGxpc2lvbi9ub3RpZmllci50c1xudmFyIENvbGxpc2lvbk5vdGlmaWVyID0gY2xhc3MgZXh0ZW5kcyBDb3JlUGx1Z2luIHtcbiAgY29uc3RydWN0b3IobWFuYWdlcikge1xuICAgIHN1cGVyKG1hbmFnZXIpO1xuICAgIGNvbnN0IGlzRXF1YWwgPSAoYSwgYikgPT4gYS5tYXAoKHsgaWQgfSkgPT4gaWQpLmpvaW4oXCJcIikgPT09IGIubWFwKCh7IGlkIH0pID0+IGlkKS5qb2luKFwiXCIpO1xuICAgIGxldCBwcmV2aW91c0NvbGxpc2lvbnMgPSBbXTtcbiAgICB0aGlzLmRlc3Ryb3kgPSBlZmZlY3RzKFxuICAgICAgKCkgPT4ge1xuICAgICAgICBjb25zdCB7IGRyYWdPcGVyYXRpb24sIGNvbGxpc2lvbk9ic2VydmVyIH0gPSBtYW5hZ2VyO1xuICAgICAgICBpZiAoZHJhZ09wZXJhdGlvbi5zdGF0dXMuaW5pdGlhbGl6aW5nKSB7XG4gICAgICAgICAgcHJldmlvdXNDb2xsaXNpb25zID0gW107XG4gICAgICAgICAgY29sbGlzaW9uT2JzZXJ2ZXIuZW5hYmxlKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgY29sbGlzaW9uT2JzZXJ2ZXIsIG1vbml0b3IgfSA9IG1hbmFnZXI7XG4gICAgICAgIGNvbnN0IHsgY29sbGlzaW9ucyB9ID0gY29sbGlzaW9uT2JzZXJ2ZXI7XG4gICAgICAgIGlmIChjb2xsaXNpb25PYnNlcnZlci5pc0Rpc2FibGVkKCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZXZlbnQgPSBkZWZhdWx0UHJldmVudGFibGUoe1xuICAgICAgICAgIGNvbGxpc2lvbnNcbiAgICAgICAgfSk7XG4gICAgICAgIG1vbml0b3IuZGlzcGF0Y2goXCJjb2xsaXNpb25cIiwgZXZlbnQpO1xuICAgICAgICBpZiAoZXZlbnQuZGVmYXVsdFByZXZlbnRlZCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNFcXVhbChjb2xsaXNpb25zLCBwcmV2aW91c0NvbGxpc2lvbnMpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHByZXZpb3VzQ29sbGlzaW9ucyA9IGNvbGxpc2lvbnM7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgW2ZpcnN0Q29sbGlzaW9uXSA9IGNvbGxpc2lvbnM7XG4gICAgICAgIHVudHJhY2tlZCgoKSA9PiB7XG4gICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgIGlmICgoZmlyc3RDb2xsaXNpb24gPT0gbnVsbCA/IHZvaWQgMCA6IGZpcnN0Q29sbGlzaW9uLmlkKSAhPT0gKChfYSA9IG1hbmFnZXIuZHJhZ09wZXJhdGlvbi50YXJnZXQpID09IG51bGwgPyB2b2lkIDAgOiBfYS5pZCkpIHtcbiAgICAgICAgICAgIGNvbGxpc2lvbk9ic2VydmVyLmRpc2FibGUoKTtcbiAgICAgICAgICAgIG1hbmFnZXIuYWN0aW9ucy5zZXREcm9wVGFyZ2V0KGZpcnN0Q29sbGlzaW9uID09IG51bGwgPyB2b2lkIDAgOiBmaXJzdENvbGxpc2lvbi5pZCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgIGNvbGxpc2lvbk9ic2VydmVyLmVuYWJsZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICApO1xuICB9XG59O1xuXG4vLyBzcmMvY29yZS9jb2xsaXNpb24vdHlwZXMudHNcbnZhciBDb2xsaXNpb25Qcmlvcml0eSA9IC8qIEBfX1BVUkVfXyAqLyAoKENvbGxpc2lvblByaW9yaXR5MikgPT4ge1xuICBDb2xsaXNpb25Qcmlvcml0eTJbQ29sbGlzaW9uUHJpb3JpdHkyW1wiTG93ZXN0XCJdID0gMF0gPSBcIkxvd2VzdFwiO1xuICBDb2xsaXNpb25Qcmlvcml0eTJbQ29sbGlzaW9uUHJpb3JpdHkyW1wiTG93XCJdID0gMV0gPSBcIkxvd1wiO1xuICBDb2xsaXNpb25Qcmlvcml0eTJbQ29sbGlzaW9uUHJpb3JpdHkyW1wiTm9ybWFsXCJdID0gMl0gPSBcIk5vcm1hbFwiO1xuICBDb2xsaXNpb25Qcmlvcml0eTJbQ29sbGlzaW9uUHJpb3JpdHkyW1wiSGlnaFwiXSA9IDNdID0gXCJIaWdoXCI7XG4gIENvbGxpc2lvblByaW9yaXR5MltDb2xsaXNpb25Qcmlvcml0eTJbXCJIaWdoZXN0XCJdID0gNF0gPSBcIkhpZ2hlc3RcIjtcbiAgcmV0dXJuIENvbGxpc2lvblByaW9yaXR5Mjtcbn0pKENvbGxpc2lvblByaW9yaXR5IHx8IHt9KTtcbnZhciBDb2xsaXNpb25UeXBlID0gLyogQF9fUFVSRV9fICovICgoQ29sbGlzaW9uVHlwZTIpID0+IHtcbiAgQ29sbGlzaW9uVHlwZTJbQ29sbGlzaW9uVHlwZTJbXCJDb2xsaXNpb25cIl0gPSAwXSA9IFwiQ29sbGlzaW9uXCI7XG4gIENvbGxpc2lvblR5cGUyW0NvbGxpc2lvblR5cGUyW1wiU2hhcGVJbnRlcnNlY3Rpb25cIl0gPSAxXSA9IFwiU2hhcGVJbnRlcnNlY3Rpb25cIjtcbiAgQ29sbGlzaW9uVHlwZTJbQ29sbGlzaW9uVHlwZTJbXCJQb2ludGVySW50ZXJzZWN0aW9uXCJdID0gMl0gPSBcIlBvaW50ZXJJbnRlcnNlY3Rpb25cIjtcbiAgcmV0dXJuIENvbGxpc2lvblR5cGUyO1xufSkoQ29sbGlzaW9uVHlwZSB8fCB7fSk7XG52YXIgX2Ryb3BwZWRfZGVjLCBfZHJhZ2dpbmdfZGVjLCBfaW5pdGlhbGl6ZWRfZGVjLCBfaW5pdGlhbGl6aW5nX2RlYywgX2lkbGVfZGVjLCBfY3VycmVudF9kZWMsIF92YWx1ZV9kZWMsIF9pbml0MiwgX3ZhbHVlO1xuX3ZhbHVlX2RlYyA9IFtyZWFjdGl2ZV0sIF9jdXJyZW50X2RlYyA9IFtkZXJpdmVkXSwgX2lkbGVfZGVjID0gW2Rlcml2ZWRdLCBfaW5pdGlhbGl6aW5nX2RlYyA9IFtkZXJpdmVkXSwgX2luaXRpYWxpemVkX2RlYyA9IFtkZXJpdmVkXSwgX2RyYWdnaW5nX2RlYyA9IFtkZXJpdmVkXSwgX2Ryb3BwZWRfZGVjID0gW2Rlcml2ZWRdO1xudmFyIFN0YXR1cyA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgX19ydW5Jbml0aWFsaXplcnMoX2luaXQyLCA1LCB0aGlzKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3ZhbHVlLCBfX3J1bkluaXRpYWxpemVycyhfaW5pdDIsIDgsIHRoaXMsIFwiaWRsZVwiIC8qIElkbGUgKi8pKSwgX19ydW5Jbml0aWFsaXplcnMoX2luaXQyLCAxMSwgdGhpcyk7XG4gIH1cbiAgZ2V0IGN1cnJlbnQoKSB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gIH1cbiAgZ2V0IGlkbGUoKSB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWUgPT09IFwiaWRsZVwiIC8qIElkbGUgKi87XG4gIH1cbiAgZ2V0IGluaXRpYWxpemluZygpIHtcbiAgICByZXR1cm4gdGhpcy52YWx1ZSA9PT0gXCJpbml0aWFsaXppbmdcIiAvKiBJbml0aWFsaXppbmcgKi87XG4gIH1cbiAgZ2V0IGluaXRpYWxpemVkKCkge1xuICAgIGNvbnN0IHsgdmFsdWUgfSA9IHRoaXM7XG4gICAgcmV0dXJuIHZhbHVlICE9PSBcImlkbGVcIiAvKiBJZGxlICovICYmIHZhbHVlICE9PSBcImluaXRpYWxpemF0aW9uLXBlbmRpbmdcIiAvKiBJbml0aWFsaXphdGlvblBlbmRpbmcgKi87XG4gIH1cbiAgZ2V0IGRyYWdnaW5nKCkge1xuICAgIHJldHVybiB0aGlzLnZhbHVlID09PSBcImRyYWdnaW5nXCIgLyogRHJhZ2dpbmcgKi87XG4gIH1cbiAgZ2V0IGRyb3BwZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWUgPT09IFwiZHJvcHBlZFwiIC8qIERyb3BwZWQgKi87XG4gIH1cbiAgLyoqXG4gICAqIFNldHMgdGhlIGN1cnJlbnQgc3RhdHVzIHZhbHVlLlxuICAgKlxuICAgKiBAcGFyYW0gdmFsdWUgLSBUaGUgbmV3IHN0YXR1cyB2YWx1ZVxuICAgKi9cbiAgc2V0KHZhbHVlKSB7XG4gICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICB9XG59O1xuX2luaXQyID0gX19kZWNvcmF0b3JTdGFydChudWxsKTtcbl92YWx1ZSA9IG5ldyBXZWFrTWFwKCk7XG5fX2RlY29yYXRlRWxlbWVudChfaW5pdDIsIDQsIFwidmFsdWVcIiwgX3ZhbHVlX2RlYywgU3RhdHVzLCBfdmFsdWUpO1xuX19kZWNvcmF0ZUVsZW1lbnQoX2luaXQyLCAyLCBcImN1cnJlbnRcIiwgX2N1cnJlbnRfZGVjLCBTdGF0dXMpO1xuX19kZWNvcmF0ZUVsZW1lbnQoX2luaXQyLCAyLCBcImlkbGVcIiwgX2lkbGVfZGVjLCBTdGF0dXMpO1xuX19kZWNvcmF0ZUVsZW1lbnQoX2luaXQyLCAyLCBcImluaXRpYWxpemluZ1wiLCBfaW5pdGlhbGl6aW5nX2RlYywgU3RhdHVzKTtcbl9fZGVjb3JhdGVFbGVtZW50KF9pbml0MiwgMiwgXCJpbml0aWFsaXplZFwiLCBfaW5pdGlhbGl6ZWRfZGVjLCBTdGF0dXMpO1xuX19kZWNvcmF0ZUVsZW1lbnQoX2luaXQyLCAyLCBcImRyYWdnaW5nXCIsIF9kcmFnZ2luZ19kZWMsIFN0YXR1cyk7XG5fX2RlY29yYXRlRWxlbWVudChfaW5pdDIsIDIsIFwiZHJvcHBlZFwiLCBfZHJvcHBlZF9kZWMsIFN0YXR1cyk7XG5fX2RlY29yYXRvck1ldGFkYXRhKF9pbml0MiwgU3RhdHVzKTtcblxuLy8gc3JjL2NvcmUvbWFuYWdlci9hY3Rpb25zLnRzXG52YXIgRHJhZ0FjdGlvbnMgPSBjbGFzcyB7XG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgbmV3IGluc3RhbmNlIG9mIGRyYWcgYWN0aW9ucy5cbiAgICpcbiAgICogQHBhcmFtIG1hbmFnZXIgLSBUaGUgZHJhZyBhbmQgZHJvcCBtYW5hZ2VyIGluc3RhbmNlXG4gICAqL1xuICBjb25zdHJ1Y3RvcihtYW5hZ2VyKSB7XG4gICAgdGhpcy5tYW5hZ2VyID0gbWFuYWdlcjtcbiAgfVxuICAvKipcbiAgICogU2V0cyB0aGUgc291cmNlIG9mIHRoZSBkcmFnIG9wZXJhdGlvbi5cbiAgICpcbiAgICogQHBhcmFtIHNvdXJjZSAtIFRoZSBkcmFnZ2FibGUgZW50aXR5IG9yIGl0cyB1bmlxdWUgaWRlbnRpZmllclxuICAgKi9cbiAgc2V0RHJhZ1NvdXJjZShzb3VyY2UpIHtcbiAgICBjb25zdCB7IGRyYWdPcGVyYXRpb24gfSA9IHRoaXMubWFuYWdlcjtcbiAgICBkcmFnT3BlcmF0aW9uLnNvdXJjZUlkZW50aWZpZXIgPSB0eXBlb2Ygc291cmNlID09PSBcInN0cmluZ1wiIHx8IHR5cGVvZiBzb3VyY2UgPT09IFwibnVtYmVyXCIgPyBzb3VyY2UgOiBzb3VyY2UuaWQ7XG4gIH1cbiAgLyoqXG4gICAqIFNldHMgdGhlIHRhcmdldCBvZiB0aGUgZHJvcCBvcGVyYXRpb24uXG4gICAqXG4gICAqIEBwYXJhbSBpZGVudGlmaWVyIC0gVGhlIHVuaXF1ZSBpZGVudGlmaWVyIG9mIHRoZSBkcm9wcGFibGUgZW50aXR5IG9yIG51bGwvdW5kZWZpbmVkXG4gICAqIEByZXR1cm5zIEEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRydWUgaWYgdGhlIGRyb3Agd2FzIHByZXZlbnRlZFxuICAgKi9cbiAgc2V0RHJvcFRhcmdldChpZGVudGlmaWVyKSB7XG4gICAgcmV0dXJuIHVudHJhY2tlZCgoKSA9PiB7XG4gICAgICBjb25zdCB7IGRyYWdPcGVyYXRpb24gfSA9IHRoaXMubWFuYWdlcjtcbiAgICAgIGNvbnN0IGlkID0gaWRlbnRpZmllciAhPSBudWxsID8gaWRlbnRpZmllciA6IG51bGw7XG4gICAgICBpZiAoZHJhZ09wZXJhdGlvbi50YXJnZXRJZGVudGlmaWVyID09PSBpZCkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKTtcbiAgICAgIH1cbiAgICAgIGRyYWdPcGVyYXRpb24udGFyZ2V0SWRlbnRpZmllciA9IGlkO1xuICAgICAgY29uc3QgZXZlbnQgPSBkZWZhdWx0UHJldmVudGFibGUoe1xuICAgICAgICBvcGVyYXRpb246IGRyYWdPcGVyYXRpb24uc25hcHNob3QoKVxuICAgICAgfSk7XG4gICAgICBpZiAoZHJhZ09wZXJhdGlvbi5zdGF0dXMuZHJhZ2dpbmcpIHtcbiAgICAgICAgdGhpcy5tYW5hZ2VyLm1vbml0b3IuZGlzcGF0Y2goXCJkcmFnb3ZlclwiLCBldmVudCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5tYW5hZ2VyLnJlbmRlcmVyLnJlbmRlcmluZy50aGVuKCgpID0+IGV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQpO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBTdGFydHMgYSBuZXcgZHJhZyBvcGVyYXRpb24uXG4gICAqXG4gICAqIEBwYXJhbSBhcmdzIC0gQ29uZmlndXJhdGlvbiBmb3IgdGhlIGRyYWcgb3BlcmF0aW9uXG4gICAqIEBwYXJhbSBhcmdzLmV2ZW50IC0gVGhlIGV2ZW50IHRoYXQgaW5pdGlhdGVkIHRoZSBkcmFnXG4gICAqIEBwYXJhbSBhcmdzLnNvdXJjZSAtIFRoZSBzb3VyY2UgZHJhZ2dhYmxlIGVudGl0eSBvciBpdHMgaWRlbnRpZmllclxuICAgKiBAcGFyYW0gYXJncy5jb29yZGluYXRlcyAtIFRoZSBpbml0aWFsIGNvb3JkaW5hdGVzIG9mIHRoZSBkcmFnXG4gICAqIEByZXR1cm5zIHRydWUgaWYgdGhlIGRyYWcgb3BlcmF0aW9uIHN0YXJ0ZWQgc3VjY2Vzc2Z1bGx5XG4gICAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGVyZSBpcyBubyBkcmFnIHNvdXJjZSBvciBhbm90aGVyIG9wZXJhdGlvbiBpcyBhY3RpdmVcbiAgICovXG4gIHN0YXJ0KGFyZ3MpIHtcbiAgICByZXR1cm4gdW50cmFja2VkKCgpID0+IHtcbiAgICAgIGNvbnN0IHsgZHJhZ09wZXJhdGlvbiB9ID0gdGhpcy5tYW5hZ2VyO1xuICAgICAgaWYgKGFyZ3Muc291cmNlICE9IG51bGwpIHtcbiAgICAgICAgdGhpcy5zZXREcmFnU291cmNlKGFyZ3Muc291cmNlKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHNvdXJjZUluc3RhbmNlID0gZHJhZ09wZXJhdGlvbi5zb3VyY2U7XG4gICAgICBpZiAoIXNvdXJjZUluc3RhbmNlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBzdGFydCBhIGRyYWcgb3BlcmF0aW9uIHdpdGhvdXQgYSBkcmFnIHNvdXJjZVwiKTtcbiAgICAgIH1cbiAgICAgIGlmICghZHJhZ09wZXJhdGlvbi5zdGF0dXMuaWRsZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgXCJDYW5ub3Qgc3RhcnQgYSBkcmFnIG9wZXJhdGlvbiB3aGlsZSBhbm90aGVyIGlzIGFjdGl2ZVwiXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBjb25zdCBjb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICAgICAgY29uc3QgeyBldmVudDogbmF0aXZlRXZlbnQsIGNvb3JkaW5hdGVzIH0gPSBhcmdzO1xuICAgICAgYmF0Y2goKCkgPT4ge1xuICAgICAgICBkcmFnT3BlcmF0aW9uLnN0YXR1cy5zZXQoXCJpbml0aWFsaXphdGlvbi1wZW5kaW5nXCIgLyogSW5pdGlhbGl6YXRpb25QZW5kaW5nICovKTtcbiAgICAgICAgZHJhZ09wZXJhdGlvbi5zaGFwZSA9IG51bGw7XG4gICAgICAgIGRyYWdPcGVyYXRpb24uY2FuY2VsZWQgPSBmYWxzZTtcbiAgICAgICAgZHJhZ09wZXJhdGlvbi5hY3RpdmF0b3JFdmVudCA9IG5hdGl2ZUV2ZW50ICE9IG51bGwgPyBuYXRpdmVFdmVudCA6IG51bGw7XG4gICAgICAgIGRyYWdPcGVyYXRpb24ucG9zaXRpb24ucmVzZXQoY29vcmRpbmF0ZXMpO1xuICAgICAgfSk7XG4gICAgICBjb25zdCBiZWZvcmVTdGFydEV2ZW50ID0gZGVmYXVsdFByZXZlbnRhYmxlKHtcbiAgICAgICAgb3BlcmF0aW9uOiBkcmFnT3BlcmF0aW9uLnNuYXBzaG90KClcbiAgICAgIH0pO1xuICAgICAgdGhpcy5tYW5hZ2VyLm1vbml0b3IuZGlzcGF0Y2goXCJiZWZvcmVkcmFnc3RhcnRcIiwgYmVmb3JlU3RhcnRFdmVudCk7XG4gICAgICBpZiAoYmVmb3JlU3RhcnRFdmVudC5kZWZhdWx0UHJldmVudGVkKSB7XG4gICAgICAgIGRyYWdPcGVyYXRpb24ucmVzZXQoKTtcbiAgICAgICAgY29udHJvbGxlci5hYm9ydCgpO1xuICAgICAgICByZXR1cm4gY29udHJvbGxlcjtcbiAgICAgIH1cbiAgICAgIGRyYWdPcGVyYXRpb24uc3RhdHVzLnNldChcImluaXRpYWxpemluZ1wiIC8qIEluaXRpYWxpemluZyAqLyk7XG4gICAgICBkcmFnT3BlcmF0aW9uLmNvbnRyb2xsZXIgPSBjb250cm9sbGVyO1xuICAgICAgdGhpcy5tYW5hZ2VyLnJlbmRlcmVyLnJlbmRlcmluZy50aGVuKCgpID0+IHtcbiAgICAgICAgaWYgKGNvbnRyb2xsZXIuc2lnbmFsLmFib3J0ZWQpIHJldHVybjtcbiAgICAgICAgY29uc3QgeyBzdGF0dXMgfSA9IGRyYWdPcGVyYXRpb247XG4gICAgICAgIGlmIChzdGF0dXMuY3VycmVudCAhPT0gXCJpbml0aWFsaXppbmdcIiAvKiBJbml0aWFsaXppbmcgKi8pIHJldHVybjtcbiAgICAgICAgZHJhZ09wZXJhdGlvbi5zdGF0dXMuc2V0KFwiZHJhZ2dpbmdcIiAvKiBEcmFnZ2luZyAqLyk7XG4gICAgICAgIHRoaXMubWFuYWdlci5tb25pdG9yLmRpc3BhdGNoKFwiZHJhZ3N0YXJ0XCIsIHtcbiAgICAgICAgICBuYXRpdmVFdmVudCxcbiAgICAgICAgICBvcGVyYXRpb246IGRyYWdPcGVyYXRpb24uc25hcHNob3QoKSxcbiAgICAgICAgICBjYW5jZWxhYmxlOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGNvbnRyb2xsZXI7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIE1vdmVzIHRoZSBkcmFnZ2VkIGVudGl0eSB0byBhIG5ldyBwb3NpdGlvbi5cbiAgICpcbiAgICogQHBhcmFtIGFyZ3MgLSBDb25maWd1cmF0aW9uIGZvciB0aGUgbW92ZSBvcGVyYXRpb25cbiAgICogQHBhcmFtIGFyZ3MuYnkgLSBSZWxhdGl2ZSBjb29yZGluYXRlcyB0byBtb3ZlIGJ5XG4gICAqIEBwYXJhbSBhcmdzLnRvIC0gQWJzb2x1dGUgY29vcmRpbmF0ZXMgdG8gbW92ZSB0b1xuICAgKiBAcGFyYW0gYXJncy5ldmVudCAtIFRoZSBldmVudCB0aGF0IHRyaWdnZXJlZCB0aGUgbW92ZVxuICAgKiBAcGFyYW0gYXJncy5jYW5jZWxhYmxlIC0gV2hldGhlciB0aGUgbW92ZSBjYW4gYmUgY2FuY2VsZWRcbiAgICogQHBhcmFtIGFyZ3MucHJvcGFnYXRlIC0gV2hldGhlciB0byBkaXNwYXRjaCBkcmFnbW92ZSBldmVudHNcbiAgICovXG4gIG1vdmUoYXJncykge1xuICAgIHJldHVybiB1bnRyYWNrZWQoKCkgPT4ge1xuICAgICAgdmFyIF9hLCBfYjtcbiAgICAgIGNvbnN0IHsgZHJhZ09wZXJhdGlvbiB9ID0gdGhpcy5tYW5hZ2VyO1xuICAgICAgY29uc3QgeyBzdGF0dXMsIGNvbnRyb2xsZXIgfSA9IGRyYWdPcGVyYXRpb247XG4gICAgICBpZiAoIXN0YXR1cy5kcmFnZ2luZyB8fCAhY29udHJvbGxlciB8fCBjb250cm9sbGVyLnNpZ25hbC5hYm9ydGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGV2ZW50ID0gZGVmYXVsdFByZXZlbnRhYmxlKFxuICAgICAgICB7XG4gICAgICAgICAgbmF0aXZlRXZlbnQ6IGFyZ3MuZXZlbnQsXG4gICAgICAgICAgb3BlcmF0aW9uOiBkcmFnT3BlcmF0aW9uLnNuYXBzaG90KCksXG4gICAgICAgICAgYnk6IGFyZ3MuYnksXG4gICAgICAgICAgdG86IGFyZ3MudG9cbiAgICAgICAgfSxcbiAgICAgICAgKF9hID0gYXJncy5jYW5jZWxhYmxlKSAhPSBudWxsID8gX2EgOiB0cnVlXG4gICAgICApO1xuICAgICAgaWYgKChfYiA9IGFyZ3MucHJvcGFnYXRlKSAhPSBudWxsID8gX2IgOiB0cnVlKSB7XG4gICAgICAgIHRoaXMubWFuYWdlci5tb25pdG9yLmRpc3BhdGNoKFwiZHJhZ21vdmVcIiwgZXZlbnQpO1xuICAgICAgfVxuICAgICAgcXVldWVNaWNyb3Rhc2soKCkgPT4ge1xuICAgICAgICB2YXIgX2EyLCBfYjIsIF9jMywgX2QsIF9lO1xuICAgICAgICBpZiAoZXZlbnQuZGVmYXVsdFByZXZlbnRlZCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjb29yZGluYXRlcyA9IChfZSA9IGFyZ3MudG8pICE9IG51bGwgPyBfZSA6IHtcbiAgICAgICAgICB4OiBkcmFnT3BlcmF0aW9uLnBvc2l0aW9uLmN1cnJlbnQueCArICgoX2IyID0gKF9hMiA9IGFyZ3MuYnkpID09IG51bGwgPyB2b2lkIDAgOiBfYTIueCkgIT0gbnVsbCA/IF9iMiA6IDApLFxuICAgICAgICAgIHk6IGRyYWdPcGVyYXRpb24ucG9zaXRpb24uY3VycmVudC55ICsgKChfZCA9IChfYzMgPSBhcmdzLmJ5KSA9PSBudWxsID8gdm9pZCAwIDogX2MzLnkpICE9IG51bGwgPyBfZCA6IDApXG4gICAgICAgIH07XG4gICAgICAgIGRyYWdPcGVyYXRpb24ucG9zaXRpb24uY3VycmVudCA9IGNvb3JkaW5hdGVzO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIFN0b3BzIHRoZSBjdXJyZW50IGRyYWcgb3BlcmF0aW9uLlxuICAgKlxuICAgKiBAcGFyYW0gYXJncyAtIENvbmZpZ3VyYXRpb24gZm9yIHN0b3BwaW5nIHRoZSBvcGVyYXRpb25cbiAgICogQHBhcmFtIGFyZ3MuZXZlbnQgLSBUaGUgZXZlbnQgdGhhdCB0cmlnZ2VyZWQgdGhlIHN0b3BcbiAgICogQHBhcmFtIGFyZ3MuY2FuY2VsZWQgLSBXaGV0aGVyIHRoZSBvcGVyYXRpb24gd2FzIGNhbmNlbGVkXG4gICAqIEByZW1hcmtzXG4gICAqIFRoaXMgbWV0aG9kOlxuICAgKiAtIERpc3BhdGNoZXMgYSBkcmFnZW5kIGV2ZW50XG4gICAqIC0gQWxsb3dzIHN1c3BlbnNpb24gb2YgdGhlIG9wZXJhdGlvblxuICAgKiAtIEhhbmRsZXMgY2xlYW51cCBvZiB0aGUgb3BlcmF0aW9uIHN0YXRlXG4gICAqL1xuICBzdG9wKGFyZ3MgPSB7fSkge1xuICAgIHJldHVybiB1bnRyYWNrZWQoKCkgPT4ge1xuICAgICAgdmFyIF9hLCBfYjtcbiAgICAgIGNvbnN0IHsgZHJhZ09wZXJhdGlvbiB9ID0gdGhpcy5tYW5hZ2VyO1xuICAgICAgY29uc3QgeyBjb250cm9sbGVyIH0gPSBkcmFnT3BlcmF0aW9uO1xuICAgICAgaWYgKCFjb250cm9sbGVyIHx8IGNvbnRyb2xsZXIuc2lnbmFsLmFib3J0ZWQpIHJldHVybjtcbiAgICAgIGxldCBwcm9taXNlO1xuICAgICAgY29uc3Qgc3VzcGVuZCA9ICgpID0+IHtcbiAgICAgICAgY29uc3Qgb3V0cHV0ID0ge1xuICAgICAgICAgIHJlc3VtZTogKCkgPT4ge1xuICAgICAgICAgIH0sXG4gICAgICAgICAgYWJvcnQ6ICgpID0+IHtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgb3V0cHV0LnJlc3VtZSA9IHJlc29sdmU7XG4gICAgICAgICAgb3V0cHV0LmFib3J0ID0gcmVqZWN0O1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgIH07XG4gICAgICBjb250cm9sbGVyLmFib3J0KCk7XG4gICAgICBjb25zdCBlbmQgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMubWFuYWdlci5yZW5kZXJlci5yZW5kZXJpbmcudGhlbigoKSA9PiB7XG4gICAgICAgICAgZHJhZ09wZXJhdGlvbi5zdGF0dXMuc2V0KFwiZHJvcHBlZFwiIC8qIERyb3BwZWQgKi8pO1xuICAgICAgICAgIGNvbnN0IGRyb3BwaW5nID0gdW50cmFja2VkKFxuICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICB2YXIgX2EyO1xuICAgICAgICAgICAgICByZXR1cm4gKChfYTIgPSBkcmFnT3BlcmF0aW9uLnNvdXJjZSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMi5zdGF0dXMpID09PSBcImRyb3BwaW5nXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgKTtcbiAgICAgICAgICBjb25zdCBjbGVhbnVwID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKGRyYWdPcGVyYXRpb24uY29udHJvbGxlciA9PT0gY29udHJvbGxlcikge1xuICAgICAgICAgICAgICBkcmFnT3BlcmF0aW9uLmNvbnRyb2xsZXIgPSB2b2lkIDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkcmFnT3BlcmF0aW9uLnJlc2V0KCk7XG4gICAgICAgICAgfTtcbiAgICAgICAgICBpZiAoZHJvcHBpbmcpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgc291cmNlIH0gPSBkcmFnT3BlcmF0aW9uO1xuICAgICAgICAgICAgY29uc3QgZGlzcG9zZSA9IGVmZmVjdCgoKSA9PiB7XG4gICAgICAgICAgICAgIGlmICgoc291cmNlID09IG51bGwgPyB2b2lkIDAgOiBzb3VyY2Uuc3RhdHVzKSA9PT0gXCJpZGxlXCIpIHtcbiAgICAgICAgICAgICAgICBkaXNwb3NlKCk7XG4gICAgICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tYW5hZ2VyLnJlbmRlcmVyLnJlbmRlcmluZy50aGVuKGNsZWFudXApO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgICAgZHJhZ09wZXJhdGlvbi5jYW5jZWxlZCA9IChfYSA9IGFyZ3MuY2FuY2VsZWQpICE9IG51bGwgPyBfYSA6IGZhbHNlO1xuICAgICAgdGhpcy5tYW5hZ2VyLm1vbml0b3IuZGlzcGF0Y2goXCJkcmFnZW5kXCIsIHtcbiAgICAgICAgbmF0aXZlRXZlbnQ6IGFyZ3MuZXZlbnQsXG4gICAgICAgIG9wZXJhdGlvbjogZHJhZ09wZXJhdGlvbi5zbmFwc2hvdCgpLFxuICAgICAgICBjYW5jZWxlZDogKF9iID0gYXJncy5jYW5jZWxlZCkgIT0gbnVsbCA/IF9iIDogZmFsc2UsXG4gICAgICAgIHN1c3BlbmRcbiAgICAgIH0pO1xuICAgICAgaWYgKHByb21pc2UpIHtcbiAgICAgICAgcHJvbWlzZS50aGVuKGVuZCkuY2F0Y2goKCkgPT4gZHJhZ09wZXJhdGlvbi5yZXNldCgpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVuZCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59O1xudmFyIF9kaXNhYmxlZF9kZWMyLCBfZGF0YV9kZWMsIF9pZF9kZWMsIF9tYW5hZ2VyX2RlYywgX2luaXQzLCBfbWFuYWdlciwgX2lkLCBfZGF0YSwgX2Rpc2FibGVkMjtcbl9tYW5hZ2VyX2RlYyA9IFtyZWFjdGl2ZV0sIF9pZF9kZWMgPSBbcmVhY3RpdmVdLCBfZGF0YV9kZWMgPSBbcmVhY3RpdmVdLCBfZGlzYWJsZWRfZGVjMiA9IFtyZWFjdGl2ZV07XG52YXIgRW50aXR5ID0gY2xhc3Mge1xuICAvKipcbiAgICogQ3JlYXRlcyBhIG5ldyBpbnN0YW5jZSBvZiB0aGUgYEVudGl0eWAgY2xhc3MuXG4gICAqXG4gICAqIEBwYXJhbSBpbnB1dCAtIEFuIG9iamVjdCBjb250YWluaW5nIHRoZSBpbml0aWFsIHByb3BlcnRpZXMgb2YgdGhlIGVudGl0eS5cbiAgICogQHBhcmFtIG1hbmFnZXIgLSBUaGUgbWFuYWdlciB0aGF0IGNvbnRyb2xzIHRoZSBkcmFnIGFuZCBkcm9wIG9wZXJhdGlvbnMuXG4gICAqL1xuICBjb25zdHJ1Y3RvcihpbnB1dCwgbWFuYWdlcikge1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfbWFuYWdlciwgX19ydW5Jbml0aWFsaXplcnMoX2luaXQzLCA4LCB0aGlzKSksIF9fcnVuSW5pdGlhbGl6ZXJzKF9pbml0MywgMTEsIHRoaXMpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfaWQsIF9fcnVuSW5pdGlhbGl6ZXJzKF9pbml0MywgMTIsIHRoaXMpKSwgX19ydW5Jbml0aWFsaXplcnMoX2luaXQzLCAxNSwgdGhpcyk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9kYXRhLCBfX3J1bkluaXRpYWxpemVycyhfaW5pdDMsIDE2LCB0aGlzKSksIF9fcnVuSW5pdGlhbGl6ZXJzKF9pbml0MywgMTksIHRoaXMpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfZGlzYWJsZWQyLCBfX3J1bkluaXRpYWxpemVycyhfaW5pdDMsIDIwLCB0aGlzKSksIF9fcnVuSW5pdGlhbGl6ZXJzKF9pbml0MywgMjMsIHRoaXMpO1xuICAgIGNvbnN0IHsgZWZmZWN0czogZWZmZWN0czYsIGlkLCBkYXRhID0ge30sIGRpc2FibGVkID0gZmFsc2UsIHJlZ2lzdGVyID0gdHJ1ZSB9ID0gaW5wdXQ7XG4gICAgbGV0IHByZXZpb3VzSWQgPSBpZDtcbiAgICB0aGlzLm1hbmFnZXIgPSBtYW5hZ2VyO1xuICAgIHRoaXMuaWQgPSBpZDtcbiAgICB0aGlzLmRhdGEgPSBkYXRhO1xuICAgIHRoaXMuZGlzYWJsZWQgPSBkaXNhYmxlZDtcbiAgICB0aGlzLmVmZmVjdHMgPSAoKSA9PiB7XG4gICAgICB2YXIgX2E7XG4gICAgICByZXR1cm4gW1xuICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgY29uc3QgeyBpZDogaWQyLCBtYW5hZ2VyOiBtYW5hZ2VyMiB9ID0gdGhpcztcbiAgICAgICAgICBpZiAoaWQyID09PSBwcmV2aW91c0lkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIG1hbmFnZXIyID09IG51bGwgPyB2b2lkIDAgOiBtYW5hZ2VyMi5yZWdpc3RyeS5yZWdpc3Rlcih0aGlzKTtcbiAgICAgICAgICByZXR1cm4gKCkgPT4gbWFuYWdlcjIgPT0gbnVsbCA/IHZvaWQgMCA6IG1hbmFnZXIyLnJlZ2lzdHJ5LnVucmVnaXN0ZXIodGhpcyk7XG4gICAgICAgIH0sXG4gICAgICAgIC4uLihfYSA9IGVmZmVjdHM2ID09IG51bGwgPyB2b2lkIDAgOiBlZmZlY3RzNigpKSAhPSBudWxsID8gX2EgOiBbXVxuICAgICAgXTtcbiAgICB9O1xuICAgIHRoaXMucmVnaXN0ZXIgPSB0aGlzLnJlZ2lzdGVyLmJpbmQodGhpcyk7XG4gICAgdGhpcy51bnJlZ2lzdGVyID0gdGhpcy51bnJlZ2lzdGVyLmJpbmQodGhpcyk7XG4gICAgdGhpcy5kZXN0cm95ID0gdGhpcy5kZXN0cm95LmJpbmQodGhpcyk7XG4gICAgaWYgKG1hbmFnZXIgJiYgcmVnaXN0ZXIpIHtcbiAgICAgIHF1ZXVlTWljcm90YXNrKHRoaXMucmVnaXN0ZXIpO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICogQSBtZXRob2QgdGhhdCByZWdpc3RlcnMgdGhlIGVudGl0eSB3aXRoIHRoZSBtYW5hZ2VyLlxuICAgKiBAcmV0dXJucyBDbGVhbnVwRnVuY3Rpb24gfCB2b2lkXG4gICAqL1xuICByZWdpc3RlcigpIHtcbiAgICB2YXIgX2E7XG4gICAgcmV0dXJuIChfYSA9IHRoaXMubWFuYWdlcikgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLnJlZ2lzdHJ5LnJlZ2lzdGVyKHRoaXMpO1xuICB9XG4gIC8qKlxuICAgKiBBIG1ldGhvZCB0aGF0IHVucmVnaXN0ZXJzIHRoZSBlbnRpdHkgZnJvbSB0aGUgbWFuYWdlci5cbiAgICogQHJldHVybnMgdm9pZFxuICAgKi9cbiAgdW5yZWdpc3RlcigpIHtcbiAgICB2YXIgX2E7XG4gICAgKF9hID0gdGhpcy5tYW5hZ2VyKSA9PSBudWxsID8gdm9pZCAwIDogX2EucmVnaXN0cnkudW5yZWdpc3Rlcih0aGlzKTtcbiAgfVxuICAvKipcbiAgICogQSBtZXRob2QgdGhhdCBjbGVhbnMgdXAgdGhlIGVudGl0eSB3aGVuIGl0IGlzIG5vIGxvbmdlciBuZWVkZWQuXG4gICAqIEByZXR1cm5zIHZvaWRcbiAgICovXG4gIGRlc3Ryb3koKSB7XG4gICAgdmFyIF9hO1xuICAgIChfYSA9IHRoaXMubWFuYWdlcikgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLnJlZ2lzdHJ5LnVucmVnaXN0ZXIodGhpcyk7XG4gIH1cbn07XG5faW5pdDMgPSBfX2RlY29yYXRvclN0YXJ0KG51bGwpO1xuX21hbmFnZXIgPSBuZXcgV2Vha01hcCgpO1xuX2lkID0gbmV3IFdlYWtNYXAoKTtcbl9kYXRhID0gbmV3IFdlYWtNYXAoKTtcbl9kaXNhYmxlZDIgPSBuZXcgV2Vha01hcCgpO1xuX19kZWNvcmF0ZUVsZW1lbnQoX2luaXQzLCA0LCBcIm1hbmFnZXJcIiwgX21hbmFnZXJfZGVjLCBFbnRpdHksIF9tYW5hZ2VyKTtcbl9fZGVjb3JhdGVFbGVtZW50KF9pbml0MywgNCwgXCJpZFwiLCBfaWRfZGVjLCBFbnRpdHksIF9pZCk7XG5fX2RlY29yYXRlRWxlbWVudChfaW5pdDMsIDQsIFwiZGF0YVwiLCBfZGF0YV9kZWMsIEVudGl0eSwgX2RhdGEpO1xuX19kZWNvcmF0ZUVsZW1lbnQoX2luaXQzLCA0LCBcImRpc2FibGVkXCIsIF9kaXNhYmxlZF9kZWMyLCBFbnRpdHksIF9kaXNhYmxlZDIpO1xuX19kZWNvcmF0b3JNZXRhZGF0YShfaW5pdDMsIEVudGl0eSk7XG52YXIgRW50aXR5UmVnaXN0cnkgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMubWFwID0gc2lnbmFsKC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCkpO1xuICAgIHRoaXMuY2xlYW51cEZ1bmN0aW9ucyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpO1xuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVycyBhIGVudGl0eSBpbiB0aGUgcmVnaXN0cnkuXG4gICAgICogQHBhcmFtIGtleSAtIFRoZSB1bmlxdWUgaWRlbnRpZmllciBvZiB0aGUgZW50aXR5LlxuICAgICAqIEBwYXJhbSB2YWx1ZSAtIFRoZSBlbnRpdHkgdG8gcmVnaXN0ZXIuXG4gICAgICogQHJldHVybnMgQSBmdW5jdGlvbiB0aGF0IHVucmVnaXN0ZXJzIHRoZSBlbnRpdHkuXG4gICAgICovXG4gICAgdGhpcy5yZWdpc3RlciA9IChrZXksIHZhbHVlKSA9PiB7XG4gICAgICBjb25zdCBjdXJyZW50ID0gdGhpcy5tYXAucGVlaygpO1xuICAgICAgY29uc3QgY3VycmVudFZhbHVlID0gY3VycmVudC5nZXQoa2V5KTtcbiAgICAgIGNvbnN0IHVucmVnaXN0ZXIgPSAoKSA9PiB0aGlzLnVucmVnaXN0ZXIoa2V5LCB2YWx1ZSk7XG4gICAgICBpZiAoY3VycmVudFZhbHVlID09PSB2YWx1ZSkgcmV0dXJuIHVucmVnaXN0ZXI7XG4gICAgICBpZiAoY3VycmVudFZhbHVlKSB7XG4gICAgICAgIGNvbnN0IGNsZWFudXAyID0gdGhpcy5jbGVhbnVwRnVuY3Rpb25zLmdldChjdXJyZW50VmFsdWUpO1xuICAgICAgICBjbGVhbnVwMiA9PSBudWxsID8gdm9pZCAwIDogY2xlYW51cDIoKTtcbiAgICAgICAgdGhpcy5jbGVhbnVwRnVuY3Rpb25zLmRlbGV0ZShjdXJyZW50VmFsdWUpO1xuICAgICAgfVxuICAgICAgY29uc3QgdXBkYXRlZE1hcCA9IG5ldyBNYXAoY3VycmVudCk7XG4gICAgICB1cGRhdGVkTWFwLnNldChrZXksIHZhbHVlKTtcbiAgICAgIHRoaXMubWFwLnZhbHVlID0gdXBkYXRlZE1hcDtcbiAgICAgIGNvbnN0IGNsZWFudXAgPSBlZmZlY3RzKC4uLnZhbHVlLmVmZmVjdHMoKSk7XG4gICAgICB0aGlzLmNsZWFudXBGdW5jdGlvbnMuc2V0KHZhbHVlLCBjbGVhbnVwKTtcbiAgICAgIHJldHVybiB1bnJlZ2lzdGVyO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVW5yZWdpc3RlcnMgYW4gZW50aXR5IGZyb20gdGhlIHJlZ2lzdHJ5LlxuICAgICAqIEBwYXJhbSBrZXkgLSBUaGUgdW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIGVudGl0eS5cbiAgICAgKiBAcGFyYW0gdmFsdWUgLSBUaGUgZW50aXR5IGluc3RhbmNlIHRvIHVucmVnaXN0ZXIuXG4gICAgICovXG4gICAgdGhpcy51bnJlZ2lzdGVyID0gKGtleSwgdmFsdWUpID0+IHtcbiAgICAgIGNvbnN0IGN1cnJlbnQgPSB0aGlzLm1hcC5wZWVrKCk7XG4gICAgICBpZiAoY3VycmVudC5nZXQoa2V5KSAhPT0gdmFsdWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3QgY2xlYW51cCA9IHRoaXMuY2xlYW51cEZ1bmN0aW9ucy5nZXQodmFsdWUpO1xuICAgICAgY2xlYW51cCA9PSBudWxsID8gdm9pZCAwIDogY2xlYW51cCgpO1xuICAgICAgdGhpcy5jbGVhbnVwRnVuY3Rpb25zLmRlbGV0ZSh2YWx1ZSk7XG4gICAgICBjb25zdCB1cGRhdGVkTWFwID0gbmV3IE1hcChjdXJyZW50KTtcbiAgICAgIHVwZGF0ZWRNYXAuZGVsZXRlKGtleSk7XG4gICAgICB0aGlzLm1hcC52YWx1ZSA9IHVwZGF0ZWRNYXA7XG4gICAgfTtcbiAgfVxuICAvKipcbiAgICogSXRlcmF0b3IgZm9yIHRoZSBFbnRpdHlSZWdpc3RyeSBjbGFzcy5cbiAgICogQHJldHVybnMgQW4gaXRlcmF0b3IgZm9yIHRoZSB2YWx1ZXMgaW4gdGhlIG1hcC5cbiAgICovXG4gIFtTeW1ib2wuaXRlcmF0b3JdKCkge1xuICAgIHJldHVybiB0aGlzLm1hcC5wZWVrKCkudmFsdWVzKCk7XG4gIH1cbiAgZ2V0IHZhbHVlKCkge1xuICAgIHJldHVybiB0aGlzLm1hcC52YWx1ZS52YWx1ZXMoKTtcbiAgfVxuICAvKipcbiAgICogQ2hlY2tzIGlmIGEgZW50aXR5IHdpdGggdGhlIGdpdmVuIGlkZW50aWZpZXIgZXhpc3RzIGluIHRoZSByZWdpc3RyeS5cbiAgICogQHBhcmFtIGlkZW50aWZpZXIgLSBUaGUgdW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIGVudGl0eS5cbiAgICogQHJldHVybnMgVHJ1ZSBpZiB0aGUgZW50aXR5IGV4aXN0cywgZmFsc2Ugb3RoZXJ3aXNlLlxuICAgKi9cbiAgaGFzKGlkZW50aWZpZXIpIHtcbiAgICByZXR1cm4gdGhpcy5tYXAudmFsdWUuaGFzKGlkZW50aWZpZXIpO1xuICB9XG4gIC8qKlxuICAgKiBSZXRyaWV2ZXMgYSBlbnRpdHkgZnJvbSB0aGUgcmVnaXN0cnkgdXNpbmcgaXRzIGlkZW50aWZpZXIuXG4gICAqIEBwYXJhbSBpZGVudGlmaWVyIC0gVGhlIHVuaXF1ZSBpZGVudGlmaWVyIG9mIHRoZSBlbnRpdHkuXG4gICAqIEByZXR1cm5zIFRoZSBlbnRpdHkgaWYgaXQgZXhpc3RzLCB1bmRlZmluZWQgb3RoZXJ3aXNlLlxuICAgKi9cbiAgZ2V0KGlkZW50aWZpZXIpIHtcbiAgICByZXR1cm4gdGhpcy5tYXAudmFsdWUuZ2V0KGlkZW50aWZpZXIpO1xuICB9XG4gIC8qKlxuICAgKiBEZXN0cm95cyBhbGwgZW50cmllcyBpbiB0aGUgcmVnaXN0cnkgYW5kIGNsZWFycyB0aGUgcmVnaXN0cnkuXG4gICAqL1xuICBkZXN0cm95KCkge1xuICAgIGZvciAoY29uc3QgZW50cnkgb2YgdGhpcykge1xuICAgICAgY29uc3QgY2xlYW51cCA9IHRoaXMuY2xlYW51cEZ1bmN0aW9ucy5nZXQoZW50cnkpO1xuICAgICAgY2xlYW51cCA9PSBudWxsID8gdm9pZCAwIDogY2xlYW51cCgpO1xuICAgICAgZW50cnkuZGVzdHJveSgpO1xuICAgIH1cbiAgICB0aGlzLm1hcC52YWx1ZSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG4gIH1cbn07XG52YXIgX2lzRHJhZ1NvdXJjZV9kZWMsIF9pc0RyYWdnaW5nX2RlYywgX2lzRHJvcHBpbmdfZGVjLCBfc3RhdHVzX2RlYywgX21vZGlmaWVyc19kZWMsIF90eXBlX2RlYywgX2MsIF9pbml0NCwgX3R5cGUsIF9tb2RpZmllcnMsIF9zdGF0dXM7XG52YXIgRHJhZ2dhYmxlID0gY2xhc3MgZXh0ZW5kcyAoX2MgPSBFbnRpdHksIF90eXBlX2RlYyA9IFtyZWFjdGl2ZV0sIF9tb2RpZmllcnNfZGVjID0gW3JlYWN0aXZlXSwgX3N0YXR1c19kZWMgPSBbcmVhY3RpdmVdLCBfaXNEcm9wcGluZ19kZWMgPSBbZGVyaXZlZF0sIF9pc0RyYWdnaW5nX2RlYyA9IFtkZXJpdmVkXSwgX2lzRHJhZ1NvdXJjZV9kZWMgPSBbZGVyaXZlZF0sIF9jKSB7XG4gIGNvbnN0cnVjdG9yKF9hLCBtYW5hZ2VyKSB7XG4gICAgdmFyIF9iID0gX2EsIHsgbW9kaWZpZXJzLCB0eXBlLCBzZW5zb3JzIH0gPSBfYiwgaW5wdXQgPSBfX29ialJlc3QoX2IsIFtcIm1vZGlmaWVyc1wiLCBcInR5cGVcIiwgXCJzZW5zb3JzXCJdKTtcbiAgICBzdXBlcihpbnB1dCwgbWFuYWdlcik7XG4gICAgX19ydW5Jbml0aWFsaXplcnMoX2luaXQ0LCA1LCB0aGlzKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3R5cGUsIF9fcnVuSW5pdGlhbGl6ZXJzKF9pbml0NCwgOCwgdGhpcykpLCBfX3J1bkluaXRpYWxpemVycyhfaW5pdDQsIDExLCB0aGlzKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX21vZGlmaWVycywgX19ydW5Jbml0aWFsaXplcnMoX2luaXQ0LCAxMiwgdGhpcykpLCBfX3J1bkluaXRpYWxpemVycyhfaW5pdDQsIDE1LCB0aGlzKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3N0YXR1cywgX19ydW5Jbml0aWFsaXplcnMoX2luaXQ0LCAxNiwgdGhpcywgdGhpcy5pc0RyYWdTb3VyY2UgPyBcImRyYWdnaW5nXCIgOiBcImlkbGVcIikpLCBfX3J1bkluaXRpYWxpemVycyhfaW5pdDQsIDE5LCB0aGlzKTtcbiAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgIHRoaXMuc2Vuc29ycyA9IHNlbnNvcnM7XG4gICAgdGhpcy5tb2RpZmllcnMgPSBtb2RpZmllcnM7XG4gICAgdGhpcy5hbGlnbm1lbnQgPSBpbnB1dC5hbGlnbm1lbnQ7XG4gIH1cbiAgZ2V0IGlzRHJvcHBpbmcoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdHVzID09PSBcImRyb3BwaW5nXCIgJiYgdGhpcy5pc0RyYWdTb3VyY2U7XG4gIH1cbiAgZ2V0IGlzRHJhZ2dpbmcoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdHVzID09PSBcImRyYWdnaW5nXCIgJiYgdGhpcy5pc0RyYWdTb3VyY2U7XG4gIH1cbiAgZ2V0IGlzRHJhZ1NvdXJjZSgpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIHJldHVybiAoKF9iID0gKF9hID0gdGhpcy5tYW5hZ2VyKSA9PSBudWxsID8gdm9pZCAwIDogX2EuZHJhZ09wZXJhdGlvbi5zb3VyY2UpID09IG51bGwgPyB2b2lkIDAgOiBfYi5pZCkgPT09IHRoaXMuaWQ7XG4gIH1cbn07XG5faW5pdDQgPSBfX2RlY29yYXRvclN0YXJ0KF9jKTtcbl90eXBlID0gbmV3IFdlYWtNYXAoKTtcbl9tb2RpZmllcnMgPSBuZXcgV2Vha01hcCgpO1xuX3N0YXR1cyA9IG5ldyBXZWFrTWFwKCk7XG5fX2RlY29yYXRlRWxlbWVudChfaW5pdDQsIDQsIFwidHlwZVwiLCBfdHlwZV9kZWMsIERyYWdnYWJsZSwgX3R5cGUpO1xuX19kZWNvcmF0ZUVsZW1lbnQoX2luaXQ0LCA0LCBcIm1vZGlmaWVyc1wiLCBfbW9kaWZpZXJzX2RlYywgRHJhZ2dhYmxlLCBfbW9kaWZpZXJzKTtcbl9fZGVjb3JhdGVFbGVtZW50KF9pbml0NCwgNCwgXCJzdGF0dXNcIiwgX3N0YXR1c19kZWMsIERyYWdnYWJsZSwgX3N0YXR1cyk7XG5fX2RlY29yYXRlRWxlbWVudChfaW5pdDQsIDIsIFwiaXNEcm9wcGluZ1wiLCBfaXNEcm9wcGluZ19kZWMsIERyYWdnYWJsZSk7XG5fX2RlY29yYXRlRWxlbWVudChfaW5pdDQsIDIsIFwiaXNEcmFnZ2luZ1wiLCBfaXNEcmFnZ2luZ19kZWMsIERyYWdnYWJsZSk7XG5fX2RlY29yYXRlRWxlbWVudChfaW5pdDQsIDIsIFwiaXNEcmFnU291cmNlXCIsIF9pc0RyYWdTb3VyY2VfZGVjLCBEcmFnZ2FibGUpO1xuX19kZWNvcmF0b3JNZXRhZGF0YShfaW5pdDQsIERyYWdnYWJsZSk7XG52YXIgX2lzRHJvcFRhcmdldF9kZWMsIF9zaGFwZV9kZWMsIF9jb2xsaXNpb25Qcmlvcml0eV9kZWMsIF9jb2xsaXNpb25EZXRlY3Rvcl9kZWMsIF90eXBlX2RlYzIsIF9hY2NlcHRfZGVjLCBfYzIsIF9pbml0NSwgX2FjY2VwdCwgX3R5cGUyLCBfY29sbGlzaW9uRGV0ZWN0b3IsIF9jb2xsaXNpb25Qcmlvcml0eSwgX3NoYXBlO1xudmFyIERyb3BwYWJsZSA9IGNsYXNzIGV4dGVuZHMgKF9jMiA9IEVudGl0eSwgX2FjY2VwdF9kZWMgPSBbcmVhY3RpdmVdLCBfdHlwZV9kZWMyID0gW3JlYWN0aXZlXSwgX2NvbGxpc2lvbkRldGVjdG9yX2RlYyA9IFtyZWFjdGl2ZV0sIF9jb2xsaXNpb25Qcmlvcml0eV9kZWMgPSBbcmVhY3RpdmVdLCBfc2hhcGVfZGVjID0gW3JlYWN0aXZlXSwgX2lzRHJvcFRhcmdldF9kZWMgPSBbZGVyaXZlZF0sIF9jMikge1xuICBjb25zdHJ1Y3RvcihfYSwgbWFuYWdlcikge1xuICAgIHZhciBfYiA9IF9hLCB7IGFjY2VwdCwgY29sbGlzaW9uRGV0ZWN0b3IsIGNvbGxpc2lvblByaW9yaXR5LCB0eXBlIH0gPSBfYiwgaW5wdXQgPSBfX29ialJlc3QoX2IsIFtcImFjY2VwdFwiLCBcImNvbGxpc2lvbkRldGVjdG9yXCIsIFwiY29sbGlzaW9uUHJpb3JpdHlcIiwgXCJ0eXBlXCJdKTtcbiAgICBzdXBlcihpbnB1dCwgbWFuYWdlcik7XG4gICAgX19ydW5Jbml0aWFsaXplcnMoX2luaXQ1LCA1LCB0aGlzKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2FjY2VwdCwgX19ydW5Jbml0aWFsaXplcnMoX2luaXQ1LCA4LCB0aGlzKSksIF9fcnVuSW5pdGlhbGl6ZXJzKF9pbml0NSwgMTEsIHRoaXMpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfdHlwZTIsIF9fcnVuSW5pdGlhbGl6ZXJzKF9pbml0NSwgMTIsIHRoaXMpKSwgX19ydW5Jbml0aWFsaXplcnMoX2luaXQ1LCAxNSwgdGhpcyk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9jb2xsaXNpb25EZXRlY3RvciwgX19ydW5Jbml0aWFsaXplcnMoX2luaXQ1LCAxNiwgdGhpcykpLCBfX3J1bkluaXRpYWxpemVycyhfaW5pdDUsIDE5LCB0aGlzKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2NvbGxpc2lvblByaW9yaXR5LCBfX3J1bkluaXRpYWxpemVycyhfaW5pdDUsIDIwLCB0aGlzKSksIF9fcnVuSW5pdGlhbGl6ZXJzKF9pbml0NSwgMjMsIHRoaXMpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfc2hhcGUsIF9fcnVuSW5pdGlhbGl6ZXJzKF9pbml0NSwgMjQsIHRoaXMpKSwgX19ydW5Jbml0aWFsaXplcnMoX2luaXQ1LCAyNywgdGhpcyk7XG4gICAgdGhpcy5hY2NlcHQgPSBhY2NlcHQ7XG4gICAgdGhpcy5jb2xsaXNpb25EZXRlY3RvciA9IGNvbGxpc2lvbkRldGVjdG9yO1xuICAgIHRoaXMuY29sbGlzaW9uUHJpb3JpdHkgPSBjb2xsaXNpb25Qcmlvcml0eTtcbiAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICB9XG4gIC8qKlxuICAgKiBDaGVja3Mgd2hldGhlciBvciBub3QgdGhlIGRyb3BwYWJsZSBhY2NlcHRzIGEgZ2l2ZW4gZHJhZ2dhYmxlLlxuICAgKlxuICAgKiBAcGFyYW0gZHJhZ2dhYmxlIC0gVGhlIGRyYWdnYWJsZSB0byBjaGVja1xuICAgKiBAcmV0dXJucyB0cnVlIGlmIHRoZSBkcmFnZ2FibGUgY2FuIGJlIGRyb3BwZWQgaGVyZVxuICAgKi9cbiAgYWNjZXB0cyhkcmFnZ2FibGUpIHtcbiAgICBjb25zdCB7IGFjY2VwdCB9ID0gdGhpcztcbiAgICBpZiAoIWFjY2VwdCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgYWNjZXB0ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHJldHVybiBhY2NlcHQoZHJhZ2dhYmxlKTtcbiAgICB9XG4gICAgaWYgKCFkcmFnZ2FibGUudHlwZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoQXJyYXkuaXNBcnJheShhY2NlcHQpKSB7XG4gICAgICByZXR1cm4gYWNjZXB0LmluY2x1ZGVzKGRyYWdnYWJsZS50eXBlKTtcbiAgICB9XG4gICAgcmV0dXJuIGRyYWdnYWJsZS50eXBlID09PSBhY2NlcHQ7XG4gIH1cbiAgZ2V0IGlzRHJvcFRhcmdldCgpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIHJldHVybiAoKF9iID0gKF9hID0gdGhpcy5tYW5hZ2VyKSA9PSBudWxsID8gdm9pZCAwIDogX2EuZHJhZ09wZXJhdGlvbi50YXJnZXQpID09IG51bGwgPyB2b2lkIDAgOiBfYi5pZCkgPT09IHRoaXMuaWQ7XG4gIH1cbn07XG5faW5pdDUgPSBfX2RlY29yYXRvclN0YXJ0KF9jMik7XG5fYWNjZXB0ID0gbmV3IFdlYWtNYXAoKTtcbl90eXBlMiA9IG5ldyBXZWFrTWFwKCk7XG5fY29sbGlzaW9uRGV0ZWN0b3IgPSBuZXcgV2Vha01hcCgpO1xuX2NvbGxpc2lvblByaW9yaXR5ID0gbmV3IFdlYWtNYXAoKTtcbl9zaGFwZSA9IG5ldyBXZWFrTWFwKCk7XG5fX2RlY29yYXRlRWxlbWVudChfaW5pdDUsIDQsIFwiYWNjZXB0XCIsIF9hY2NlcHRfZGVjLCBEcm9wcGFibGUsIF9hY2NlcHQpO1xuX19kZWNvcmF0ZUVsZW1lbnQoX2luaXQ1LCA0LCBcInR5cGVcIiwgX3R5cGVfZGVjMiwgRHJvcHBhYmxlLCBfdHlwZTIpO1xuX19kZWNvcmF0ZUVsZW1lbnQoX2luaXQ1LCA0LCBcImNvbGxpc2lvbkRldGVjdG9yXCIsIF9jb2xsaXNpb25EZXRlY3Rvcl9kZWMsIERyb3BwYWJsZSwgX2NvbGxpc2lvbkRldGVjdG9yKTtcbl9fZGVjb3JhdGVFbGVtZW50KF9pbml0NSwgNCwgXCJjb2xsaXNpb25Qcmlvcml0eVwiLCBfY29sbGlzaW9uUHJpb3JpdHlfZGVjLCBEcm9wcGFibGUsIF9jb2xsaXNpb25Qcmlvcml0eSk7XG5fX2RlY29yYXRlRWxlbWVudChfaW5pdDUsIDQsIFwic2hhcGVcIiwgX3NoYXBlX2RlYywgRHJvcHBhYmxlLCBfc2hhcGUpO1xuX19kZWNvcmF0ZUVsZW1lbnQoX2luaXQ1LCAyLCBcImlzRHJvcFRhcmdldFwiLCBfaXNEcm9wVGFyZ2V0X2RlYywgRHJvcHBhYmxlKTtcbl9fZGVjb3JhdG9yTWV0YWRhdGEoX2luaXQ1LCBEcm9wcGFibGUpO1xuXG4vLyBzcmMvY29yZS9zZW5zb3JzL3NlbnNvci50c1xudmFyIFNlbnNvciA9IGNsYXNzIGV4dGVuZHMgUGx1Z2luIHtcbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBuZXcgc2Vuc29yIGluc3RhbmNlLlxuICAgKlxuICAgKiBAcGFyYW0gbWFuYWdlciAtIFRoZSBkcmFnIGRyb3AgbWFuYWdlciBpbnN0YW5jZVxuICAgKiBAcGFyYW0gb3B0aW9ucyAtIE9wdGlvbmFsIHNlbnNvciBjb25maWd1cmF0aW9uXG4gICAqL1xuICBjb25zdHJ1Y3RvcihtYW5hZ2VyLCBvcHRpb25zKSB7XG4gICAgc3VwZXIobWFuYWdlciwgb3B0aW9ucyk7XG4gICAgdGhpcy5tYW5hZ2VyID0gbWFuYWdlcjtcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICB9XG59O1xuXG4vLyBzcmMvY29yZS9tb2RpZmllcnMvbW9kaWZpZXIudHNcbnZhciBNb2RpZmllciA9IGNsYXNzIGV4dGVuZHMgUGx1Z2luIHtcbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBuZXcgbW9kaWZpZXIgaW5zdGFuY2UuXG4gICAqXG4gICAqIEBwYXJhbSBtYW5hZ2VyIC0gVGhlIGRyYWcgYW5kIGRyb3AgbWFuYWdlciB0aGF0IG93bnMgdGhpcyBtb2RpZmllclxuICAgKiBAcGFyYW0gb3B0aW9ucyAtIE9wdGlvbmFsIGNvbmZpZ3VyYXRpb24gZm9yIHRoZSBtb2RpZmllclxuICAgKi9cbiAgY29uc3RydWN0b3IobWFuYWdlciwgb3B0aW9ucykge1xuICAgIHN1cGVyKG1hbmFnZXIsIG9wdGlvbnMpO1xuICAgIHRoaXMubWFuYWdlciA9IG1hbmFnZXI7XG4gICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgfVxuICAvKipcbiAgICogQXBwbGllcyB0aGUgbW9kaWZpZXIgdG8gdGhlIGN1cnJlbnQgZHJhZyBvcGVyYXRpb24uXG4gICAqXG4gICAqIEBwYXJhbSBvcGVyYXRpb24gLSBUaGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgZHJhZyBvcGVyYXRpb25cbiAgICogQHJldHVybnMgVGhlIHRyYW5zZm9ybWVkIGNvb3JkaW5hdGVzXG4gICAqXG4gICAqIEByZW1hcmtzXG4gICAqIE92ZXJyaWRlIHRoaXMgbWV0aG9kIHRvIGltcGxlbWVudCBjdXN0b20gdHJhbnNmb3JtYXRpb24gbG9naWMuXG4gICAqIFRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIHJldHVybnMgdGhlIG9yaWdpbmFsIHRyYW5zZm9ybSB1bmNoYW5nZWQuXG4gICAqL1xuICBhcHBseShvcGVyYXRpb24pIHtcbiAgICByZXR1cm4gb3BlcmF0aW9uLnRyYW5zZm9ybTtcbiAgfVxufTtcblxuLy8gc3JjL2NvcmUvbWFuYWdlci9yZWdpc3RyeS50c1xudmFyIERyYWdEcm9wUmVnaXN0cnkgPSBjbGFzcyB7XG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgbmV3IHJlZ2lzdHJ5IGluc3RhbmNlLlxuICAgKlxuICAgKiBAcGFyYW0gbWFuYWdlciAtIFRoZSBkcmFnIGFuZCBkcm9wIG1hbmFnZXIgdGhhdCBvd25zIHRoaXMgcmVnaXN0cnlcbiAgICovXG4gIGNvbnN0cnVjdG9yKG1hbmFnZXIpIHtcbiAgICAvKiogUmVnaXN0cnkgZm9yIGRyYWdnYWJsZSBlbnRpdGllcyAqL1xuICAgIHRoaXMuZHJhZ2dhYmxlcyA9IG5ldyBFbnRpdHlSZWdpc3RyeSgpO1xuICAgIC8qKiBSZWdpc3RyeSBmb3IgZHJvcHBhYmxlIGVudGl0aWVzICovXG4gICAgdGhpcy5kcm9wcGFibGVzID0gbmV3IEVudGl0eVJlZ2lzdHJ5KCk7XG4gICAgdGhpcy5wbHVnaW5zID0gbmV3IFBsdWdpblJlZ2lzdHJ5KG1hbmFnZXIpO1xuICAgIHRoaXMuc2Vuc29ycyA9IG5ldyBQbHVnaW5SZWdpc3RyeShtYW5hZ2VyKTtcbiAgICB0aGlzLm1vZGlmaWVycyA9IG5ldyBQbHVnaW5SZWdpc3RyeShtYW5hZ2VyKTtcbiAgfVxuICByZWdpc3RlcihpbnB1dCwgb3B0aW9ucykge1xuICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIERyYWdnYWJsZSkge1xuICAgICAgcmV0dXJuIHRoaXMuZHJhZ2dhYmxlcy5yZWdpc3RlcihpbnB1dC5pZCwgaW5wdXQpO1xuICAgIH1cbiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBEcm9wcGFibGUpIHtcbiAgICAgIHJldHVybiB0aGlzLmRyb3BwYWJsZXMucmVnaXN0ZXIoaW5wdXQuaWQsIGlucHV0KTtcbiAgICB9XG4gICAgaWYgKGlucHV0LnByb3RvdHlwZSBpbnN0YW5jZW9mIE1vZGlmaWVyKSB7XG4gICAgICByZXR1cm4gdGhpcy5tb2RpZmllcnMucmVnaXN0ZXIoaW5wdXQsIG9wdGlvbnMpO1xuICAgIH1cbiAgICBpZiAoaW5wdXQucHJvdG90eXBlIGluc3RhbmNlb2YgU2Vuc29yKSB7XG4gICAgICByZXR1cm4gdGhpcy5zZW5zb3JzLnJlZ2lzdGVyKGlucHV0LCBvcHRpb25zKTtcbiAgICB9XG4gICAgaWYgKGlucHV0LnByb3RvdHlwZSBpbnN0YW5jZW9mIFBsdWdpbikge1xuICAgICAgcmV0dXJuIHRoaXMucGx1Z2lucy5yZWdpc3RlcihpbnB1dCwgb3B0aW9ucyk7XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgaW5zdGFuY2UgdHlwZVwiKTtcbiAgfVxuICB1bnJlZ2lzdGVyKGlucHV0KSB7XG4gICAgaWYgKGlucHV0IGluc3RhbmNlb2YgRW50aXR5KSB7XG4gICAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBEcmFnZ2FibGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZHJhZ2dhYmxlcy51bnJlZ2lzdGVyKGlucHV0LmlkLCBpbnB1dCk7XG4gICAgICB9XG4gICAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBEcm9wcGFibGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZHJvcHBhYmxlcy51bnJlZ2lzdGVyKGlucHV0LmlkLCBpbnB1dCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgfTtcbiAgICB9XG4gICAgaWYgKGlucHV0LnByb3RvdHlwZSBpbnN0YW5jZW9mIE1vZGlmaWVyKSB7XG4gICAgICByZXR1cm4gdGhpcy5tb2RpZmllcnMudW5yZWdpc3RlcihpbnB1dCk7XG4gICAgfVxuICAgIGlmIChpbnB1dC5wcm90b3R5cGUgaW5zdGFuY2VvZiBTZW5zb3IpIHtcbiAgICAgIHJldHVybiB0aGlzLnNlbnNvcnMudW5yZWdpc3RlcihpbnB1dCk7XG4gICAgfVxuICAgIGlmIChpbnB1dC5wcm90b3R5cGUgaW5zdGFuY2VvZiBQbHVnaW4pIHtcbiAgICAgIHJldHVybiB0aGlzLnBsdWdpbnMudW5yZWdpc3RlcihpbnB1dCk7XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgaW5zdGFuY2UgdHlwZVwiKTtcbiAgfVxuICAvKipcbiAgICogRGVzdHJveXMgYWxsIHJlZ2lzdGVyZWQgZW50aXRpZXMgYW5kIGNsZWFucyB1cCByZXNvdXJjZXMuXG4gICAqXG4gICAqIEByZW1hcmtzXG4gICAqIFRoaXMgbWV0aG9kOlxuICAgKiAtIERlc3Ryb3lzIGFsbCBkcmFnZ2FibGUgYW5kIGRyb3BwYWJsZSBlbnRpdGllc1xuICAgKiAtIERlc3Ryb3lzIGFsbCBwbHVnaW5zLCBzZW5zb3JzLCBhbmQgbW9kaWZpZXJzXG4gICAqIC0gQ2xlYW5zIHVwIGFueSBhc3NvY2lhdGVkIHJlc291cmNlc1xuICAgKi9cbiAgZGVzdHJveSgpIHtcbiAgICB0aGlzLmRyYWdnYWJsZXMuZGVzdHJveSgpO1xuICAgIHRoaXMuZHJvcHBhYmxlcy5kZXN0cm95KCk7XG4gICAgdGhpcy5wbHVnaW5zLmRlc3Ryb3koKTtcbiAgICB0aGlzLnNlbnNvcnMuZGVzdHJveSgpO1xuICAgIHRoaXMubW9kaWZpZXJzLmRlc3Ryb3koKTtcbiAgfVxufTtcbnZhciBfdHJhbnNmb3JtX2RlYywgX3RhcmdldF9kZWMsIF9zb3VyY2VfZGVjLCBfbW9kaWZpZXJzX2RlYzIsIF90YXJnZXRJZGVudGlmaWVyX2RlYywgX3NvdXJjZUlkZW50aWZpZXJfZGVjLCBfYWN0aXZhdG9yRXZlbnRfZGVjLCBfY2FuY2VsZWRfZGVjLCBfc2hhcGVfZGVjMiwgX21hbmFnZXIyLCBfcHJldmlvdXNTb3VyY2UsIF9zaGFwZTIsIF9pbml0NiwgX2NhbmNlbGVkLCBfYWN0aXZhdG9yRXZlbnQsIF9zb3VyY2VJZGVudGlmaWVyLCBfdGFyZ2V0SWRlbnRpZmllciwgX21vZGlmaWVyczIsIF90cmFuc2Zvcm07XG5fc2hhcGVfZGVjMiA9IFtkZXJpdmVkXSwgX2NhbmNlbGVkX2RlYyA9IFtyZWFjdGl2ZV0sIF9hY3RpdmF0b3JFdmVudF9kZWMgPSBbcmVhY3RpdmVdLCBfc291cmNlSWRlbnRpZmllcl9kZWMgPSBbcmVhY3RpdmVdLCBfdGFyZ2V0SWRlbnRpZmllcl9kZWMgPSBbcmVhY3RpdmVdLCBfbW9kaWZpZXJzX2RlYzIgPSBbcmVhY3RpdmVdLCBfc291cmNlX2RlYyA9IFtkZXJpdmVkXSwgX3RhcmdldF9kZWMgPSBbZGVyaXZlZF0sIF90cmFuc2Zvcm1fZGVjID0gW2Rlcml2ZWRdO1xudmFyIERyYWdPcGVyYXRpb24gPSBjbGFzcyB7XG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgbmV3IGRyYWcgb3BlcmF0aW9uIGluc3RhbmNlLlxuICAgKlxuICAgKiBAcGFyYW0gbWFuYWdlciAtIFRoZSBkcmFnIGFuZCBkcm9wIG1hbmFnZXIgdGhhdCBvd25zIHRoaXMgb3BlcmF0aW9uXG4gICAqL1xuICBjb25zdHJ1Y3RvcihtYW5hZ2VyKSB7XG4gICAgX19ydW5Jbml0aWFsaXplcnMoX2luaXQ2LCA1LCB0aGlzKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX21hbmFnZXIyKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3ByZXZpb3VzU291cmNlKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3NoYXBlMiwgbmV3IFZhbHVlSGlzdG9yeShcbiAgICAgIHZvaWQgMCxcbiAgICAgIChhLCBiKSA9PiBhICYmIGIgPyBhLmVxdWFscyhiKSA6IGEgPT09IGJcbiAgICApKTtcbiAgICAvKiogQ3VycmVudCBzdGF0dXMgb2YgdGhlIGRyYWcgb3BlcmF0aW9uICovXG4gICAgdGhpcy5zdGF0dXMgPSBuZXcgU3RhdHVzKCk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9jYW5jZWxlZCwgX19ydW5Jbml0aWFsaXplcnMoX2luaXQ2LCA4LCB0aGlzLCBmYWxzZSkpLCBfX3J1bkluaXRpYWxpemVycyhfaW5pdDYsIDExLCB0aGlzKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2FjdGl2YXRvckV2ZW50LCBfX3J1bkluaXRpYWxpemVycyhfaW5pdDYsIDEyLCB0aGlzLCBudWxsKSksIF9fcnVuSW5pdGlhbGl6ZXJzKF9pbml0NiwgMTUsIHRoaXMpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfc291cmNlSWRlbnRpZmllciwgX19ydW5Jbml0aWFsaXplcnMoX2luaXQ2LCAxNiwgdGhpcywgbnVsbCkpLCBfX3J1bkluaXRpYWxpemVycyhfaW5pdDYsIDE5LCB0aGlzKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3RhcmdldElkZW50aWZpZXIsIF9fcnVuSW5pdGlhbGl6ZXJzKF9pbml0NiwgMjAsIHRoaXMsIG51bGwpKSwgX19ydW5Jbml0aWFsaXplcnMoX2luaXQ2LCAyMywgdGhpcyk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9tb2RpZmllcnMyLCBfX3J1bkluaXRpYWxpemVycyhfaW5pdDYsIDI0LCB0aGlzLCBbXSkpLCBfX3J1bkluaXRpYWxpemVycyhfaW5pdDYsIDI3LCB0aGlzKTtcbiAgICAvKiogQ3VycmVudCBwb3NpdGlvbiBvZiB0aGUgZHJhZ2dlZCBlbnRpdHkgKi9cbiAgICB0aGlzLnBvc2l0aW9uID0gbmV3IFBvc2l0aW9uKHsgeDogMCwgeTogMCB9KTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3RyYW5zZm9ybSwgeyB4OiAwLCB5OiAwIH0pO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfbWFuYWdlcjIsIG1hbmFnZXIpO1xuICB9XG4gIGdldCBzaGFwZSgpIHtcbiAgICBjb25zdCB7IGN1cnJlbnQsIGluaXRpYWwsIHByZXZpb3VzIH0gPSBfX3ByaXZhdGVHZXQodGhpcywgX3NoYXBlMik7XG4gICAgaWYgKCFjdXJyZW50IHx8ICFpbml0aWFsKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIHsgY3VycmVudCwgaW5pdGlhbCwgcHJldmlvdXMgfTtcbiAgfVxuICAvKipcbiAgICogU2V0cyB0aGUgc2hhcGUgb2YgdGhlIGRyYWdnZWQgZW50aXR5LlxuICAgKlxuICAgKiBAcGFyYW0gdmFsdWUgLSBUaGUgbmV3IHNoYXBlIG9yIG51bGwgdG8gcmVzZXRcbiAgICovXG4gIHNldCBzaGFwZSh2YWx1ZSkge1xuICAgIGlmICghdmFsdWUpIHtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2hhcGUyKS5yZXNldCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3NoYXBlMikuY3VycmVudCA9IHZhbHVlO1xuICAgIH1cbiAgfVxuICBnZXQgc291cmNlKCkge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCBpZGVudGlmaWVyID0gdGhpcy5zb3VyY2VJZGVudGlmaWVyO1xuICAgIGlmIChpZGVudGlmaWVyID09IG51bGwpIHJldHVybiBudWxsO1xuICAgIGNvbnN0IHZhbHVlID0gX19wcml2YXRlR2V0KHRoaXMsIF9tYW5hZ2VyMikucmVnaXN0cnkuZHJhZ2dhYmxlcy5nZXQoaWRlbnRpZmllcik7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX3ByZXZpb3VzU291cmNlLCB2YWx1ZSk7XG4gICAgfVxuICAgIHJldHVybiAoX2EgPSB2YWx1ZSAhPSBudWxsID8gdmFsdWUgOiBfX3ByaXZhdGVHZXQodGhpcywgX3ByZXZpb3VzU291cmNlKSkgIT0gbnVsbCA/IF9hIDogbnVsbDtcbiAgfVxuICBnZXQgdGFyZ2V0KCkge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCBpZGVudGlmaWVyID0gdGhpcy50YXJnZXRJZGVudGlmaWVyO1xuICAgIHJldHVybiBpZGVudGlmaWVyICE9IG51bGwgPyAoX2EgPSBfX3ByaXZhdGVHZXQodGhpcywgX21hbmFnZXIyKS5yZWdpc3RyeS5kcm9wcGFibGVzLmdldChpZGVudGlmaWVyKSkgIT0gbnVsbCA/IF9hIDogbnVsbCA6IG51bGw7XG4gIH1cbiAgZ2V0IHRyYW5zZm9ybSgpIHtcbiAgICBjb25zdCB7IHgsIHkgfSA9IHRoaXMucG9zaXRpb24uZGVsdGE7XG4gICAgbGV0IHRyYW5zZm9ybSA9IHsgeCwgeSB9O1xuICAgIGZvciAoY29uc3QgbW9kaWZpZXIgb2YgdGhpcy5tb2RpZmllcnMpIHtcbiAgICAgIHRyYW5zZm9ybSA9IG1vZGlmaWVyLmFwcGx5KF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIHRoaXMuc25hcHNob3QoKSksIHtcbiAgICAgICAgdHJhbnNmb3JtXG4gICAgICB9KSk7XG4gICAgfVxuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfdHJhbnNmb3JtLCB0cmFuc2Zvcm0pO1xuICAgIHJldHVybiB0cmFuc2Zvcm07XG4gIH1cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBzbmFwc2hvdCBvZiB0aGUgY3VycmVudCBkcmFnIG9wZXJhdGlvbiBzdGF0ZS5cbiAgICpcbiAgICogQHJldHVybnMgQW4gaW1tdXRhYmxlIHNuYXBzaG90IG9mIHRoZSBjdXJyZW50IG9wZXJhdGlvbiBzdGF0ZVxuICAgKi9cbiAgc25hcHNob3QoKSB7XG4gICAgcmV0dXJuIHVudHJhY2tlZCgoKSA9PiAoe1xuICAgICAgc291cmNlOiB0aGlzLnNvdXJjZSxcbiAgICAgIHRhcmdldDogdGhpcy50YXJnZXQsXG4gICAgICBhY3RpdmF0b3JFdmVudDogdGhpcy5hY3RpdmF0b3JFdmVudCxcbiAgICAgIHRyYW5zZm9ybTogX19wcml2YXRlR2V0KHRoaXMsIF90cmFuc2Zvcm0pLFxuICAgICAgc2hhcGU6IHRoaXMuc2hhcGUgPyBzbmFwc2hvdCh0aGlzLnNoYXBlKSA6IG51bGwsXG4gICAgICBwb3NpdGlvbjogc25hcHNob3QodGhpcy5wb3NpdGlvbiksXG4gICAgICBzdGF0dXM6IHNuYXBzaG90KHRoaXMuc3RhdHVzKSxcbiAgICAgIGNhbmNlbGVkOiB0aGlzLmNhbmNlbGVkXG4gICAgfSkpO1xuICB9XG4gIC8qKlxuICAgKiBSZXNldHMgdGhlIGRyYWcgb3BlcmF0aW9uIHRvIGl0cyBpbml0aWFsIHN0YXRlLlxuICAgKlxuICAgKiBAcmVtYXJrc1xuICAgKiBUaGlzIG1ldGhvZDpcbiAgICogLSBTZXRzIHN0YXR1cyB0byBpZGxlXG4gICAqIC0gQ2xlYXJzIHNvdXJjZSBhbmQgdGFyZ2V0IGlkZW50aWZpZXJzXG4gICAqIC0gUmVzZXRzIHNoYXBlIGhpc3RvcnlcbiAgICogLSBSZXNldHMgcG9zaXRpb24gYW5kIHRyYW5zZm9ybVxuICAgKiAtIENsZWFycyBtb2RpZmllcnNcbiAgICovXG4gIHJlc2V0KCkge1xuICAgIGJhdGNoKCgpID0+IHtcbiAgICAgIHRoaXMuc3RhdHVzLnNldChcImlkbGVcIiAvKiBJZGxlICovKTtcbiAgICAgIHRoaXMuc291cmNlSWRlbnRpZmllciA9IG51bGw7XG4gICAgICB0aGlzLnRhcmdldElkZW50aWZpZXIgPSBudWxsO1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9zaGFwZTIpLnJlc2V0KCk7XG4gICAgICB0aGlzLnBvc2l0aW9uLnJlc2V0KHsgeDogMCwgeTogMCB9KTtcbiAgICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfdHJhbnNmb3JtLCB7IHg6IDAsIHk6IDAgfSk7XG4gICAgICB0aGlzLm1vZGlmaWVycyA9IFtdO1xuICAgIH0pO1xuICB9XG59O1xuX2luaXQ2ID0gX19kZWNvcmF0b3JTdGFydChudWxsKTtcbl9tYW5hZ2VyMiA9IG5ldyBXZWFrTWFwKCk7XG5fcHJldmlvdXNTb3VyY2UgPSBuZXcgV2Vha01hcCgpO1xuX3NoYXBlMiA9IG5ldyBXZWFrTWFwKCk7XG5fY2FuY2VsZWQgPSBuZXcgV2Vha01hcCgpO1xuX2FjdGl2YXRvckV2ZW50ID0gbmV3IFdlYWtNYXAoKTtcbl9zb3VyY2VJZGVudGlmaWVyID0gbmV3IFdlYWtNYXAoKTtcbl90YXJnZXRJZGVudGlmaWVyID0gbmV3IFdlYWtNYXAoKTtcbl9tb2RpZmllcnMyID0gbmV3IFdlYWtNYXAoKTtcbl90cmFuc2Zvcm0gPSBuZXcgV2Vha01hcCgpO1xuX19kZWNvcmF0ZUVsZW1lbnQoX2luaXQ2LCAyLCBcInNoYXBlXCIsIF9zaGFwZV9kZWMyLCBEcmFnT3BlcmF0aW9uKTtcbl9fZGVjb3JhdGVFbGVtZW50KF9pbml0NiwgNCwgXCJjYW5jZWxlZFwiLCBfY2FuY2VsZWRfZGVjLCBEcmFnT3BlcmF0aW9uLCBfY2FuY2VsZWQpO1xuX19kZWNvcmF0ZUVsZW1lbnQoX2luaXQ2LCA0LCBcImFjdGl2YXRvckV2ZW50XCIsIF9hY3RpdmF0b3JFdmVudF9kZWMsIERyYWdPcGVyYXRpb24sIF9hY3RpdmF0b3JFdmVudCk7XG5fX2RlY29yYXRlRWxlbWVudChfaW5pdDYsIDQsIFwic291cmNlSWRlbnRpZmllclwiLCBfc291cmNlSWRlbnRpZmllcl9kZWMsIERyYWdPcGVyYXRpb24sIF9zb3VyY2VJZGVudGlmaWVyKTtcbl9fZGVjb3JhdGVFbGVtZW50KF9pbml0NiwgNCwgXCJ0YXJnZXRJZGVudGlmaWVyXCIsIF90YXJnZXRJZGVudGlmaWVyX2RlYywgRHJhZ09wZXJhdGlvbiwgX3RhcmdldElkZW50aWZpZXIpO1xuX19kZWNvcmF0ZUVsZW1lbnQoX2luaXQ2LCA0LCBcIm1vZGlmaWVyc1wiLCBfbW9kaWZpZXJzX2RlYzIsIERyYWdPcGVyYXRpb24sIF9tb2RpZmllcnMyKTtcbl9fZGVjb3JhdGVFbGVtZW50KF9pbml0NiwgMiwgXCJzb3VyY2VcIiwgX3NvdXJjZV9kZWMsIERyYWdPcGVyYXRpb24pO1xuX19kZWNvcmF0ZUVsZW1lbnQoX2luaXQ2LCAyLCBcInRhcmdldFwiLCBfdGFyZ2V0X2RlYywgRHJhZ09wZXJhdGlvbik7XG5fX2RlY29yYXRlRWxlbWVudChfaW5pdDYsIDIsIFwidHJhbnNmb3JtXCIsIF90cmFuc2Zvcm1fZGVjLCBEcmFnT3BlcmF0aW9uKTtcbl9fZGVjb3JhdG9yTWV0YWRhdGEoX2luaXQ2LCBEcmFnT3BlcmF0aW9uKTtcblxuLy8gc3JjL2NvcmUvbWFuYWdlci9yZW5kZXJlci50c1xudmFyIGRlZmF1bHRSZW5kZXJlciA9IHtcbiAgZ2V0IHJlbmRlcmluZygpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gIH1cbn07XG5cbi8vIHNyYy9jb3JlL21hbmFnZXIvbWFuYWdlci50c1xudmFyIERyYWdEcm9wTWFuYWdlciA9IGNsYXNzIHtcbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBuZXcgZHJhZyBhbmQgZHJvcCBtYW5hZ2VyIGluc3RhbmNlLlxuICAgKlxuICAgKiBAcGFyYW0gY29uZmlnIC0gT3B0aW9uYWwgY29uZmlndXJhdGlvbiBmb3IgcGx1Z2lucywgc2Vuc29ycywgbW9kaWZpZXJzLCBhbmQgcmVuZGVyZXJcbiAgICovXG4gIGNvbnN0cnVjdG9yKGNvbmZpZykge1xuICAgIC8qKlxuICAgICAqIENsZWFucyB1cCByZXNvdXJjZXMgYW5kIHN0b3BzIGFueSBhY3RpdmUgZHJhZyBvcGVyYXRpb25zLlxuICAgICAqL1xuICAgIHRoaXMuZGVzdHJveSA9ICgpID0+IHtcbiAgICAgIGlmICghdGhpcy5kcmFnT3BlcmF0aW9uLnN0YXR1cy5pZGxlKSB7XG4gICAgICAgIHRoaXMuYWN0aW9ucy5zdG9wKHsgY2FuY2VsZWQ6IHRydWUgfSk7XG4gICAgICB9XG4gICAgICB0aGlzLmRyYWdPcGVyYXRpb24ubW9kaWZpZXJzLmZvckVhY2goKG1vZGlmaWVyKSA9PiBtb2RpZmllci5kZXN0cm95KCkpO1xuICAgICAgdGhpcy5yZWdpc3RyeS5kZXN0cm95KCk7XG4gICAgICB0aGlzLmNvbGxpc2lvbk9ic2VydmVyLmRlc3Ryb3koKTtcbiAgICB9O1xuICAgIGNvbnN0IHtcbiAgICAgIHBsdWdpbnMgPSBbXSxcbiAgICAgIHNlbnNvcnMgPSBbXSxcbiAgICAgIG1vZGlmaWVycyA9IFtdLFxuICAgICAgcmVuZGVyZXIgPSBkZWZhdWx0UmVuZGVyZXJcbiAgICB9ID0gY29uZmlnICE9IG51bGwgPyBjb25maWcgOiB7fTtcbiAgICBjb25zdCBtb25pdG9yID0gbmV3IERyYWdEcm9wTW9uaXRvcih0aGlzKTtcbiAgICBjb25zdCByZWdpc3RyeSA9IG5ldyBEcmFnRHJvcFJlZ2lzdHJ5KHRoaXMpO1xuICAgIHRoaXMucmVnaXN0cnkgPSByZWdpc3RyeTtcbiAgICB0aGlzLm1vbml0b3IgPSBtb25pdG9yO1xuICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLmFjdGlvbnMgPSBuZXcgRHJhZ0FjdGlvbnModGhpcyk7XG4gICAgdGhpcy5kcmFnT3BlcmF0aW9uID0gbmV3IERyYWdPcGVyYXRpb24odGhpcyk7XG4gICAgdGhpcy5jb2xsaXNpb25PYnNlcnZlciA9IG5ldyBDb2xsaXNpb25PYnNlcnZlcih0aGlzKTtcbiAgICB0aGlzLnBsdWdpbnMgPSBbQ29sbGlzaW9uTm90aWZpZXIsIC4uLnBsdWdpbnNdO1xuICAgIHRoaXMubW9kaWZpZXJzID0gbW9kaWZpZXJzO1xuICAgIHRoaXMuc2Vuc29ycyA9IHNlbnNvcnM7XG4gICAgY29uc3QgeyBkZXN0cm95IH0gPSB0aGlzO1xuICAgIGNvbnN0IGNsZWFudXAgPSBlZmZlY3RzKCgpID0+IHtcbiAgICAgIHZhciBfYSwgX2IsIF9jMztcbiAgICAgIGNvbnN0IGN1cnJlbnRNb2RpZmllcnMgPSB1bnRyYWNrZWQoKCkgPT4gdGhpcy5kcmFnT3BlcmF0aW9uLm1vZGlmaWVycyk7XG4gICAgICBjb25zdCBtYW5hZ2VyTW9kaWZpZXJzID0gdGhpcy5tb2RpZmllcnM7XG4gICAgICBpZiAoY3VycmVudE1vZGlmaWVycyAhPT0gbWFuYWdlck1vZGlmaWVycykge1xuICAgICAgICBjdXJyZW50TW9kaWZpZXJzLmZvckVhY2goKG1vZGlmaWVyKSA9PiBtb2RpZmllci5kZXN0cm95KCkpO1xuICAgICAgfVxuICAgICAgdGhpcy5kcmFnT3BlcmF0aW9uLm1vZGlmaWVycyA9IChfYzMgPSAoX2IgPSAoX2EgPSB0aGlzLmRyYWdPcGVyYXRpb24uc291cmNlKSA9PSBudWxsID8gdm9pZCAwIDogX2EubW9kaWZpZXJzKSA9PSBudWxsID8gdm9pZCAwIDogX2IubWFwKChtb2RpZmllcikgPT4ge1xuICAgICAgICBjb25zdCB7IHBsdWdpbiwgb3B0aW9ucyB9ID0gZGVzY3JpcHRvcihtb2RpZmllcik7XG4gICAgICAgIHJldHVybiBuZXcgcGx1Z2luKHRoaXMsIG9wdGlvbnMpO1xuICAgICAgfSkpICE9IG51bGwgPyBfYzMgOiBtYW5hZ2VyTW9kaWZpZXJzO1xuICAgIH0pO1xuICAgIHRoaXMuZGVzdHJveSA9ICgpID0+IHtcbiAgICAgIGNsZWFudXAoKTtcbiAgICAgIGRlc3Ryb3koKTtcbiAgICB9O1xuICB9XG4gIC8qKlxuICAgKiBHZXRzIHRoZSBsaXN0IG9mIGFjdGl2ZSBwbHVnaW5zLlxuICAgKlxuICAgKiBAcmV0dXJucyBBcnJheSBvZiBhY3RpdmUgcGx1Z2luIGluc3RhbmNlc1xuICAgKi9cbiAgZ2V0IHBsdWdpbnMoKSB7XG4gICAgcmV0dXJuIHRoaXMucmVnaXN0cnkucGx1Z2lucy52YWx1ZXM7XG4gIH1cbiAgLyoqXG4gICAqIFNldHMgdGhlIGxpc3Qgb2YgcGx1Z2lucyB0byBiZSB1c2VkIGJ5IHRoZSBtYW5hZ2VyLlxuICAgKlxuICAgKiBAcGFyYW0gcGx1Z2lucyAtIEFycmF5IG9mIHBsdWdpbiBjb25zdHJ1Y3RvcnMgb3IgaW5zdGFuY2VzXG4gICAqL1xuICBzZXQgcGx1Z2lucyhwbHVnaW5zKSB7XG4gICAgdGhpcy5yZWdpc3RyeS5wbHVnaW5zLnZhbHVlcyA9IHBsdWdpbnM7XG4gIH1cbiAgLyoqXG4gICAqIEdldHMgdGhlIGxpc3Qgb2YgYWN0aXZlIG1vZGlmaWVycy5cbiAgICpcbiAgICogQHJldHVybnMgQXJyYXkgb2YgYWN0aXZlIG1vZGlmaWVyIGluc3RhbmNlc1xuICAgKi9cbiAgZ2V0IG1vZGlmaWVycygpIHtcbiAgICByZXR1cm4gdGhpcy5yZWdpc3RyeS5tb2RpZmllcnMudmFsdWVzO1xuICB9XG4gIC8qKlxuICAgKiBTZXRzIHRoZSBsaXN0IG9mIG1vZGlmaWVycyB0byBiZSB1c2VkIGJ5IHRoZSBtYW5hZ2VyLlxuICAgKlxuICAgKiBAcGFyYW0gbW9kaWZpZXJzIC0gQXJyYXkgb2YgbW9kaWZpZXIgY29uc3RydWN0b3JzIG9yIGluc3RhbmNlc1xuICAgKi9cbiAgc2V0IG1vZGlmaWVycyhtb2RpZmllcnMpIHtcbiAgICB0aGlzLnJlZ2lzdHJ5Lm1vZGlmaWVycy52YWx1ZXMgPSBtb2RpZmllcnM7XG4gIH1cbiAgLyoqXG4gICAqIEdldHMgdGhlIGxpc3Qgb2YgYWN0aXZlIHNlbnNvcnMuXG4gICAqXG4gICAqIEByZXR1cm5zIEFycmF5IG9mIGFjdGl2ZSBzZW5zb3IgaW5zdGFuY2VzXG4gICAqL1xuICBnZXQgc2Vuc29ycygpIHtcbiAgICByZXR1cm4gdGhpcy5yZWdpc3RyeS5zZW5zb3JzLnZhbHVlcztcbiAgfVxuICAvKipcbiAgICogU2V0cyB0aGUgbGlzdCBvZiBzZW5zb3JzIHRvIGJlIHVzZWQgYnkgdGhlIG1hbmFnZXIuXG4gICAqXG4gICAqIEBwYXJhbSBzZW5zb3JzIC0gQXJyYXkgb2Ygc2Vuc29yIGNvbnN0cnVjdG9ycyBvciBpbnN0YW5jZXNcbiAgICovXG4gIHNldCBzZW5zb3JzKHNlbnNvcnMpIHtcbiAgICB0aGlzLnJlZ2lzdHJ5LnNlbnNvcnMudmFsdWVzID0gc2Vuc29ycztcbiAgfVxufTtcblxuZXhwb3J0IHsgQ29sbGlzaW9uUHJpb3JpdHksIENvbGxpc2lvblR5cGUsIENvcmVQbHVnaW4sIERyYWdEcm9wTWFuYWdlciwgU3RhdHVzIGFzIERyYWdPcGVyYXRpb25TdGF0dXMsIERyYWdnYWJsZSwgRHJvcHBhYmxlLCBNb2RpZmllciwgUGx1Z2luLCBQbHVnaW5SZWdpc3RyeSwgU2Vuc29yLCBjb25maWd1cmF0b3IsIGNvbmZpZ3VyZSwgZGVzY3JpcHRvciwgc29ydENvbGxpc2lvbnMgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcFxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@dnd-kit+abstract@0.1.21/node_modules/@dnd-kit/abstract/index.js\n");

/***/ })

};
;